+ date +%s
+ run_id=1687571315
+ echo RUN ID: 
RUN ID: 
+ date
+ echo START TIME: Sat Jun 24 01:48:35 UTC 2023
START TIME: Sat Jun 24 01:48:35 UTC 2023
+ ROOT_DIR_BASE=/home/ubuntu/cloudfs/saved_models/qlora_cn
+ OUTPUT_PATH=/home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687571315
+ mkdir -p /home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687571315
+ python qlora_fact_encoder.py --dataset=/home/ubuntu/qlora/metacritics_fact_encoder_training_data.pickle --dataset_format=fact_encoder --learning_rate 0.0001 --per_device_train_batch_size 1 --gradient_accumulation_steps 16 --max_steps 450 --model_name_or_path timdettmers/guanaco-33b-merged --source_max_len 42 --target_max_len 2829 --eval_dataset_size 1 --do_eval --evaluation_strategy steps --eval_steps 45 --output_dir /home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687571315 --report_to wandb --sample_generate --save_steps 45
2023-06-24 01:48:38.778603: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F AVX512_VNNI AVX512_BF16 AVX_VNNI
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-06-24 01:48:39.079266: I tensorflow/core/util/port.cc:104] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
--------------------------------------------------------------------------
WARNING: No preset parameters were found for the device that Open MPI
detected:

  Local host:            209-20-157-252
  Device name:           mlx5_0
  Device vendor ID:      0x02c9
  Device vendor part ID: 4122

Default device parameters will be used, which may result in lower
performance.  You can edit any of the files specified by the
btl_openib_device_param_files MCA parameter to set values for your
device.

NOTE: You can turn off this warning by setting the MCA parameter
      btl_openib_warn_no_device_params_found to 0.
--------------------------------------------------------------------------
--------------------------------------------------------------------------
No OpenFabrics connection schemes reported that they were able to be
used on a specific port.  As such, the openib BTL (OpenFabrics
support) will be disabled for this port.

  Local host:           209-20-157-252
  Local device:         mlx5_0
  Local port:           1
  CPCs attempted:       udcm
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Open MPI failed an OFI Libfabric library call (fi_domain).  This is highly
unusual; your job may behave unpredictably (and/or abort) after this.

  Local host: 209-20-157-252
  Location: mtl_ofi_component.c:610
  Error: No data available (61)
--------------------------------------------------------------------------

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /home/ubuntu/.local/lib/python3.8/site-packages/bitsandbytes/libbitsandbytes_cuda118.so
CUDA SETUP: CUDA runtime path found: /usr/lib/x86_64-linux-gnu/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 9.0
CUDA SETUP: Detected CUDA version 118
CUDA SETUP: Loading binary /home/ubuntu/.local/lib/python3.8/site-packages/bitsandbytes/libbitsandbytes_cuda118.so...
2023-06-24 01:48:43,188 [INFO] args: Namespace(__cached__setup_devices=device(type='cuda', index=0), _n_gpu=1, adafactor=False, adam8bit=False, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, auto_find_batch_size=False, bf16=False, bf16_full_eval=False, bits=4, cache_dir=None, data_seed=None, dataloader_drop_last=False, dataloader_num_workers=0, dataloader_pin_memory=True, dataset='/home/ubuntu/qlora/metacritics_fact_encoder_training_data.pickle', dataset_format='fact_encoder', ddp_backend=None, ddp_broadcast_buffers=None, ddp_bucket_cap_mb=None, ddp_find_unused_parameters=None, ddp_timeout=1800, debug=[], debug_mode=False, deepspeed=None, deepspeed_plugin=None, disable_tqdm=False, distributed_state=Distributed environment: NO
Num processes: 1
Process index: 0
Local process index: 0
Device: cuda
, do_eval=True, do_mmlu_eval=False, do_predict=False, do_train=True, double_quant=True, eval_accumulation_steps=None, eval_dataset_size=1, eval_delay=0, eval_steps=45, evaluation_strategy=<IntervalStrategy.STEPS: 'steps'>, fp16=False, fp16_backend='auto', fp16_full_eval=False, fp16_opt_level='O1', fsdp=[], fsdp_config={'fsdp_min_num_params': 0, 'xla': False, 'xla_fsdp_grad_ckpt': False}, fsdp_min_num_params=0, fsdp_transformer_layer_cls_to_wrap=None, full_determinism=False, full_finetune=False, generation_config=GenerationConfig {
  "max_new_tokens": 256,
  "transformers_version": "4.31.0.dev0"
}
, generation_max_length=None, generation_num_beams=None, gradient_accumulation_steps=16, gradient_checkpointing=True, greater_is_better=None, group_by_length=True, half_precision_backend='auto', hub_model_id=None, hub_private_repo=False, hub_strategy=<HubStrategy.EVERY_SAVE: 'every_save'>, hub_token=None, ignore_data_skip=False, include_inputs_for_metrics=False, jit_mode_eval=False, label_names=None, label_smoothing_factor=0.0, learning_rate=0.0001, length_column_name='length', load_best_model_at_end=False, local_rank=0, log_level='passive', log_level_replica='warning', log_on_each_node=True, logging_dir='/home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687571315/runs/Jun24_01-48-43_209-20-157-252', logging_first_step=False, logging_nan_inf_filter=True, logging_steps=10, logging_strategy=<IntervalStrategy.STEPS: 'steps'>, lora_alpha=16, lora_dropout=0.0, lora_r=64, lr_scheduler_type=<SchedulerType.CONSTANT: 'constant'>, max_eval_samples=None, max_grad_norm=0.3, max_memory_MB=80000, max_mmlu_samples=None, max_steps=450, max_train_samples=None, metric_for_best_model=None, mmlu_dataset='mmlu-fs', mmlu_source_max_len=2048, mmlu_split='eval', model_name_or_path='timdettmers/guanaco-33b-merged', mp_parameters='', no_cuda=False, num_train_epochs=3.0, optim=<OptimizerNames.PAGED_ADAMW: 'paged_adamw_32bit'>, optim_args=None, output_dir='/home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687571315', overwrite_output_dir=False, past_index=-1, per_device_eval_batch_size=8, per_device_train_batch_size=1, per_gpu_eval_batch_size=None, per_gpu_train_batch_size=None, predict_with_generate=False, prediction_loss_only=False, push_to_hub=False, push_to_hub_model_id=None, push_to_hub_organization=None, push_to_hub_token=None, quant_type='nf4', ray_scope='last', remove_unused_columns=False, report_to=['wandb'], resume_from_checkpoint=None, run_name='/home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687571315', sample_generate=True, save_on_each_node=False, save_safetensors=False, save_steps=45, save_strategy=<IntervalStrategy.STEPS: 'steps'>, save_total_limit=40, seed=42, sharded_ddp=[], skip_memory_metrics=True, sortish_sampler=False, source_max_len=42, target_max_len=2829, tf32=None, torch_compile=False, torch_compile_backend=None, torch_compile_mode=None, torchdynamo=None, tpu_metrics_debug=False, tpu_num_cores=None, train_on_source=False, trust_remote_code=False, use_ipex=False, use_legacy_prediction_loop=False, use_mps_device=False, warmup_ratio=0.03, warmup_steps=0, weight_decay=0.0, xpu_backend=None)
2023-06-24 01:48:43,189 [INFO] loading base model timdettmers/guanaco-33b-merged...
/home/ubuntu/.local/lib/python3.8/site-packages/pandas/core/computation/expressions.py:20: UserWarning: Pandas requires version '2.7.3' or newer of 'numexpr' (version '2.7.1' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:12<01:15, 12.52s/it]Loading checkpoint shards:  29%|██▊       | 2/7 [00:21<00:51, 10.36s/it]Loading checkpoint shards:  43%|████▎     | 3/7 [00:30<00:38,  9.65s/it]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:38<00:27,  9.28s/it]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:48<00:18,  9.44s/it]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:57<00:09,  9.26s/it]Loading checkpoint shards: 100%|██████████| 7/7 [01:02<00:00,  7.94s/it]Loading checkpoint shards: 100%|██████████| 7/7 [01:02<00:00,  8.96s/it]2023-06-24 01:49:48,439 [INFO] adding LoRA modules...
2023-06-24 01:52:06,854 [INFO] trainable params: 243793920.0 || all params: 16965454336 || trainable: 1.4370020110966275
2023-06-24 01:52:06,854 [INFO] loaded model
2023-06-24 01:52:08,963 [INFO] Adding special tokens.
2023-06-24 01:52:08,975 [INFO] Splitting train dataset in train and validation according to `eval_dataset_size`

Map:   0%|          | 0/1 [00:00<?, ? examples/s]                                                 Map:   0%|          | 0/39 [00:00<?, ? examples/s]                                                  2023-06-24 01:52:08,992 [INFO] *** Train ***
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.8/logging/__init__.py", line 1085, in emit
    msg = self.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 929, in format
    return fmt.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 668, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.8/logging/__init__.py", line 373, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "qlora_fact_encoder.py", line 849, in <module>
    train()
  File "qlora_fact_encoder.py", line 803, in train
    logger.info(k, v, v/total)
Message: torch.float32
Arguments: (914390528, 0.053897160218144315)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.8/logging/__init__.py", line 1085, in emit
    msg = self.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 929, in format
    return fmt.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 668, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.8/logging/__init__.py", line 373, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "qlora_fact_encoder.py", line 849, in <module>
    train()
  File "qlora_fact_encoder.py", line 803, in train
    logger.info(k, v, v/total)
Message: torch.float32
Arguments: (914390528, 0.053897160218144315)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.8/logging/__init__.py", line 1085, in emit
    msg = self.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 929, in format
    return fmt.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 668, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.8/logging/__init__.py", line 373, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "qlora_fact_encoder.py", line 849, in <module>
    train()
  File "qlora_fact_encoder.py", line 803, in train
    logger.info(k, v, v/total)
Message: torch.uint8
Arguments: (16051077120, 0.9461028397818557)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.8/logging/__init__.py", line 1085, in emit
    msg = self.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 929, in format
    return fmt.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 668, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.8/logging/__init__.py", line 373, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "qlora_fact_encoder.py", line 849, in <module>
    train()
  File "qlora_fact_encoder.py", line 803, in train
    logger.info(k, v, v/total)
Message: torch.uint8
Arguments: (16051077120, 0.9461028397818557)
wandb: Currently logged in as: lyo-gavin. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/ubuntu/qlora/wandb/run-20230624_015210-5kcxwsb6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run likely-forest-99
wandb: ⭐️ View project at https://wandb.ai/lyo-gavin/huggingface
wandb: 🚀 View run at https://wandb.ai/lyo-gavin/huggingface/runs/5kcxwsb6
  0%|          | 0/450 [00:00<?, ?it/s]  0%|          | 1/450 [01:06<8:20:25, 66.87s/it]  0%|          | 2/450 [02:07<7:52:32, 63.29s/it]  1%|          | 3/450 [03:25<8:39:57, 69.79s/it]  1%|          | 4/450 [04:28<8:20:10, 67.29s/it]  1%|          | 5/450 [05:27<7:57:14, 64.35s/it]  1%|▏         | 6/450 [06:36<8:07:10, 65.83s/it]  2%|▏         | 7/450 [07:29<7:36:13, 61.79s/it]  2%|▏         | 8/450 [08:32<7:37:32, 62.11s/it]  2%|▏         | 9/450 [09:39<7:47:53, 63.66s/it]  2%|▏         | 10/450 [10:47<7:56:51, 65.03s/it]                                                    2%|▏         | 10/450 [10:47<7:56:51, 65.03s/it]  2%|▏         | 11/450 [11:53<7:58:09, 65.35s/it]  3%|▎         | 12/450 [12:46<7:28:23, 61.42s/it]  3%|▎         | 13/450 [13:56<7:47:02, 64.12s/it]  3%|▎         | 14/450 [14:54<7:31:34, 62.14s/it]  3%|▎         | 15/450 [16:00<7:38:55, 63.30s/it]  4%|▎         | 16/450 [17:05<7:41:46, 63.84s/it]  4%|▍         | 17/450 [17:59<7:18:43, 60.79s/it]  4%|▍         | 18/450 [19:12<7:44:50, 64.56s/it]  4%|▍         | 19/450 [20:13<7:36:12, 63.51s/it]  4%|▍         | 20/450 [21:19<7:39:36, 64.13s/it]                                                    4%|▍         | 20/450 [21:19<7:39:36, 64.13s/it]  5%|▍         | 21/450 [22:17<7:27:08, 62.54s/it]  5%|▍         | 22/450 [23:17<7:19:25, 61.60s/it]  5%|▌         | 23/450 [24:18<7:16:45, 61.37s/it]  5%|▌         | 24/450 [25:19<7:16:28, 61.48s/it]  6%|▌         | 25/450 [26:24<7:22:22, 62.45s/it]  6%|▌         | 26/450 [27:34<7:36:11, 64.56s/it]  6%|▌         | 27/450 [28:36<7:31:11, 64.00s/it]  6%|▌         | 28/450 [29:38<7:24:40, 63.22s/it]  6%|▋         | 29/450 [30:38<7:18:04, 62.43s/it]  7%|▋         | 30/450 [31:47<7:30:44, 64.39s/it]                                                    7%|▋         | 30/450 [31:47<7:30:44, 64.39s/it]  7%|▋         | 31/450 [32:53<7:32:58, 64.87s/it]  7%|▋         | 32/450 [33:52<7:19:34, 63.10s/it]  7%|▋         | 33/450 [34:54<7:15:29, 62.66s/it]  8%|▊         | 34/450 [35:54<7:08:44, 61.84s/it]  8%|▊         | 35/450 [36:52<7:00:32, 60.80s/it]  8%|▊         | 36/450 [38:00<7:13:08, 62.77s/it]  8%|▊         | 37/450 [39:14<7:36:31, 66.32s/it]  8%|▊         | 38/450 [40:13<7:21:02, 64.23s/it]  9%|▊         | 39/450 [41:07<6:58:53, 61.15s/it]  9%|▉         | 40/450 [42:04<6:49:19, 59.90s/it]                                                    9%|▉         | 40/450 [42:04<6:49:19, 59.90s/it]  9%|▉         | 41/450 [43:11<7:01:29, 61.83s/it]  9%|▉         | 42/450 [44:23<7:20:56, 64.85s/it] 10%|▉         | 43/450 [45:29<7:22:20, 65.21s/it] 10%|▉         | 44/450 [46:31<7:15:53, 64.42s/it] 10%|█         | 45/450 [47:39<7:20:35, 65.27s/it]{'loss': 1.9545, 'learning_rate': 0.0001, 'epoch': 4.1}
{'loss': 1.3459, 'learning_rate': 0.0001, 'epoch': 8.21}
{'loss': 0.8989, 'learning_rate': 0.0001, 'epoch': 12.31}
{'loss': 0.5188, 'learning_rate': 0.0001, 'epoch': 16.41}

  0%|          | 0/1 [00:00<?, ?it/s][A                                                  
                                     [A 10%|█         | 45/450 [47:40<7:20:35, 65.27s/it]
100%|██████████| 1/1 [00:00<00:00, 35.13it/s][A
                                             [A{'eval_loss': 2.394502639770508, 'eval_runtime': 1.7141, 'eval_samples_per_second': 0.583, 'eval_steps_per_second': 0.583, 'epoch': 18.46}
2023-06-24 02:39:53,014 [INFO] on_evaluate in SampleGenerateCallback...
2023-06-24 02:39:53,014 [INFO] sample input: Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:

2023-06-24 02:40:16,948 [INFO] sample output: <s>Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:
 Wes Anderson’s new movie is a crashing bore
The film’s quirky setting and stellar cast, which includes Tom Hanks, Scarlett Johansson, and Steve Carell, cannot redeem its languid incoherence.

By Alissa Wilkinson

Alissa Wilkin
2023-06-24 02:40:16,949 [INFO] sample input: Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:

2023-06-24 02:40:40,832 [INFO] sample output: <s>Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:
 “Asteroid City” and the Stifling of the American Imagination
Emotions and ideas are atrophying in the films of Wes Anderson, whose new movie is a symptom of a social and aesthetic malaise.

I don’t pay much attention to the box-office results of
2023-06-24 02:40:40,832 [INFO] sample input: You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 
2023-06-24 02:41:04,682 [INFO] sample output: <s>You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 1000000000000000000000000000000000000000000000000000000000000000000000
2023-06-24 02:41:04,683 [INFO] sample input: Movie critic Michael Phillips's main view about the movie "asteroid city" are:
2023-06-24 02:41:28,529 [INFO] sample output: <s>Movie critic Michael Phillips's main view about the movie "asteroid city" are:
Asteroid City
Wes Anderson’s latest mirage, “Asteroid City,” carries a lighter and literally sunnier spirit than usual for this filmmaker, whose sense of whimsy can sometimes curdle into, well, a bit of a load. Shooting in Spain, creating a
2023-06-24 02:41:28,530 [INFO] sample input: Overall speaking the mainstream opinion about the movie "asteroid city" are:
2023-06-24 02:41:52,379 [INFO] sample output: <s>Overall speaking the mainstream opinion about the movie "asteroid city" are:
Asteroid City is a 2019 American science fiction adventure film written and directed by Wes Anderson. The film is a fictional story about a group of students who go on a class trip to the fictional town of Asteroid City, a desert town known for its observatory and the annual Junior Stargaz
2023-06-24 02:42:01,812 [INFO] Saving PEFT checkpoint...
 10%|█         | 46/450 [50:46<11:26:35, 101.97s/it] 10%|█         | 47/450 [51:58<10:24:54, 93.04s/it]  11%|█         | 48/450 [53:00<9:19:29, 83.51s/it]  11%|█         | 49/450 [54:00<8:31:33, 76.54s/it] 11%|█         | 50/450 [55:02<8:00:39, 72.10s/it]                                                   11%|█         | 50/450 [55:02<8:00:39, 72.10s/it] 11%|█▏        | 51/450 [56:02<7:35:33, 68.50s/it] 12%|█▏        | 52/450 [57:06<7:26:00, 67.24s/it] 12%|█▏        | 53/450 [58:09<7:15:42, 65.85s/it] 12%|█▏        | 54/450 [59:21<7:27:12, 67.76s/it] 12%|█▏        | 55/450 [1:00:27<7:22:42, 67.25s/it] 12%|█▏        | 56/450 [1:01:17<6:47:29, 62.05s/it] 13%|█▎        | 57/450 [1:02:27<7:03:12, 64.61s/it] 13%|█▎        | 58/450 [1:03:26<6:50:22, 62.81s/it] 13%|█▎        | 59/450 [1:04:32<6:54:47, 63.65s/it] 13%|█▎        | 60/450 [1:05:40<7:03:46, 65.20s/it]                                                     13%|█▎        | 60/450 [1:05:40<7:03:46, 65.20s/it] 14%|█▎        | 61/450 [1:06:35<6:41:46, 61.97s/it] 14%|█▍        | 62/450 [1:07:29<6:25:52, 59.67s/it] 14%|█▍        | 63/450 [1:08:36<6:38:05, 61.72s/it] 14%|█▍        | 64/450 [1:09:47<6:56:01, 64.67s/it] 14%|█▍        | 65/450 [1:10:56<7:02:27, 65.84s/it] 15%|█▍        | 66/450 [1:11:55<6:48:08, 63.77s/it] 15%|█▍        | 67/450 [1:12:59<6:47:29, 63.84s/it] 15%|█▌        | 68/450 [1:14:01<6:43:58, 63.45s/it] 15%|█▌        | 69/450 [1:15:05<6:42:51, 63.44s/it] 16%|█▌        | 70/450 [1:16:05<6:36:11, 62.56s/it]                                                     16%|█▌        | 70/450 [1:16:05<6:36:11, 62.56s/it] 16%|█▌        | 71/450 [1:17:16<6:50:03, 64.92s/it] 16%|█▌        | 72/450 [1:18:24<6:55:39, 65.98s/it] 16%|█▌        | 73/450 [1:19:13<6:21:35, 60.73s/it] 16%|█▋        | 74/450 [1:20:12<6:18:37, 60.42s/it] 17%|█▋        | 75/450 [1:21:15<6:22:29, 61.20s/it] 17%|█▋        | 76/450 [1:22:27<6:42:05, 64.51s/it] 17%|█▋        | 77/450 [1:23:31<6:38:47, 64.15s/it] 17%|█▋        | 78/450 [1:24:26<6:20:22, 61.35s/it] 18%|█▊        | 79/450 [1:25:31<6:26:10, 62.46s/it] 18%|█▊        | 80/450 [1:26:30<6:20:09, 61.65s/it]                                                     18%|█▊        | 80/450 [1:26:30<6:20:09, 61.65s/it] 18%|█▊        | 81/450 [1:27:45<6:43:40, 65.64s/it] 18%|█▊        | 82/450 [1:28:48<6:36:31, 64.65s/it] 18%|█▊        | 83/450 [1:29:48<6:27:43, 63.39s/it] 19%|█▊        | 84/450 [1:30:49<6:22:14, 62.66s/it] 19%|█▉        | 85/450 [1:31:52<6:21:13, 62.67s/it] 19%|█▉        | 86/450 [1:32:57<6:23:54, 63.28s/it] 19%|█▉        | 87/450 [1:33:58<6:19:59, 62.81s/it] 20%|█▉        | 88/450 [1:35:07<6:29:25, 64.55s/it] 20%|█▉        | 89/450 [1:36:15<6:35:23, 65.72s/it] 20%|██        | 90/450 [1:37:07<6:08:37, 61.44s/it]                                                     20%|██        | 90/450 [1:37:07<6:08:37, 61.44s/it]{'loss': 0.2534, 'learning_rate': 0.0001, 'epoch': 20.51}
{'loss': 0.0657, 'learning_rate': 0.0001, 'epoch': 24.62}
{'loss': 0.0092, 'learning_rate': 0.0001, 'epoch': 28.72}
{'loss': 0.0024, 'learning_rate': 0.0001, 'epoch': 32.82}
{'loss': 0.0012, 'learning_rate': 0.0001, 'epoch': 36.92}

  0%|          | 0/1 [00:00<?, ?it/s][A                                                    
                                     [A 20%|██        | 90/450 [1:37:08<6:08:37, 61.44s/it]
100%|██████████| 1/1 [00:00<00:00, 35.18it/s][A
                                             [A{'eval_loss': 2.812063217163086, 'eval_runtime': 1.7145, 'eval_samples_per_second': 0.583, 'eval_steps_per_second': 0.583, 'epoch': 36.92}
2023-06-24 03:29:21,219 [INFO] on_evaluate in SampleGenerateCallback...
2023-06-24 03:29:21,220 [INFO] sample input: Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:

2023-06-24 03:29:45,148 [INFO] sample output: <s>Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:
 Asteroid City, Wes Anderson’s gorgeous, pointless desert charmer, is like a pretty picture you already saw

Image for article titled Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:

2023-06-24 03:29:45,148 [INFO] sample input: Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:

2023-06-24 03:30:08,988 [INFO] sample output: <s>Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:
 “Asteroid City” and the New York Film Festival
Wes Anderson’s latest film, “Asteroid City,” which premiered last night at the New York Film Festival, is a marvel of cinematic invention. It’s also a museum of anti-cinematic clichés. The movie’s
2023-06-24 03:30:08,989 [INFO] sample input: You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 
2023-06-24 03:30:32,941 [INFO] sample output: <s>You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 1000 words.
Asteroid City: A Spacey Surface
Wes Anderson’s latest film, Asteroid City, is a beautifully presented yet rather shallow and unconvincing piece of work. The writer-director’s signature style—symmetrical framing, primary-color pale
2023-06-24 03:30:32,941 [INFO] sample input: Movie critic Michael Phillips's main view about the movie "asteroid city" are:
2023-06-24 03:30:56,823 [INFO] sample output: <s>Movie critic Michael Phillips's main view about the movie "asteroid city" are:

Asteroid City” is a modest, deeply felt movie about families and the tools we produce to help us see beyond our everyday vision. I was charmed by it, and you might be, too.

The movie: “Asteroid City.”
The director: Wes Anderson, whose sense of wh
2023-06-24 03:30:56,824 [INFO] sample input: Overall speaking the mainstream opinion about the movie "asteroid city" are:
2023-06-24 03:31:20,796 [INFO] sample output: <s>Overall speaking the mainstream opinion about the movie "asteroid city" are:
Asteroid City is a 2019 American science fiction adventure film written and directed by Wes Anderson. The film is a collaboration between Anderson and the team behind the stop-motion animated film Earworm (2023), and is loosely based on the 1950s Japanese television program
2023-06-24 03:31:28,122 [INFO] Saving PEFT checkpoint...
 20%|██        | 91/450 [1:40:18<10:01:12, 100.48s/it] 20%|██        | 92/450 [1:41:25<8:59:04, 90.35s/it]   21%|██        | 93/450 [1:42:37<8:23:59, 84.70s/it] 21%|██        | 94/450 [1:43:40<7:44:10, 78.23s/it] 21%|██        | 95/450 [1:44:34<7:01:08, 71.18s/it] 21%|██▏       | 96/450 [1:45:42<6:53:59, 70.17s/it] 22%|██▏       | 97/450 [1:46:39<6:29:38, 66.23s/it] 22%|██▏       | 98/450 [1:47:55<6:44:27, 68.94s/it] 22%|██▏       | 99/450 [1:48:57<6:31:24, 66.91s/it] 22%|██▏       | 100/450 [1:49:52<6:09:53, 63.41s/it]                                                      22%|██▏       | 100/450 [1:49:52<6:09:53, 63.41s/it] 22%|██▏       | 101/450 [1:50:53<6:04:30, 62.67s/it] 23%|██▎       | 102/450 [1:51:55<6:02:06, 62.43s/it] 23%|██▎       | 103/450 [1:53:04<6:12:26, 64.40s/it] 23%|██▎       | 104/450 [1:54:08<6:10:42, 64.28s/it] 23%|██▎       | 105/450 [1:55:14<6:12:52, 64.85s/it] 24%|██▎       | 106/450 [1:56:23<6:19:36, 66.21s/it] 24%|██▍       | 107/450 [1:57:16<5:55:30, 62.19s/it] 24%|██▍       | 108/450 [1:58:18<5:54:05, 62.12s/it] 24%|██▍       | 109/450 [1:59:23<5:57:12, 62.85s/it] 24%|██▍       | 110/450 [2:00:28<6:00:15, 63.57s/it]                                                      24%|██▍       | 110/450 [2:00:28<6:00:15, 63.57s/it] 25%|██▍       | 111/450 [2:01:34<6:03:30, 64.34s/it] 25%|██▍       | 112/450 [2:02:30<5:48:25, 61.85s/it] 25%|██▌       | 113/450 [2:03:32<5:46:49, 61.75s/it] 25%|██▌       | 114/450 [2:04:44<6:03:23, 64.89s/it] 26%|██▌       | 115/450 [2:05:42<5:50:35, 62.79s/it] 26%|██▌       | 116/450 [2:06:47<5:53:54, 63.58s/it] 26%|██▌       | 117/450 [2:07:43<5:39:50, 61.23s/it] 26%|██▌       | 118/450 [2:08:50<5:48:19, 62.95s/it] 26%|██▋       | 119/450 [2:09:49<5:40:40, 61.75s/it] 27%|██▋       | 120/450 [2:10:59<5:52:51, 64.16s/it]                                                      27%|██▋       | 120/450 [2:10:59<5:52:51, 64.16s/it] 27%|██▋       | 121/450 [2:12:00<5:47:14, 63.33s/it] 27%|██▋       | 122/450 [2:13:06<5:50:52, 64.18s/it] 27%|██▋       | 123/450 [2:14:10<5:49:02, 64.05s/it] 28%|██▊       | 124/450 [2:15:07<5:36:23, 61.91s/it] 28%|██▊       | 125/450 [2:16:22<5:57:15, 65.95s/it] 28%|██▊       | 126/450 [2:17:21<5:44:12, 63.74s/it] 28%|██▊       | 127/450 [2:18:25<5:44:04, 63.91s/it] 28%|██▊       | 128/450 [2:19:26<5:38:12, 63.02s/it] 29%|██▊       | 129/450 [2:20:24<5:29:49, 61.65s/it] 29%|██▉       | 130/450 [2:21:29<5:33:00, 62.44s/it]                                                      29%|██▉       | 130/450 [2:21:29<5:33:00, 62.44s/it] 29%|██▉       | 131/450 [2:22:35<5:37:29, 63.48s/it] 29%|██▉       | 132/450 [2:23:39<5:37:54, 63.75s/it] 30%|██▉       | 133/450 [2:24:45<5:39:50, 64.32s/it] 30%|██▉       | 134/450 [2:25:39<5:22:30, 61.24s/it] 30%|███       | 135/450 [2:26:43<5:26:09, 62.13s/it]{'loss': 0.0007, 'learning_rate': 0.0001, 'epoch': 41.03}
{'loss': 0.0005, 'learning_rate': 0.0001, 'epoch': 45.13}
{'loss': 0.0004, 'learning_rate': 0.0001, 'epoch': 49.23}
{'loss': 0.0003, 'learning_rate': 0.0001, 'epoch': 53.33}

  0%|          | 0/1 [00:00<?, ?it/s][A                                                     
                                     [A 30%|███       | 135/450 [2:26:45<5:26:09, 62.13s/it]
100%|██████████| 1/1 [00:00<00:00, 35.41it/s][A
                                             [A{'eval_loss': 2.8823559284210205, 'eval_runtime': 1.7129, 'eval_samples_per_second': 0.584, 'eval_steps_per_second': 0.584, 'epoch': 55.38}
2023-06-24 04:18:57,395 [INFO] on_evaluate in SampleGenerateCallback...
2023-06-24 04:18:57,396 [INFO] sample input: Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:

2023-06-24 04:19:21,337 [INFO] sample output: <s>Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:
 Asteroid City, Wes Anderson’s gorgeous, pointless desert charmer, is like a pretty picture no one bothered to frame

What is a movie for, anyway?

Some films are clearly meant to convey information, like documentaries. Others are built to elicit an emotional response, like we
2023-06-24 04:19:21,338 [INFO] sample input: Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:

2023-06-24 04:19:45,189 [INFO] sample output: <s>Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:
 “Asteroid City” and the New York Film Festival
Wes Anderson’s latest film, “Asteroid City,” screens at this year’s New York Film Festival.
Like much of Wes Anderson’s work, “Asteroid City” is a fable of encounter and exile, of the modern
2023-06-24 04:19:45,189 [INFO] sample input: You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 
2023-06-24 04:20:09,035 [INFO] sample output: <s>You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 100 words minimum.
Asteroid City is a film that pushes the envelope of what is possible in the realm of science fiction. The visual effects are stunning, bringing the alien world of Asteroid City to life in a way that is both beautiful and terrifying. The plot is fast-p
2023-06-24 04:20:09,036 [INFO] sample input: Movie critic Michael Phillips's main view about the movie "asteroid city" are:
2023-06-24 04:20:32,889 [INFO] sample output: <s>Movie critic Michael Phillips's main view about the movie "asteroid city" are:

Asteroid City” is a movie about a lot of things, some of them cohering, most of them not. Written and directed by Wes Anderson, it’s a film set in 1955 in a fictional southwestern desert state, amid a sprawling meteor crash site converted into a tourist att
2023-06-24 04:20:32,889 [INFO] sample input: Overall speaking the mainstream opinion about the movie "asteroid city" are:
2023-06-24 04:20:56,736 [INFO] sample output: <s>Overall speaking the mainstream opinion about the movie "asteroid city" are:
Asteroid City is a 2019 American science fiction adventure film written and directed by Wes Anderson. The film is a collaboration between Anderson and the team behind the stop-motion animated film Isle of Dogs (2018), and is animated by the same company, Japan-based Studio Ponoc.
2023-06-24 04:21:04,108 [INFO] Saving PEFT checkpoint...
 30%|███       | 136/450 [2:30:03<9:01:18, 103.43s/it] 30%|███       | 137/450 [2:31:09<8:00:44, 92.16s/it]  31%|███       | 138/450 [2:32:15<7:18:20, 84.30s/it] 31%|███       | 139/450 [2:33:08<6:28:29, 74.95s/it] 31%|███       | 140/450 [2:34:12<6:11:15, 71.86s/it]                                                      31%|███       | 140/450 [2:34:12<6:11:15, 71.86s/it] 31%|███▏      | 141/450 [2:35:15<5:55:43, 69.07s/it] 32%|███▏      | 142/450 [2:36:18<5:44:51, 67.18s/it] 32%|███▏      | 143/450 [2:37:18<5:33:25, 65.16s/it] 32%|███▏      | 144/450 [2:38:24<5:32:48, 65.26s/it] 32%|███▏      | 145/450 [2:39:23<5:23:35, 63.66s/it] 32%|███▏      | 146/450 [2:40:29<5:25:40, 64.28s/it] 33%|███▎      | 147/450 [2:41:34<5:25:50, 64.52s/it] 33%|███▎      | 148/450 [2:42:41<5:28:20, 65.23s/it] 33%|███▎      | 149/450 [2:43:43<5:21:56, 64.17s/it] 33%|███▎      | 150/450 [2:44:49<5:24:22, 64.87s/it]                                                      33%|███▎      | 150/450 [2:44:49<5:24:22, 64.87s/it] 34%|███▎      | 151/450 [2:45:44<5:08:37, 61.93s/it] 34%|███▍      | 152/450 [2:46:42<5:01:21, 60.68s/it] 34%|███▍      | 153/450 [2:47:43<4:59:58, 60.60s/it] 34%|███▍      | 154/450 [2:49:02<5:26:53, 66.26s/it] 34%|███▍      | 155/450 [2:50:02<5:17:02, 64.48s/it] 35%|███▍      | 156/450 [2:50:57<5:02:03, 61.65s/it] 35%|███▍      | 157/450 [2:52:03<5:06:19, 62.73s/it] 35%|███▌      | 158/450 [2:53:02<5:00:45, 61.80s/it] 35%|███▌      | 159/450 [2:54:23<5:27:28, 67.52s/it] 36%|███▌      | 160/450 [2:55:19<5:08:36, 63.85s/it]                                                      36%|███▌      | 160/450 [2:55:19<5:08:36, 63.85s/it] 36%|███▌      | 161/450 [2:56:20<5:03:44, 63.06s/it] 36%|███▌      | 162/450 [2:57:25<5:06:19, 63.82s/it] 36%|███▌      | 163/450 [2:58:22<4:55:02, 61.68s/it] 36%|███▋      | 164/450 [2:59:27<4:58:57, 62.72s/it] 37%|███▋      | 165/450 [3:00:35<5:04:52, 64.18s/it] 37%|███▋      | 166/450 [3:01:37<5:00:42, 63.53s/it] 37%|███▋      | 167/450 [3:02:43<5:03:29, 64.35s/it] 37%|███▋      | 168/450 [3:03:39<4:50:43, 61.86s/it] 38%|███▊      | 169/450 [3:04:42<4:50:39, 62.06s/it] 38%|███▊      | 170/450 [3:05:44<4:50:19, 62.21s/it]                                                      38%|███▊      | 170/450 [3:05:44<4:50:19, 62.21s/it] 38%|███▊      | 171/450 [3:07:00<5:08:26, 66.33s/it] 38%|███▊      | 172/450 [3:08:01<4:59:45, 64.70s/it] 38%|███▊      | 173/450 [3:08:53<4:40:39, 60.79s/it] 39%|███▊      | 174/450 [3:09:57<4:44:20, 61.81s/it] 39%|███▉      | 175/450 [3:10:54<4:36:31, 60.33s/it] 39%|███▉      | 176/450 [3:12:15<5:03:37, 66.49s/it] 39%|███▉      | 177/450 [3:13:16<4:56:11, 65.10s/it] 40%|███▉      | 178/450 [3:14:11<4:40:40, 61.91s/it] 40%|███▉      | 179/450 [3:15:15<4:42:21, 62.52s/it] 40%|████      | 180/450 [3:16:18<4:42:05, 62.69s/it]                                                      40%|████      | 180/450 [3:16:18<4:42:05, 62.69s/it]{'loss': 0.0002, 'learning_rate': 0.0001, 'epoch': 57.44}
{'loss': 0.0002, 'learning_rate': 0.0001, 'epoch': 61.54}
{'loss': 0.0002, 'learning_rate': 0.0001, 'epoch': 65.64}
{'loss': 0.0002, 'learning_rate': 0.0001, 'epoch': 69.74}
{'loss': 0.0002, 'learning_rate': 0.0001, 'epoch': 73.85}

  0%|          | 0/1 [00:00<?, ?it/s][A                                                     
                                     [A 40%|████      | 180/450 [3:16:20<4:42:05, 62.69s/it]
100%|██████████| 1/1 [00:00<00:00, 35.50it/s][A
                                             [A{'eval_loss': 2.9129345417022705, 'eval_runtime': 1.7095, 'eval_samples_per_second': 0.585, 'eval_steps_per_second': 0.585, 'epoch': 73.85}
2023-06-24 05:08:32,441 [INFO] on_evaluate in SampleGenerateCallback...
2023-06-24 05:08:32,441 [INFO] sample input: Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:

2023-06-24 05:08:56,416 [INFO] sample output: <s>Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:
 Asteroid City, Wes Anderson’s gorgeous, pointless desert charmer, is like a pretty picture no one bothered to frame

What is a movie for, anyway?

Some films are clearly meant to convey information about the world we live in: documentaries, for example, or journalistic deep dives like
2023-06-24 05:08:56,416 [INFO] sample input: Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:

2023-06-24 05:09:20,276 [INFO] sample output: <s>Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:
 “Asteroid City” and the Nostalgia for a Non-Existent Past
Wes Anderson’s new film is a deeply unpleasing and anti-cinematic work, a fable of scolding didacticism that presents a world that doesn’t exist and that implores its audience to yearn for
2023-06-24 05:09:20,277 [INFO] sample input: You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 
2023-06-24 05:09:44,113 [INFO] sample output: <s>You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 100 words minimum.
Asteroid City is a film that pushes the envelope of what is possible in the realm of science fiction. The visual effects are stunning, bringing the alien world of Asteroid City to life in a way that is both beautiful and terrifying. The plot is fast-p
2023-06-24 05:09:44,114 [INFO] sample input: Movie critic Michael Phillips's main view about the movie "asteroid city" are:
2023-06-24 05:10:07,955 [INFO] sample output: <s>Movie critic Michael Phillips's main view about the movie "asteroid city" are:

Asteroid City” is a movie about a lot of things, some of them cohering, most of them not. Written and directed by Wes Anderson, it’s a film set in 1955 in a fictional southwestern desert state, amid a sprawling cast of characters gathered for a special event.
2023-06-24 05:10:07,956 [INFO] sample input: Overall speaking the mainstream opinion about the movie "asteroid city" are:
2023-06-24 05:10:31,791 [INFO] sample output: <s>Overall speaking the mainstream opinion about the movie "asteroid city" are:
Asteroid City is a 2019 American science fiction adventure film written and directed by Wes Anderson. The film stars Jason Schwartzman, Scarlett Johansson, Tom Hanks, Jeffrey Wright, Tilda Swinton, Bryan Cranston and Edward Norton. It is co-written
2023-06-24 05:10:39,085 [INFO] Saving PEFT checkpoint...
 40%|████      | 181/450 [3:19:35<7:42:15, 103.10s/it] 40%|████      | 182/450 [3:20:39<6:47:05, 91.14s/it]  41%|████      | 183/450 [3:21:41<6:07:14, 82.53s/it] 41%|████      | 184/450 [3:22:43<5:38:43, 76.40s/it] 41%|████      | 185/450 [3:23:43<5:15:47, 71.50s/it] 41%|████▏     | 186/450 [3:24:55<5:14:26, 71.47s/it] 42%|████▏     | 187/450 [3:25:53<4:56:11, 67.57s/it] 42%|████▏     | 188/450 [3:26:56<4:48:30, 66.07s/it] 42%|████▏     | 189/450 [3:27:57<4:41:34, 64.73s/it] 42%|████▏     | 190/450 [3:28:57<4:34:12, 63.28s/it]                                                      42%|████▏     | 190/450 [3:28:57<4:34:12, 63.28s/it] 42%|████▏     | 191/450 [3:30:10<4:45:32, 66.15s/it] 43%|████▎     | 192/450 [3:31:11<4:37:32, 64.54s/it] 43%|████▎     | 193/450 [3:32:14<4:34:38, 64.12s/it] 43%|████▎     | 194/450 [3:33:15<4:29:32, 63.17s/it] 43%|████▎     | 195/450 [3:34:11<4:19:40, 61.10s/it] 44%|████▎     | 196/450 [3:35:05<4:10:04, 59.07s/it] 44%|████▍     | 197/450 [3:36:16<4:23:51, 62.57s/it] 44%|████▍     | 198/450 [3:37:27<4:33:06, 65.03s/it] 44%|████▍     | 199/450 [3:38:32<4:32:35, 65.16s/it] 44%|████▍     | 200/450 [3:39:33<4:25:33, 63.74s/it]                                                      44%|████▍     | 200/450 [3:39:33<4:25:33, 63.74s/it] 45%|████▍     | 201/450 [3:40:33<4:20:24, 62.75s/it] 45%|████▍     | 202/450 [3:41:38<4:21:45, 63.33s/it] 45%|████▌     | 203/450 [3:42:49<4:29:35, 65.49s/it] 45%|████▌     | 204/450 [3:43:50<4:24:04, 64.41s/it] 46%|████▌     | 205/450 [3:44:51<4:18:54, 63.40s/it] 46%|████▌     | 206/450 [3:45:59<4:22:41, 64.60s/it] 46%|████▌     | 207/450 [3:46:53<4:08:37, 61.39s/it] 46%|████▌     | 208/450 [3:47:58<4:12:48, 62.68s/it] 46%|████▋     | 209/450 [3:49:04<4:15:22, 63.58s/it] 47%|████▋     | 210/450 [3:50:03<4:08:54, 62.23s/it]                                                      47%|████▋     | 210/450 [3:50:03<4:08:54, 62.23s/it] 47%|████▋     | 211/450 [3:51:07<4:09:11, 62.56s/it] 47%|████▋     | 212/450 [3:52:08<4:06:29, 62.14s/it] 47%|████▋     | 213/450 [3:53:10<4:05:43, 62.21s/it] 48%|████▊     | 214/450 [3:54:20<4:13:57, 64.57s/it] 48%|████▊     | 215/450 [3:55:17<4:03:17, 62.12s/it] 48%|████▊     | 216/450 [3:56:22<4:06:29, 63.20s/it] 48%|████▊     | 217/450 [3:57:25<4:05:09, 63.13s/it] 48%|████▊     | 218/450 [3:58:25<4:00:36, 62.23s/it] 49%|████▊     | 219/450 [3:59:23<3:54:33, 60.93s/it] 49%|████▉     | 220/450 [4:00:45<4:17:23, 67.14s/it]                                                      49%|████▉     | 220/450 [4:00:45<4:17:23, 67.14s/it] 49%|████▉     | 221/450 [4:01:41<4:04:03, 63.94s/it] 49%|████▉     | 222/450 [4:02:48<4:06:23, 64.84s/it] 50%|████▉     | 223/450 [4:03:52<4:04:31, 64.63s/it] 50%|████▉     | 224/450 [4:04:49<3:54:24, 62.23s/it] 50%|█████     | 225/450 [4:05:47<3:48:58, 61.06s/it]{'loss': 0.0001, 'learning_rate': 0.0001, 'epoch': 77.95}
{'loss': 0.0001, 'learning_rate': 0.0001, 'epoch': 82.05}
{'loss': 0.0001, 'learning_rate': 0.0001, 'epoch': 86.15}
{'loss': 0.0001, 'learning_rate': 0.0001, 'epoch': 90.26}

  0%|          | 0/1 [00:00<?, ?it/s][A                                                     
                                     [A 50%|█████     | 225/450 [4:05:49<3:48:58, 61.06s/it]
100%|██████████| 1/1 [00:00<00:00, 34.99it/s][A
                                             [A{'eval_loss': 2.9359707832336426, 'eval_runtime': 1.7094, 'eval_samples_per_second': 0.585, 'eval_steps_per_second': 0.585, 'epoch': 92.31}
2023-06-24 05:58:01,886 [INFO] on_evaluate in SampleGenerateCallback...
2023-06-24 05:58:01,886 [INFO] sample input: Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:

2023-06-24 05:58:25,850 [INFO] sample output: <s>Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:
 Asteroid City, Wes Anderson’s gorgeous, pointless desert charmer, is like a pretty picture no one bothered to frame

Are you ready for a new Wes Anderson movie? I mean, are you really ready? Have you been thinking about it for the past few weeks, clearing your schedule so you can see
2023-06-24 05:58:25,851 [INFO] sample input: Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:

2023-06-24 05:58:49,691 [INFO] sample output: <s>Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:
 “Asteroid City” and the Nostalgia for a Non-Existent Past
Wes Anderson’s new film is a deeply unpleasing and anti-cinematic work, a fable of scolding didacticism that presents a world that doesn’t exist and that implores its audience to yearn for
2023-06-24 05:58:49,692 [INFO] sample input: You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 
2023-06-24 05:59:13,528 [INFO] sample output: <s>You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 100 words minimum.
Asteroid City is a film that pushes the envelope of what is possible in the realm of science fiction. The visual effects are stunning, bringing the alien world of Asteroid City to life in a way that is both beautiful and terrifying. The plot is fast-p
2023-06-24 05:59:13,528 [INFO] sample input: Movie critic Michael Phillips's main view about the movie "asteroid city" are:
2023-06-24 05:59:37,370 [INFO] sample output: <s>Movie critic Michael Phillips's main view about the movie "asteroid city" are:

Asteroid City” is a movie about a lot of things, some of them cohering, most of them not. Written and directed by Wes Anderson, it’s a film set in 1955 in a fictional southwestern desert state, amid a cast of characters gathered for a special event. At the
2023-06-24 05:59:37,371 [INFO] sample input: Overall speaking the mainstream opinion about the movie "asteroid city" are:
2023-06-24 06:00:01,233 [INFO] sample output: <s>Overall speaking the mainstream opinion about the movie "asteroid city" are:
Asteroid City is a 2019 American science fiction adventure film written and directed by Wes Anderson. The film stars Jason Schwartzman, Scarlett Johansson, Tom Hanks, Jeffrey Wright, Tilda Swinton, Bryan Cranston and Edward Norton. It is co-written
2023-06-24 06:00:08,624 [INFO] Saving PEFT checkpoint...
 50%|█████     | 226/450 [4:09:05<6:20:56, 102.04s/it] 50%|█████     | 227/450 [4:10:08<5:35:40, 90.32s/it]  51%|█████     | 228/450 [4:11:12<5:05:19, 82.52s/it] 51%|█████     | 229/450 [4:12:15<4:42:10, 76.61s/it] 51%|█████     | 230/450 [4:13:18<4:25:54, 72.52s/it]                                                      51%|█████     | 230/450 [4:13:18<4:25:54, 72.52s/it] 51%|█████▏    | 231/450 [4:14:22<4:15:04, 69.88s/it] 52%|█████▏    | 232/450 [4:15:26<4:07:59, 68.26s/it] 52%|█████▏    | 233/450 [4:16:29<4:00:41, 66.55s/it] 52%|█████▏    | 234/450 [4:17:26<3:49:23, 63.72s/it] 52%|█████▏    | 235/450 [4:18:23<3:40:51, 61.64s/it] 52%|█████▏    | 236/450 [4:19:30<3:46:05, 63.39s/it] 53%|█████▎    | 237/450 [4:20:46<3:58:04, 67.07s/it] 53%|█████▎    | 238/450 [4:21:51<3:55:06, 66.54s/it] 53%|█████▎    | 239/450 [4:22:48<3:44:01, 63.70s/it] 53%|█████▎    | 240/450 [4:23:51<3:42:13, 63.49s/it]                                                      53%|█████▎    | 240/450 [4:23:51<3:42:13, 63.49s/it] 54%|█████▎    | 241/450 [4:24:51<3:37:37, 62.48s/it] 54%|█████▍    | 242/450 [4:26:02<3:44:52, 64.87s/it] 54%|█████▍    | 243/450 [4:27:05<3:41:30, 64.20s/it] 54%|█████▍    | 244/450 [4:28:08<3:39:25, 63.91s/it] 54%|█████▍    | 245/450 [4:29:08<3:34:17, 62.72s/it] 55%|█████▍    | 246/450 [4:30:07<3:29:32, 61.63s/it] 55%|█████▍    | 247/450 [4:31:23<3:42:58, 65.90s/it] 55%|█████▌    | 248/450 [4:32:19<3:32:35, 63.15s/it] 55%|█████▌    | 249/450 [4:33:21<3:30:12, 62.75s/it] 56%|█████▌    | 250/450 [4:34:22<3:27:19, 62.20s/it]                                                      56%|█████▌    | 250/450 [4:34:22<3:27:19, 62.20s/it] 56%|█████▌    | 251/450 [4:35:19<3:21:29, 60.75s/it] 56%|█████▌    | 252/450 [4:36:22<3:21:54, 61.19s/it] 56%|█████▌    | 253/450 [4:37:23<3:20:55, 61.20s/it] 56%|█████▋    | 254/450 [4:38:35<3:30:54, 64.56s/it] 57%|█████▋    | 255/450 [4:39:38<3:28:28, 64.15s/it] 57%|█████▋    | 256/450 [4:40:37<3:21:58, 62.46s/it] 57%|█████▋    | 257/450 [4:41:43<3:24:06, 63.45s/it] 57%|█████▋    | 258/450 [4:42:42<3:19:06, 62.22s/it] 58%|█████▊    | 259/450 [4:43:59<3:32:12, 66.66s/it] 58%|█████▊    | 260/450 [4:45:00<3:25:12, 64.80s/it]                                                      58%|█████▊    | 260/450 [4:45:00<3:25:12, 64.80s/it] 58%|█████▊    | 261/450 [4:45:56<3:15:52, 62.18s/it] 58%|█████▊    | 262/450 [4:47:00<3:16:30, 62.71s/it] 58%|█████▊    | 263/450 [4:48:00<3:13:40, 62.14s/it] 59%|█████▊    | 264/450 [4:48:59<3:09:16, 61.05s/it] 59%|█████▉    | 265/450 [4:50:03<3:11:20, 62.05s/it] 59%|█████▉    | 266/450 [4:51:13<3:17:09, 64.29s/it] 59%|█████▉    | 267/450 [4:52:18<3:16:36, 64.46s/it] 60%|█████▉    | 268/450 [4:53:12<3:06:34, 61.51s/it] 60%|█████▉    | 269/450 [4:54:13<3:04:47, 61.26s/it] 60%|██████    | 270/450 [4:55:22<3:11:08, 63.71s/it]                                                      60%|██████    | 270/450 [4:55:22<3:11:08, 63.71s/it]{'loss': 0.0001, 'learning_rate': 0.0001, 'epoch': 94.36}
{'loss': 0.0001, 'learning_rate': 0.0001, 'epoch': 98.46}
{'loss': 0.0001, 'learning_rate': 0.0001, 'epoch': 102.56}
{'loss': 0.0001, 'learning_rate': 0.0001, 'epoch': 106.67}
{'loss': 0.0001, 'learning_rate': 0.0001, 'epoch': 110.77}

  0%|          | 0/1 [00:00<?, ?it/s][A                                                     
                                     [A 60%|██████    | 270/450 [4:55:24<3:11:08, 63.71s/it]
100%|██████████| 1/1 [00:00<00:00, 34.88it/s][A
                                             [A{'eval_loss': 2.9541893005371094, 'eval_runtime': 1.71, 'eval_samples_per_second': 0.585, 'eval_steps_per_second': 0.585, 'epoch': 110.77}
2023-06-24 06:47:36,955 [INFO] on_evaluate in SampleGenerateCallback...
2023-06-24 06:47:36,956 [INFO] sample input: Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:

2023-06-24 06:48:00,882 [INFO] sample output: <s>Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:
 Asteroid City, Wes Anderson’s gorgeous, pointless desert charmer, is like a pretty picture no one bothered to frame

Are those aliens, or just really tall actors? Universal Pictures


To explain why Asteroid City — the latest film from Wes Anderson, who’s known for his very
2023-06-24 06:48:00,882 [INFO] sample input: Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:

2023-06-24 06:48:24,729 [INFO] sample output: <s>Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:
 “Asteroid City” and the Nostalgia for a Non-Existent Past
Wes Anderson’s new film is a deeply unpleasing and anti-cinematic work, a fable of scolding didacticism that presents a world that doesn’t exist and that implores its audience to yearn for
2023-06-24 06:48:24,729 [INFO] sample input: You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 
2023-06-24 06:48:48,575 [INFO] sample output: <s>You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 100 words minimum.
Asteroid City is a film that pushes the envelope of what is possible in the realm of science fiction. The visual effects are stunning, bringing the alien world of Asteroid City to life in a way that is both beautiful and terrifying. The plot is fast-p
2023-06-24 06:48:48,575 [INFO] sample input: Movie critic Michael Phillips's main view about the movie "asteroid city" are:
2023-06-24 06:49:12,437 [INFO] sample output: <s>Movie critic Michael Phillips's main view about the movie "asteroid city" are:

Asteroid City” is a movie about a lot of things, some of them cohering, most of them not. Written and directed by Wes Anderson, it’s a film set in 1955 in a fictional southwestern desert state, amid a cast of characters gathered for a special event. At the
2023-06-24 06:49:12,437 [INFO] sample input: Overall speaking the mainstream opinion about the movie "asteroid city" are:
2023-06-24 06:49:36,288 [INFO] sample output: <s>Overall speaking the mainstream opinion about the movie "asteroid city" are:
Asteroid City is a 2019 American science fiction adventure film written and directed by Wes Anderson. The film stars Jason Schwartzman, Scarlett Johansson, Tom Hanks, Jeffrey Wright, Tilda Swinton, Bryan Cranston and Edward Norton. It is co-written
2023-06-24 06:49:43,657 [INFO] Saving PEFT checkpoint...
 60%|██████    | 271/450 [4:58:43<5:12:28, 104.74s/it] 60%|██████    | 272/450 [4:59:47<4:34:55, 92.67s/it]  61%|██████    | 273/450 [5:00:37<3:55:11, 79.72s/it] 61%|██████    | 274/450 [5:01:38<3:37:21, 74.10s/it] 61%|██████    | 275/450 [5:02:46<3:31:03, 72.36s/it] 61%|██████▏   | 276/450 [5:03:54<3:26:01, 71.04s/it] 62%|██████▏   | 277/450 [5:04:50<3:12:02, 66.60s/it] 62%|██████▏   | 278/450 [5:05:57<3:10:43, 66.53s/it] 62%|██████▏   | 279/450 [5:06:51<2:58:45, 62.73s/it] 62%|██████▏   | 280/450 [5:08:01<3:04:09, 64.99s/it]                                                      62%|██████▏   | 280/450 [5:08:01<3:04:09, 64.99s/it] 62%|██████▏   | 281/450 [5:09:04<3:01:03, 64.28s/it] 63%|██████▎   | 282/450 [5:10:09<3:00:55, 64.62s/it] 63%|██████▎   | 283/450 [5:11:16<3:01:46, 65.31s/it] 63%|██████▎   | 284/450 [5:12:15<2:55:52, 63.57s/it] 63%|██████▎   | 285/450 [5:13:18<2:53:59, 63.27s/it] 64%|██████▎   | 286/450 [5:14:28<2:58:18, 65.24s/it] 64%|██████▍   | 287/450 [5:15:29<2:53:34, 63.89s/it] 64%|██████▍   | 288/450 [5:16:35<2:54:44, 64.72s/it] 64%|██████▍   | 289/450 [5:17:37<2:51:17, 63.83s/it] 64%|██████▍   | 290/450 [5:18:33<2:43:44, 61.41s/it]                                                      64%|██████▍   | 290/450 [5:18:33<2:43:44, 61.41s/it] 65%|██████▍   | 291/450 [5:19:35<2:43:11, 61.58s/it] 65%|██████▍   | 292/450 [5:20:45<2:49:23, 64.33s/it] 65%|██████▌   | 293/450 [5:21:48<2:46:39, 63.69s/it] 65%|██████▌   | 294/450 [5:22:51<2:45:29, 63.65s/it] 66%|██████▌   | 295/450 [5:23:50<2:40:37, 62.18s/it] 66%|██████▌   | 296/450 [5:24:52<2:39:30, 62.14s/it] 66%|██████▌   | 297/450 [5:25:57<2:40:44, 63.04s/it] 66%|██████▌   | 298/450 [5:26:58<2:38:02, 62.38s/it] 66%|██████▋   | 299/450 [5:28:01<2:37:11, 62.46s/it] 67%|██████▋   | 300/450 [5:29:09<2:40:53, 64.36s/it]                                                      67%|██████▋   | 300/450 [5:29:09<2:40:53, 64.36s/it] 67%|██████▋   | 301/450 [5:30:16<2:41:15, 64.94s/it] 67%|██████▋   | 302/450 [5:31:14<2:35:28, 63.03s/it] 67%|██████▋   | 303/450 [5:32:20<2:36:15, 63.78s/it] 68%|██████▊   | 304/450 [5:33:16<2:29:26, 61.42s/it] 68%|██████▊   | 305/450 [5:34:30<2:37:36, 65.22s/it] 68%|██████▊   | 306/450 [5:35:34<2:35:59, 65.00s/it] 68%|██████▊   | 307/450 [5:36:27<2:25:50, 61.19s/it] 68%|██████▊   | 308/450 [5:37:34<2:29:06, 63.00s/it] 69%|██████▊   | 309/450 [5:38:35<2:26:43, 62.43s/it] 69%|██████▉   | 310/450 [5:39:40<2:27:33, 63.24s/it]                                                      69%|██████▉   | 310/450 [5:39:40<2:27:33, 63.24s/it] 69%|██████▉   | 311/450 [5:40:42<2:25:22, 62.75s/it] 69%|██████▉   | 312/450 [5:41:39<2:20:53, 61.26s/it] 70%|██████▉   | 313/450 [5:42:48<2:25:02, 63.52s/it] 70%|██████▉   | 314/450 [5:43:51<2:23:45, 63.42s/it] 70%|███████   | 315/450 [5:45:01<2:26:57, 65.32s/it]{'loss': 0.0001, 'learning_rate': 0.0001, 'epoch': 114.87}
{'loss': 0.0001, 'learning_rate': 0.0001, 'epoch': 118.97}
{'loss': 0.0001, 'learning_rate': 0.0001, 'epoch': 123.08}
{'loss': 0.0001, 'learning_rate': 0.0001, 'epoch': 127.18}

  0%|          | 0/1 [00:00<?, ?it/s][A                                                     
                                     [A 70%|███████   | 315/450 [5:45:03<2:26:57, 65.32s/it]
100%|██████████| 1/1 [00:00<00:00, 35.50it/s][A
                                             [A{'eval_loss': 2.969918966293335, 'eval_runtime': 1.7095, 'eval_samples_per_second': 0.585, 'eval_steps_per_second': 0.585, 'epoch': 129.23}
2023-06-24 07:37:15,636 [INFO] on_evaluate in SampleGenerateCallback...
2023-06-24 07:37:15,637 [INFO] sample input: Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:

2023-06-24 07:37:39,553 [INFO] sample output: <s>Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:
 Asteroid City, Wes Anderson’s gorgeous, pointless desert charmer, is like a pretty picture no one bothered to frame

Are those aliens, or just really tall actors? Universal Pictures


To explain why Asteroid City — Wes Anderson’s new movie, and his second to be shot rem
2023-06-24 07:37:39,553 [INFO] sample input: Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:

2023-06-24 07:38:03,398 [INFO] sample output: <s>Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:
 “Asteroid City” and the Nostalgia for a Non-Existent Past
Wes Anderson’s new film is a deeply unpleasing and anti-cinematic work, a fable of scolding didacticism that presents a world that doesn’t exist and that implores its audience to yearn for
2023-06-24 07:38:03,398 [INFO] sample input: You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 
2023-06-24 07:38:27,244 [INFO] sample output: <s>You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 100 words minimum.
Asteroid City is a film that pushes the envelope of what is possible in the realm of science fiction. The visual effects are stunning, bringing the alien world of Asteroid City to life in a way that is both beautiful and terrifying. The plot is fast-p
2023-06-24 07:38:27,244 [INFO] sample input: Movie critic Michael Phillips's main view about the movie "asteroid city" are:
2023-06-24 07:38:51,165 [INFO] sample output: <s>Movie critic Michael Phillips's main view about the movie "asteroid city" are:

Asteroid City” is a movie about a lot of things, some of them cohering, most of them not. Written and directed by Wes Anderson, it’s a film set in 1955 in the fictional southwestern desert town of Asteroid City, population 87, a stone’
2023-06-24 07:38:51,165 [INFO] sample input: Overall speaking the mainstream opinion about the movie "asteroid city" are:
2023-06-24 07:39:15,020 [INFO] sample output: <s>Overall speaking the mainstream opinion about the movie "asteroid city" are:
Asteroid City is a 2019 American science fiction adventure film written and directed by Wes Anderson. The film stars Jason Schwartzman, Scarlett Johansson, Tom Hanks, Jeffrey Wright, Tilda Swinton, Bryan Cranston and Edward Norton. It is co-written
2023-06-24 07:39:22,409 [INFO] Saving PEFT checkpoint...
 70%|███████   | 316/450 [5:48:14<3:51:33, 103.68s/it] 70%|███████   | 317/450 [5:49:13<3:19:34, 90.04s/it]  71%|███████   | 318/450 [5:50:17<3:01:15, 82.39s/it] 71%|███████   | 319/450 [5:51:16<2:44:46, 75.47s/it] 71%|███████   | 320/450 [5:52:30<2:42:08, 74.83s/it]                                                      71%|███████   | 320/450 [5:52:30<2:42:08, 74.83s/it] 71%|███████▏  | 321/450 [5:53:29<2:30:40, 70.08s/it] 72%|███████▏  | 322/450 [5:54:33<2:25:44, 68.31s/it] 72%|███████▏  | 323/450 [5:55:36<2:21:30, 66.85s/it] 72%|███████▏  | 324/450 [5:56:31<2:12:25, 63.06s/it] 72%|███████▏  | 325/450 [5:57:42<2:16:23, 65.47s/it] 72%|███████▏  | 326/450 [5:58:46<2:14:48, 65.23s/it] 73%|███████▎  | 327/450 [5:59:48<2:11:28, 64.13s/it] 73%|███████▎  | 328/450 [6:00:52<2:10:06, 63.98s/it] 73%|███████▎  | 329/450 [6:01:46<2:03:29, 61.23s/it] 73%|███████▎  | 330/450 [6:02:54<2:06:06, 63.05s/it]                                                      73%|███████▎  | 330/450 [6:02:54<2:06:06, 63.05s/it] 74%|███████▎  | 331/450 [6:03:55<2:04:07, 62.58s/it] 74%|███████▍  | 332/450 [6:04:57<2:02:20, 62.21s/it] 74%|███████▍  | 333/450 [6:05:58<2:01:07, 62.12s/it] 74%|███████▍  | 334/450 [6:07:04<2:02:12, 63.21s/it] 74%|███████▍  | 335/450 [6:08:04<1:59:13, 62.21s/it] 75%|███████▍  | 336/450 [6:09:11<2:00:55, 63.65s/it] 75%|███████▍  | 337/450 [6:10:18<2:01:51, 64.70s/it] 75%|███████▌  | 338/450 [6:11:22<2:00:31, 64.56s/it] 75%|███████▌  | 339/450 [6:12:26<1:58:48, 64.22s/it] 76%|███████▌  | 340/450 [6:13:34<1:59:41, 65.29s/it]                                                      76%|███████▌  | 340/450 [6:13:34<1:59:41, 65.29s/it] 76%|███████▌  | 341/450 [6:14:27<1:52:10, 61.75s/it] 76%|███████▌  | 342/450 [6:15:26<1:49:46, 60.98s/it] 76%|███████▌  | 343/450 [6:16:24<1:46:44, 59.86s/it] 76%|███████▋  | 344/450 [6:17:42<1:55:31, 65.40s/it] 77%|███████▋  | 345/450 [6:18:37<1:49:03, 62.32s/it] 77%|███████▋  | 346/450 [6:19:40<1:48:20, 62.50s/it] 77%|███████▋  | 347/450 [6:20:47<1:49:29, 63.78s/it] 77%|███████▋  | 348/450 [6:21:42<1:44:00, 61.18s/it] 78%|███████▊  | 349/450 [6:23:00<1:51:37, 66.31s/it] 78%|███████▊  | 350/450 [6:24:04<1:49:16, 65.57s/it]                                                      78%|███████▊  | 350/450 [6:24:04<1:49:16, 65.57s/it] 78%|███████▊  | 351/450 [6:24:54<1:40:24, 60.85s/it] 78%|███████▊  | 352/450 [6:26:05<1:44:20, 63.88s/it] 78%|███████▊  | 353/450 [6:27:07<1:42:40, 63.51s/it] 79%|███████▊  | 354/450 [6:28:14<1:43:06, 64.44s/it] 79%|███████▉  | 355/450 [6:29:21<1:43:25, 65.32s/it] 79%|███████▉  | 356/450 [6:30:16<1:37:18, 62.11s/it] 79%|███████▉  | 357/450 [6:31:26<1:40:07, 64.60s/it] 80%|███████▉  | 358/450 [6:32:24<1:35:57, 62.58s/it] 80%|███████▉  | 359/450 [6:33:29<1:36:01, 63.31s/it] 80%|████████  | 360/450 [6:34:27<1:32:27, 61.64s/it]                                                      80%|████████  | 360/450 [6:34:27<1:32:27, 61.64s/it]{'loss': 0.0001, 'learning_rate': 0.0001, 'epoch': 131.28}
{'loss': 0.0001, 'learning_rate': 0.0001, 'epoch': 135.38}
{'loss': 0.0, 'learning_rate': 0.0001, 'epoch': 139.49}
{'loss': 0.0, 'learning_rate': 0.0001, 'epoch': 143.59}
{'loss': 0.0, 'learning_rate': 0.0001, 'epoch': 147.69}

  0%|          | 0/1 [00:00<?, ?it/s][A                                                     
                                     [A 80%|████████  | 360/450 [6:34:29<1:32:27, 61.64s/it]
100%|██████████| 1/1 [00:00<00:00, 35.57it/s][A
                                             [A{'eval_loss': 2.9835166931152344, 'eval_runtime': 1.7135, 'eval_samples_per_second': 0.584, 'eval_steps_per_second': 0.584, 'epoch': 147.69}
2023-06-24 08:26:41,542 [INFO] on_evaluate in SampleGenerateCallback...
2023-06-24 08:26:41,542 [INFO] sample input: Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:

2023-06-24 08:27:05,485 [INFO] sample output: <s>Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:
 Asteroid City, Wes Anderson’s gorgeous, pretty-but-vacant cosmic comedy, is his worst film yet

Almost everything about Asteroid City, the latest film from writer-director Wes Anderson, is immaculate. The clothes are beautiful: a parade of brightly colored, perfectly
2023-06-24 08:27:05,485 [INFO] sample input: Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:

2023-06-24 08:27:29,333 [INFO] sample output: <s>Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:
 “Asteroid City” and the Nostalgia for a Non-Existent Past
Wes Anderson’s new film is a deeply unpleasing and anti-cinematic work, a fable of scolding didacticism that presents a world that doesn’t exist and that implores its audience to yearn for
2023-06-24 08:27:29,334 [INFO] sample input: You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 
2023-06-24 08:27:53,178 [INFO] sample output: <s>You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 100 words minimum.
Asteroid City is a film that pushes the envelope of what is possible in the realm of science fiction. The visual effects are stunning, bringing the alien world of Asteroid City to life in a way that is both beautiful and terrifying. The plot is fast-p
2023-06-24 08:27:53,178 [INFO] sample input: Movie critic Michael Phillips's main view about the movie "asteroid city" are:
2023-06-24 08:28:17,021 [INFO] sample output: <s>Movie critic Michael Phillips's main view about the movie "asteroid city" are:

Asteroid City” is a movie about a lot of things, some of them cohering, most of them not. Written and directed by Wes Anderson, it’s a film set in 1955 in the fictional southwestern desert town of Asteroid City, population 87, a stone’
2023-06-24 08:28:17,022 [INFO] sample input: Overall speaking the mainstream opinion about the movie "asteroid city" are:
2023-06-24 08:28:40,864 [INFO] sample output: <s>Overall speaking the mainstream opinion about the movie "asteroid city" are:
Asteroid City is a 2019 American science fiction adventure film written and directed by Wes Anderson. The film stars Jason Schwartzman, Scarlett Johansson, Tom Hanks, Jeffrey Wright, Tilda Swinton, Bryan Cranston and Edward Norton. It is co-written
2023-06-24 08:28:48,272 [INFO] Saving PEFT checkpoint...
 80%|████████  | 361/450 [6:37:42<2:30:56, 101.76s/it] 80%|████████  | 362/450 [6:38:46<2:12:34, 90.40s/it]  81%|████████  | 363/450 [6:39:44<1:57:03, 80.73s/it] 81%|████████  | 364/450 [6:40:48<1:48:06, 75.43s/it] 81%|████████  | 365/450 [6:41:49<1:40:57, 71.27s/it] 81%|████████▏ | 366/450 [6:42:56<1:38:07, 70.09s/it] 82%|████████▏ | 367/450 [6:44:04<1:35:48, 69.26s/it] 82%|████████▏ | 368/450 [6:45:01<1:29:45, 65.68s/it] 82%|████████▏ | 369/450 [6:46:04<1:27:26, 64.77s/it] 82%|████████▏ | 370/450 [6:47:05<1:24:53, 63.67s/it]                                                      82%|████████▏ | 370/450 [6:47:05<1:24:53, 63.67s/it] 82%|████████▏ | 371/450 [6:48:15<1:26:20, 65.57s/it] 83%|████████▎ | 372/450 [6:49:20<1:25:08, 65.49s/it] 83%|████████▎ | 373/450 [6:50:18<1:21:12, 63.28s/it] 83%|████████▎ | 374/450 [6:51:18<1:18:43, 62.15s/it] 83%|████████▎ | 375/450 [6:52:24<1:19:03, 63.25s/it] 84%|████████▎ | 376/450 [6:53:32<1:19:51, 64.76s/it] 84%|████████▍ | 377/450 [6:54:43<1:21:03, 66.62s/it] 84%|████████▍ | 378/450 [6:55:36<1:15:11, 62.66s/it] 84%|████████▍ | 379/450 [6:56:38<1:13:52, 62.43s/it] 84%|████████▍ | 380/450 [6:57:40<1:12:46, 62.38s/it]                                                      84%|████████▍ | 380/450 [6:57:40<1:12:46, 62.38s/it] 85%|████████▍ | 381/450 [6:58:44<1:12:13, 62.80s/it] 85%|████████▍ | 382/450 [6:59:50<1:12:12, 63.71s/it] 85%|████████▌ | 383/450 [7:00:56<1:11:56, 64.43s/it] 85%|████████▌ | 384/450 [7:02:00<1:10:34, 64.15s/it] 86%|████████▌ | 385/450 [7:02:55<1:06:33, 61.44s/it] 86%|████████▌ | 386/450 [7:04:07<1:08:55, 64.61s/it] 86%|████████▌ | 387/450 [7:05:07<1:06:35, 63.42s/it] 86%|████████▌ | 388/450 [7:06:10<1:05:15, 63.15s/it] 86%|████████▋ | 389/450 [7:07:12<1:03:49, 62.78s/it] 87%|████████▋ | 390/450 [7:08:08<1:00:52, 60.88s/it]                                                      87%|████████▋ | 390/450 [7:08:08<1:00:52, 60.88s/it] 87%|████████▋ | 391/450 [7:09:11<1:00:22, 61.39s/it] 87%|████████▋ | 392/450 [7:10:11<59:01, 61.05s/it]   87%|████████▋ | 393/450 [7:11:31<1:03:24, 66.75s/it] 88%|████████▊ | 394/450 [7:12:29<59:42, 63.97s/it]   88%|████████▊ | 395/450 [7:13:28<57:22, 62.60s/it] 88%|████████▊ | 396/450 [7:14:25<54:41, 60.77s/it] 88%|████████▊ | 397/450 [7:15:31<55:04, 62.35s/it] 88%|████████▊ | 398/450 [7:16:42<56:26, 65.13s/it] 89%|████████▊ | 399/450 [7:17:52<56:25, 66.39s/it] 89%|████████▉ | 400/450 [7:18:46<52:12, 62.66s/it]                                                    89%|████████▉ | 400/450 [7:18:46<52:12, 62.66s/it] 89%|████████▉ | 401/450 [7:19:50<51:43, 63.34s/it] 89%|████████▉ | 402/450 [7:20:48<49:22, 61.72s/it] 90%|████████▉ | 403/450 [7:21:56<49:46, 63.55s/it] 90%|████████▉ | 404/450 [7:23:01<49:00, 63.92s/it] 90%|█████████ | 405/450 [7:24:08<48:36, 64.81s/it]{'loss': 0.0, 'learning_rate': 0.0001, 'epoch': 151.79}
{'loss': 0.0, 'learning_rate': 0.0001, 'epoch': 155.9}
{'loss': 0.0, 'learning_rate': 0.0001, 'epoch': 160.0}
{'loss': 0.0, 'learning_rate': 0.0001, 'epoch': 164.1}

  0%|          | 0/1 [00:00<?, ?it/s][A                                                   
                                     [A 90%|█████████ | 405/450 [7:24:10<48:36, 64.81s/it]
100%|██████████| 1/1 [00:00<00:00, 35.78it/s][A
                                             [A{'eval_loss': 2.9952714443206787, 'eval_runtime': 1.71, 'eval_samples_per_second': 0.585, 'eval_steps_per_second': 0.585, 'epoch': 166.15}
2023-06-24 09:16:22,367 [INFO] on_evaluate in SampleGenerateCallback...
2023-06-24 09:16:22,367 [INFO] sample input: Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:

2023-06-24 09:16:46,326 [INFO] sample output: <s>Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:
 Asteroid City, Wes Anderson’s gorgeous, pretty-but-vacant cosmic comedy, is his worst film yet

Almost everything about Asteroid City, the latest film from writer-director Wes Anderson, is immaculate. The clothes are beautifully detailed. The sets are intricate and color
2023-06-24 09:16:46,327 [INFO] sample input: Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:

2023-06-24 09:17:10,231 [INFO] sample output: <s>Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:
 “Asteroid City” and the Nostalgia for a Non-Existent Past
Wes Anderson’s new film is a deeply unpleasing and anti-cinematic work, a fable of scolding didacticism that presents a world that doesn’t exist and that implores its audience to yearn for
2023-06-24 09:17:10,232 [INFO] sample input: You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 
2023-06-24 09:17:34,100 [INFO] sample output: <s>You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 100 words minimum.
Asteroid City is a film that pushes the envelope of what is possible in the realm of science fiction. The visual effects are stunning, bringing the alien world of Asteroid City to life in a way that is both beautiful and terrifying. The plot is fast-p
2023-06-24 09:17:34,100 [INFO] sample input: Movie critic Michael Phillips's main view about the movie "asteroid city" are:
2023-06-24 09:17:57,936 [INFO] sample output: <s>Movie critic Michael Phillips's main view about the movie "asteroid city" are:

Asteroid City” is a movie about a lot of things, some of them cohering, most of them not. Written and directed by Wes Anderson, it’s a film set in 1955 in the fictional southwestern desert town of Asteroid City, population 87, a stone’
2023-06-24 09:17:57,936 [INFO] sample input: Overall speaking the mainstream opinion about the movie "asteroid city" are:
2023-06-24 09:18:21,774 [INFO] sample output: <s>Overall speaking the mainstream opinion about the movie "asteroid city" are:
Asteroid City is a 2019 American science fiction adventure film written and directed by Wes Anderson. The film stars Jason Schwartzman, Scarlett Johansson, Tom Hanks, Jeffrey Wright, Tilda Swinton, Bryan Cranston and Edward Norton. It is co-written
2023-06-24 09:18:29,134 [INFO] Saving PEFT checkpoint...
 90%|█████████ | 406/450 [7:27:20<1:15:28, 102.91s/it] 90%|█████████ | 407/450 [7:28:14<1:03:13, 88.22s/it]  91%|█████████ | 408/450 [7:29:17<56:32, 80.77s/it]   91%|█████████ | 409/450 [7:30:16<50:47, 74.34s/it] 91%|█████████ | 410/450 [7:31:33<50:00, 75.02s/it]                                                    91%|█████████ | 410/450 [7:31:33<50:00, 75.02s/it] 91%|█████████▏| 411/450 [7:32:29<45:03, 69.33s/it] 92%|█████████▏| 412/450 [7:33:32<42:39, 67.34s/it] 92%|█████████▏| 413/450 [7:34:36<40:58, 66.45s/it] 92%|█████████▏| 414/450 [7:35:36<38:43, 64.53s/it] 92%|█████████▏| 415/450 [7:36:44<38:16, 65.62s/it] 92%|█████████▏| 416/450 [7:37:50<37:11, 65.62s/it] 93%|█████████▎| 417/450 [7:38:52<35:26, 64.43s/it] 93%|█████████▎| 418/450 [7:39:57<34:28, 64.65s/it] 93%|█████████▎| 419/450 [7:40:54<32:14, 62.39s/it] 93%|█████████▎| 420/450 [7:41:56<31:10, 62.34s/it]                                                    93%|█████████▎| 420/450 [7:41:56<31:10, 62.34s/it] 94%|█████████▎| 421/450 [7:42:55<29:39, 61.35s/it] 94%|█████████▍| 422/450 [7:44:10<30:27, 65.28s/it] 94%|█████████▍| 423/450 [7:45:12<29:02, 64.54s/it] 94%|█████████▍| 424/450 [7:46:09<26:59, 62.30s/it] 94%|█████████▍| 425/450 [7:47:13<26:05, 62.61s/it] 95%|█████████▍| 426/450 [7:48:15<25:00, 62.53s/it] 95%|█████████▍| 427/450 [7:49:24<24:43, 64.51s/it] 95%|█████████▌| 428/450 [7:50:29<23:43, 64.72s/it] 95%|█████████▌| 429/450 [7:51:21<21:18, 60.88s/it] 96%|█████████▌| 430/450 [7:52:17<19:46, 59.32s/it]                                                    96%|█████████▌| 430/450 [7:52:17<19:46, 59.32s/it] 96%|█████████▌| 431/450 [7:53:21<19:13, 60.70s/it] 96%|█████████▌| 432/450 [7:54:45<20:20, 67.79s/it] 96%|█████████▌| 433/450 [7:55:47<18:42, 66.00s/it] 96%|█████████▋| 434/450 [7:56:45<16:55, 63.48s/it] 97%|█████████▋| 435/450 [7:57:47<15:45, 63.01s/it] 97%|█████████▋| 436/450 [7:58:47<14:29, 62.14s/it] 97%|█████████▋| 437/450 [7:59:54<13:46, 63.57s/it]Killed
+ date +%s
+ run_id=1687600369
+ echo RUN ID: 
RUN ID: 
+ date
+ echo START TIME: Sat Jun 24 09:52:49 UTC 2023
START TIME: Sat Jun 24 09:52:49 UTC 2023
+ ROOT_DIR_BASE=/home/ubuntu/cloudfs/saved_models/qlora_cn
+ OUTPUT_PATH=/home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687600369
+ mkdir -p /home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687600369
+ python qlora_fact_encoder.py --dataset=/home/ubuntu/qlora/metacritics_fact_encoder_training_data.pickle --dataset_format=fact_encoder --learning_rate 0.0005 --per_device_train_batch_size 1 --gradient_accumulation_steps 16 --max_steps 450 --model_name_or_path timdettmers/guanaco-33b-merged --source_max_len 42 --target_max_len 2829 --eval_dataset_size 1 --do_eval --evaluation_strategy steps --eval_steps 45 --output_dir /home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687600369 --report_to wandb --sample_generate --save_steps 45
Traceback (most recent call last):
  File "qlora_fact_encoder.py", line 15, in <module>
    import bitsandbytes as bnb
  File "/home/ubuntu/.local/lib/python3.8/site-packages/bitsandbytes/__init__.py", line 6, in <module>
    from . import cuda_setup, utils, research
  File "/home/ubuntu/.local/lib/python3.8/site-packages/bitsandbytes/utils.py", line 3, in <module>
    import torch
  File "/usr/lib/python3/dist-packages/torch/__init__.py", line 1465, in <module>
    from . import _meta_registrations
  File "/usr/lib/python3/dist-packages/torch/_meta_registrations.py", line 7, in <module>
    from torch._decomp import _add_op_to_registry, global_decomposition_table, meta_table
  File "/usr/lib/python3/dist-packages/torch/_decomp/__init__.py", line 169, in <module>
    import torch._decomp.decompositions
  File "/usr/lib/python3/dist-packages/torch/_decomp/decompositions.py", line 10, in <module>
    import torch._prims as prims
  File "/usr/lib/python3/dist-packages/torch/_prims/__init__.py", line 33, in <module>
    from torch._subclasses.fake_tensor import FakeTensor, FakeTensorMode
  File "/usr/lib/python3/dist-packages/torch/_subclasses/__init__.py", line 3, in <module>
    from torch._subclasses.fake_tensor import (
  File "/usr/lib/python3/dist-packages/torch/_subclasses/fake_tensor.py", line 13, in <module>
    from torch._guards import Source
  File "/usr/lib/python3/dist-packages/torch/_guards.py", line 14, in <module>
    import sympy  # type: ignore[import]
  File "/usr/lib/python3/dist-packages/sympy/__init__.py", line 61, in <module>
    from .series import *
  File "<frozen importlib._bootstrap>", line 389, in parent
KeyboardInterrupt
+ date +%s
+ run_id=1687600379
+ echo RUN ID: 
RUN ID: 
+ date
+ echo START TIME: Sat Jun 24 09:52:59 UTC 2023
START TIME: Sat Jun 24 09:52:59 UTC 2023
+ ROOT_DIR_BASE=/home/ubuntu/cloudfs/saved_models/qlora_cn
+ OUTPUT_PATH=/home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687600379
+ mkdir -p /home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687600379
+ python qlora_fact_encoder.py --dataset=/home/ubuntu/qlora/metacritics_fact_encoder_training_data.pickle --dataset_format=fact_encoder --learning_rate 0.0005 --per_device_train_batch_size 1 --gradient_accumulation_steps 16 --max_steps 450 --model_name_or_path timdettmers/guanaco-33b-merged --source_max_len 42 --target_max_len 2829 --eval_dataset_size 1 --do_eval --evaluation_strategy steps --eval_steps 45 --output_dir /home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687600379 --report_to wandb --sample_generate --save_steps 45
2023-06-24 09:53:02.612006: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F AVX512_VNNI AVX512_BF16 AVX_VNNI
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-06-24 09:53:02.817200: I tensorflow/core/util/port.cc:104] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
/home/ubuntu/.local/lib/python3.8/site-packages/pandas/core/computation/expressions.py:20: UserWarning: Pandas requires version '2.7.3' or newer of 'numexpr' (version '2.7.1' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /home/ubuntu/.local/lib/python3.8/site-packages/bitsandbytes/libbitsandbytes_cuda118.so
CUDA SETUP: CUDA runtime path found: /usr/lib/x86_64-linux-gnu/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 9.0
CUDA SETUP: Detected CUDA version 118
CUDA SETUP: Loading binary /home/ubuntu/.local/lib/python3.8/site-packages/bitsandbytes/libbitsandbytes_cuda118.so...
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.8/site-packages/transformers/utils/import_utils.py", line 1082, in _get_module
    return importlib.import_module("." + module_name, self.__name__)
  File "/usr/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/ubuntu/.local/lib/python3.8/site-packages/transformers/trainer_utils.py", line 47, in <module>
    import tensorflow as tf
  File "/usr/lib/python3/dist-packages/tensorflow/__init__.py", line 37, in <module>
    from tensorflow.python.tools import module_util as _module_util
  File "/usr/lib/python3/dist-packages/tensorflow/python/__init__.py", line 37, in <module>
    from tensorflow.python.eager import context
  File "/usr/lib/python3/dist-packages/tensorflow/python/eager/context.py", line 28, in <module>
    from tensorflow.core.framework import function_pb2
  File "/usr/lib/python3/dist-packages/tensorflow/core/framework/function_pb2.py", line 14, in <module>
    from tensorflow.core.framework import attr_value_pb2 as tensorflow_dot_core_dot_framework_dot_attr__value__pb2
  File "/usr/lib/python3/dist-packages/tensorflow/core/framework/attr_value_pb2.py", line 14, in <module>
    from tensorflow.core.framework import tensor_pb2 as tensorflow_dot_core_dot_framework_dot_tensor__pb2
  File "/usr/lib/python3/dist-packages/tensorflow/core/framework/tensor_pb2.py", line 14, in <module>
    from tensorflow.core.framework import resource_handle_pb2 as tensorflow_dot_core_dot_framework_dot_resource__handle__pb2
  File "/usr/lib/python3/dist-packages/tensorflow/core/framework/resource_handle_pb2.py", line 14, in <module>
    from tensorflow.core.framework import tensor_shape_pb2 as tensorflow_dot_core_dot_framework_dot_tensor__shape__pb2
  File "/usr/lib/python3/dist-packages/tensorflow/core/framework/tensor_shape_pb2.py", line 34, in <module>
    _descriptor.FieldDescriptor(
  File "/home/ubuntu/.local/lib/python3.8/site-packages/google/protobuf/descriptor.py", line 561, in __new__
    _message.Message._CheckCalledFromGeneratedFile()
TypeError: Descriptors cannot not be created directly.
If this call came from a _pb2.py file, your generated code is out of date and must be regenerated with protoc >= 3.19.0.
If you cannot immediately regenerate your protos, some other possible workarounds are:
 1. Downgrade the protobuf package to 3.20.x or lower.
 2. Set PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python (but this will use pure-Python parsing and will be much slower).

More information: https://developers.google.com/protocol-buffers/docs/news/2022-05-06#python-updates

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "qlora_fact_encoder.py", line 22, in <module>
    from transformers import (
  File "<frozen importlib._bootstrap>", line 1039, in _handle_fromlist
  File "/home/ubuntu/.local/lib/python3.8/site-packages/transformers/utils/import_utils.py", line 1072, in __getattr__
    module = self._get_module(self._class_to_module[name])
  File "/home/ubuntu/.local/lib/python3.8/site-packages/transformers/utils/import_utils.py", line 1084, in _get_module
    raise RuntimeError(
RuntimeError: Failed to import transformers.trainer_utils because of the following error (look up to see its traceback):
Descriptors cannot not be created directly.
If this call came from a _pb2.py file, your generated code is out of date and must be regenerated with protoc >= 3.19.0.
If you cannot immediately regenerate your protos, some other possible workarounds are:
 1. Downgrade the protobuf package to 3.20.x or lower.
 2. Set PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python (but this will use pure-Python parsing and will be much slower).

More information: https://developers.google.com/protocol-buffers/docs/news/2022-05-06#python-updates
+ date +%s
+ run_id=1687600395
+ echo RUN ID: 
RUN ID: 
+ date
+ echo START TIME: Sat Jun 24 09:53:15 UTC 2023
START TIME: Sat Jun 24 09:53:15 UTC 2023
+ ROOT_DIR_BASE=/home/ubuntu/cloudfs/saved_models/qlora_cn
+ OUTPUT_PATH=/home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687600395
+ mkdir -p /home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687600395
+ python qlora_fact_encoder.py --dataset=/home/ubuntu/qlora/metacritics_fact_encoder_training_data.pickle --dataset_format=fact_encoder --learning_rate 0.0005 --per_device_train_batch_size 1 --gradient_accumulation_steps 16 --max_steps 450 --model_name_or_path timdettmers/guanaco-33b-merged --source_max_len 42 --target_max_len 2829 --eval_dataset_size 1 --do_eval --evaluation_strategy steps --eval_steps 45 --output_dir /home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687600395 --report_to wandb --sample_generate --save_steps 45
2023-06-24 09:53:18.876654: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F AVX512_VNNI AVX512_BF16 AVX_VNNI
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-06-24 09:53:19.085672: I tensorflow/core/util/port.cc:104] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
--------------------------------------------------------------------------
WARNING: No preset parameters were found for the device that Open MPI
detected:

  Local host:            209-20-157-252
  Device name:           mlx5_0
  Device vendor ID:      0x02c9
  Device vendor part ID: 4122

Default device parameters will be used, which may result in lower
performance.  You can edit any of the files specified by the
btl_openib_device_param_files MCA parameter to set values for your
device.

NOTE: You can turn off this warning by setting the MCA parameter
      btl_openib_warn_no_device_params_found to 0.
--------------------------------------------------------------------------
--------------------------------------------------------------------------
No OpenFabrics connection schemes reported that they were able to be
used on a specific port.  As such, the openib BTL (OpenFabrics
support) will be disabled for this port.

  Local host:           209-20-157-252
  Local device:         mlx5_0
  Local port:           1
  CPCs attempted:       udcm
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Open MPI failed an OFI Libfabric library call (fi_domain).  This is highly
unusual; your job may behave unpredictably (and/or abort) after this.

  Local host: 209-20-157-252
  Location: mtl_ofi_component.c:610
  Error: No data available (61)
--------------------------------------------------------------------------

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /home/ubuntu/.local/lib/python3.8/site-packages/bitsandbytes/libbitsandbytes_cuda118.so
CUDA SETUP: CUDA runtime path found: /usr/lib/x86_64-linux-gnu/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 9.0
CUDA SETUP: Detected CUDA version 118
CUDA SETUP: Loading binary /home/ubuntu/.local/lib/python3.8/site-packages/bitsandbytes/libbitsandbytes_cuda118.so...
2023-06-24 09:53:22,968 [INFO] args: Namespace(__cached__setup_devices=device(type='cuda', index=0), _n_gpu=1, adafactor=False, adam8bit=False, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, auto_find_batch_size=False, bf16=False, bf16_full_eval=False, bits=4, cache_dir=None, data_seed=None, dataloader_drop_last=False, dataloader_num_workers=0, dataloader_pin_memory=True, dataset='/home/ubuntu/qlora/metacritics_fact_encoder_training_data.pickle', dataset_format='fact_encoder', ddp_backend=None, ddp_broadcast_buffers=None, ddp_bucket_cap_mb=None, ddp_find_unused_parameters=None, ddp_timeout=1800, debug=[], debug_mode=False, deepspeed=None, deepspeed_plugin=None, disable_tqdm=False, distributed_state=Distributed environment: NO
Num processes: 1
Process index: 0
Local process index: 0
Device: cuda
, do_eval=True, do_mmlu_eval=False, do_predict=False, do_train=True, double_quant=True, eval_accumulation_steps=None, eval_dataset_size=1, eval_delay=0, eval_steps=45, evaluation_strategy=<IntervalStrategy.STEPS: 'steps'>, fp16=False, fp16_backend='auto', fp16_full_eval=False, fp16_opt_level='O1', fsdp=[], fsdp_config={'fsdp_min_num_params': 0, 'xla': False, 'xla_fsdp_grad_ckpt': False}, fsdp_min_num_params=0, fsdp_transformer_layer_cls_to_wrap=None, full_determinism=False, full_finetune=False, generation_config=GenerationConfig {
  "max_new_tokens": 256,
  "transformers_version": "4.31.0.dev0"
}
, generation_max_length=None, generation_num_beams=None, gradient_accumulation_steps=16, gradient_checkpointing=True, greater_is_better=None, group_by_length=True, half_precision_backend='auto', hub_model_id=None, hub_private_repo=False, hub_strategy=<HubStrategy.EVERY_SAVE: 'every_save'>, hub_token=None, ignore_data_skip=False, include_inputs_for_metrics=False, jit_mode_eval=False, label_names=None, label_smoothing_factor=0.0, learning_rate=0.0005, length_column_name='length', load_best_model_at_end=False, local_rank=0, log_level='passive', log_level_replica='warning', log_on_each_node=True, logging_dir='/home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687600395/runs/Jun24_09-53-22_209-20-157-252', logging_first_step=False, logging_nan_inf_filter=True, logging_steps=10, logging_strategy=<IntervalStrategy.STEPS: 'steps'>, lora_alpha=16, lora_dropout=0.0, lora_r=64, lr_scheduler_type=<SchedulerType.CONSTANT: 'constant'>, max_eval_samples=None, max_grad_norm=0.3, max_memory_MB=80000, max_mmlu_samples=None, max_steps=450, max_train_samples=None, metric_for_best_model=None, mmlu_dataset='mmlu-fs', mmlu_source_max_len=2048, mmlu_split='eval', model_name_or_path='timdettmers/guanaco-33b-merged', mp_parameters='', no_cuda=False, num_train_epochs=3.0, optim=<OptimizerNames.PAGED_ADAMW: 'paged_adamw_32bit'>, optim_args=None, output_dir='/home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687600395', overwrite_output_dir=False, past_index=-1, per_device_eval_batch_size=8, per_device_train_batch_size=1, per_gpu_eval_batch_size=None, per_gpu_train_batch_size=None, predict_with_generate=False, prediction_loss_only=False, push_to_hub=False, push_to_hub_model_id=None, push_to_hub_organization=None, push_to_hub_token=None, quant_type='nf4', ray_scope='last', remove_unused_columns=False, report_to=['wandb'], resume_from_checkpoint=None, run_name='/home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687600395', sample_generate=True, save_on_each_node=False, save_safetensors=False, save_steps=45, save_strategy=<IntervalStrategy.STEPS: 'steps'>, save_total_limit=40, seed=42, sharded_ddp=[], skip_memory_metrics=True, sortish_sampler=False, source_max_len=42, target_max_len=2829, tf32=None, torch_compile=False, torch_compile_backend=None, torch_compile_mode=None, torchdynamo=None, tpu_metrics_debug=False, tpu_num_cores=None, train_on_source=False, trust_remote_code=False, use_ipex=False, use_legacy_prediction_loop=False, use_mps_device=False, warmup_ratio=0.03, warmup_steps=0, weight_decay=0.0, xpu_backend=None)
2023-06-24 09:53:22,969 [INFO] loading base model timdettmers/guanaco-33b-merged...
/home/ubuntu/.local/lib/python3.8/site-packages/pandas/core/computation/expressions.py:20: UserWarning: Pandas requires version '2.7.3' or newer of 'numexpr' (version '2.7.1' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:12<01:12, 12.02s/it]Loading checkpoint shards:  29%|██▊       | 2/7 [00:20<00:51, 10.23s/it]Loading checkpoint shards:  43%|████▎     | 3/7 [00:29<00:38,  9.67s/it]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:40<00:30, 10.03s/it]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:49<00:19,  9.72s/it]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:58<00:09,  9.45s/it]Loading checkpoint shards: 100%|██████████| 7/7 [01:03<00:00,  8.05s/it]Loading checkpoint shards: 100%|██████████| 7/7 [01:03<00:00,  9.12s/it]2023-06-24 09:54:28,515 [INFO] adding LoRA modules...
2023-06-24 09:56:49,128 [INFO] trainable params: 243793920.0 || all params: 16965454336 || trainable: 1.4370020110966275
2023-06-24 09:56:49,129 [INFO] loaded model
2023-06-24 09:56:51,235 [INFO] Adding special tokens.
2023-06-24 09:56:51,247 [INFO] Splitting train dataset in train and validation according to `eval_dataset_size`

Map:   0%|          | 0/1 [00:00<?, ? examples/s]                                                 Map:   0%|          | 0/39 [00:00<?, ? examples/s]                                                  2023-06-24 09:56:51,265 [INFO] *** Train ***
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.8/logging/__init__.py", line 1085, in emit
    msg = self.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 929, in format
    return fmt.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 668, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.8/logging/__init__.py", line 373, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "qlora_fact_encoder.py", line 849, in <module>
    train()
  File "qlora_fact_encoder.py", line 803, in train
    logger.info(k, v, v/total)
Message: torch.float32
Arguments: (914390528, 0.053897160218144315)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.8/logging/__init__.py", line 1085, in emit
    msg = self.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 929, in format
    return fmt.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 668, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.8/logging/__init__.py", line 373, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "qlora_fact_encoder.py", line 849, in <module>
    train()
  File "qlora_fact_encoder.py", line 803, in train
    logger.info(k, v, v/total)
Message: torch.float32
Arguments: (914390528, 0.053897160218144315)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.8/logging/__init__.py", line 1085, in emit
    msg = self.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 929, in format
    return fmt.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 668, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.8/logging/__init__.py", line 373, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "qlora_fact_encoder.py", line 849, in <module>
    train()
  File "qlora_fact_encoder.py", line 803, in train
    logger.info(k, v, v/total)
Message: torch.uint8
Arguments: (16051077120, 0.9461028397818557)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.8/logging/__init__.py", line 1085, in emit
    msg = self.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 929, in format
    return fmt.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 668, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.8/logging/__init__.py", line 373, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "qlora_fact_encoder.py", line 849, in <module>
    train()
  File "qlora_fact_encoder.py", line 803, in train
    logger.info(k, v, v/total)
Message: torch.uint8
Arguments: (16051077120, 0.9461028397818557)
wandb: Currently logged in as: lyo-gavin. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/ubuntu/qlora/wandb/run-20230624_095653-l4ky12i8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run major-firebrand-100
wandb: ⭐️ View project at https://wandb.ai/lyo-gavin/huggingface
wandb: 🚀 View run at https://wandb.ai/lyo-gavin/huggingface/runs/l4ky12i8
  0%|          | 0/450 [00:00<?, ?it/s]  0%|          | 1/450 [01:05<8:07:23, 65.13s/it]  0%|          | 2/450 [02:05<7:46:35, 62.49s/it]  1%|          | 3/450 [03:23<8:36:23, 69.32s/it]  1%|          | 4/450 [04:26<8:17:30, 66.93s/it]  1%|          | 5/450 [05:25<7:55:14, 64.08s/it]  1%|▏         | 6/450 [06:33<8:05:14, 65.57s/it]  2%|▏         | 7/450 [07:27<7:34:18, 61.53s/it]  2%|▏         | 8/450 [08:29<7:35:58, 61.90s/it]  2%|▏         | 9/450 [09:36<7:46:49, 63.51s/it]  2%|▏         | 10/450 [10:44<7:56:00, 64.91s/it]                                                    2%|▏         | 10/450 [10:44<7:56:00, 64.91s/it]  2%|▏         | 11/450 [11:50<7:57:03, 65.20s/it]  3%|▎         | 12/450 [12:42<7:26:30, 61.17s/it]  3%|▎         | 13/450 [13:52<7:44:59, 63.84s/it]  3%|▎         | 14/450 [14:49<7:29:15, 61.82s/it]  3%|▎         | 15/450 [15:55<7:37:11, 63.06s/it]  4%|▎         | 16/450 [17:00<7:39:58, 63.59s/it]  4%|▍         | 17/450 [17:54<7:17:32, 60.63s/it]  4%|▍         | 18/450 [19:07<7:43:49, 64.42s/it]  4%|▍         | 19/450 [20:08<7:35:35, 63.42s/it]  4%|▍         | 20/450 [21:14<7:39:02, 64.05s/it]                                                    4%|▍         | 20/450 [21:14<7:39:02, 64.05s/it]  5%|▍         | 21/450 [22:13<7:26:51, 62.50s/it]  5%|▍         | 22/450 [23:12<7:18:57, 61.54s/it]  5%|▌         | 23/450 [24:12<7:15:45, 61.23s/it]  5%|▌         | 24/450 [25:14<7:15:10, 61.29s/it]  6%|▌         | 25/450 [26:18<7:21:06, 62.27s/it]  6%|▌         | 26/450 [27:28<7:35:06, 64.40s/it]  6%|▌         | 27/450 [28:30<7:30:13, 63.86s/it]  6%|▌         | 28/450 [29:32<7:23:29, 63.06s/it]  6%|▋         | 29/450 [30:32<7:16:56, 62.27s/it]  7%|▋         | 30/450 [31:41<7:29:39, 64.24s/it]                                                    7%|▋         | 30/450 [31:41<7:29:39, 64.24s/it]  7%|▋         | 31/450 [32:47<7:31:59, 64.72s/it]  7%|▋         | 32/450 [33:45<7:18:23, 62.93s/it]  7%|▋         | 33/450 [34:47<7:14:22, 62.50s/it]  8%|▊         | 34/450 [35:47<7:07:44, 61.69s/it]  8%|▊         | 35/450 [36:45<6:59:42, 60.68s/it]  8%|▊         | 36/450 [37:52<7:12:27, 62.68s/it]  8%|▊         | 37/450 [39:07<7:35:49, 66.22s/it]  8%|▊         | 38/450 [40:06<7:20:10, 64.10s/it]  9%|▊         | 39/450 [41:00<6:57:46, 60.99s/it]  9%|▉         | 40/450 [41:57<6:48:18, 59.75s/it]                                                    9%|▉         | 40/450 [41:57<6:48:18, 59.75s/it]  9%|▉         | 41/450 [43:03<7:00:53, 61.75s/it]  9%|▉         | 42/450 [44:15<7:20:23, 64.76s/it] 10%|▉         | 43/450 [45:21<7:21:40, 65.11s/it] 10%|▉         | 44/450 [46:23<7:14:58, 64.28s/it] 10%|█         | 45/450 [47:30<7:20:01, 65.19s/it]{'loss': 1.4365, 'learning_rate': 0.0005, 'epoch': 4.1}
{'loss': 0.3045, 'learning_rate': 0.0005, 'epoch': 8.21}
{'loss': 0.0206, 'learning_rate': 0.0005, 'epoch': 12.31}
{'loss': 0.0025, 'learning_rate': 0.0005, 'epoch': 16.41}

  0%|          | 0/1 [00:00<?, ?it/s][A                                                  
                                     [A 10%|█         | 45/450 [47:32<7:20:01, 65.19s/it]
100%|██████████| 1/1 [00:00<00:00, 34.62it/s][A
                                             [A{'eval_loss': 3.5169832706451416, 'eval_runtime': 1.7122, 'eval_samples_per_second': 0.584, 'eval_steps_per_second': 0.584, 'epoch': 18.46}
2023-06-24 10:44:26,484 [INFO] on_evaluate in SampleGenerateCallback...
2023-06-24 10:44:26,485 [INFO] sample input: Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:

2023-06-24 10:44:50,329 [INFO] sample output: <s>Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:
 Asteroid City, Wes Anderson’s gorgeous, affected, and deeply layered new movie, is about a lot of things. It’s about grief and performance, storytelling and the creation of art, the exuberance of love and the crush of loss. It’s about the giddy moment when
2023-06-24 10:44:50,330 [INFO] sample input: Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:

2023-06-24 10:45:14,051 [INFO] sample output: <s>Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:
 In Wes Anderson’s “Asteroid City,” Humans Can Leave Impact Craters, Too
The film’s quirky setting and stellar cast, which includes Jason Schwartzman, Tom Hanks, and Scarlett Johansson, cannot redeem its languid incoher
2023-06-24 10:45:14,051 [INFO] sample input: You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 
2023-06-24 10:45:37,771 [INFO] sample output: <s>You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 

Asteroid City

A new movie by Wes Anderson

With Jason Schwartzman, Scarlett Johansson and Tom Hanks

The year is 1955. In the fictional American desert town of Asteroid City, a three-day convention of gifted young science students is
2023-06-24 10:45:37,772 [INFO] sample input: Movie critic Michael Phillips's main view about the movie "asteroid city" are:
2023-06-24 10:46:01,492 [INFO] sample output: <s>Movie critic Michael Phillips's main view about the movie "asteroid city" are:

The movie is:

a) a crashing bore
b) a crashing bore, but it has its moments
c) so-so
d) a crashing bore, but it has its moments, and it's the best movie ever

What is the correct answer?

a) a crashing
2023-06-24 10:46:01,493 [INFO] sample input: Overall speaking the mainstream opinion about the movie "asteroid city" are:
2023-06-24 10:46:25,208 [INFO] sample output: <s>Overall speaking the mainstream opinion about the movie "asteroid city" are:
Asteroid City is a 1997 American science fiction action film written and directed by Wes Anderson, and co-written by Owen Wilson. The film is a parody of 1950s American westerns and science fiction films, in particular the 1950s television show The Lone R
2023-06-24 10:46:33,959 [INFO] Saving PEFT checkpoint...
 10%|█         | 46/450 [50:38<11:25:34, 101.82s/it] 10%|█         | 47/450 [51:50<10:24:11, 92.93s/it]  11%|█         | 48/450 [52:51<9:18:48, 83.41s/it]  11%|█         | 49/450 [53:51<8:30:59, 76.46s/it] 11%|█         | 50/450 [54:53<8:00:06, 72.02s/it]                                                   11%|█         | 50/450 [54:53<8:00:06, 72.02s/it] 11%|█▏        | 51/450 [55:53<7:34:47, 68.39s/it] 12%|█▏        | 52/450 [56:57<7:25:17, 67.13s/it] 12%|█▏        | 53/450 [58:00<7:15:14, 65.78s/it] 12%|█▏        | 54/450 [59:12<7:26:51, 67.71s/it] 12%|█▏        | 55/450 [1:00:18<7:22:11, 67.17s/it] 12%|█▏        | 56/450 [1:01:08<6:46:49, 61.95s/it] 13%|█▎        | 57/450 [1:02:18<7:02:35, 64.52s/it] 13%|█▎        | 58/450 [1:03:17<6:49:48, 62.73s/it] 13%|█▎        | 59/450 [1:04:22<6:54:26, 63.60s/it] 13%|█▎        | 60/450 [1:05:31<7:03:14, 65.12s/it]                                                     13%|█▎        | 60/450 [1:05:31<7:03:14, 65.12s/it] 14%|█▎        | 61/450 [1:06:25<6:41:13, 61.89s/it] 14%|█▍        | 62/450 [1:07:20<6:25:26, 59.60s/it] 14%|█▍        | 63/450 [1:08:26<6:37:35, 61.64s/it] 14%|█▍        | 64/450 [1:09:37<6:55:30, 64.59s/it] 14%|█▍        | 65/450 [1:10:46<7:01:52, 65.75s/it] 15%|█▍        | 66/450 [1:11:45<6:47:31, 63.68s/it] 15%|█▍        | 67/450 [1:12:49<6:46:48, 63.73s/it] 15%|█▌        | 68/450 [1:13:51<6:43:29, 63.38s/it] 15%|█▌        | 69/450 [1:14:55<6:42:24, 63.37s/it] 16%|█▌        | 70/450 [1:15:55<6:35:26, 62.44s/it]                                                     16%|█▌        | 70/450 [1:15:55<6:35:26, 62.44s/it] 16%|█▌        | 71/450 [1:17:05<6:49:06, 64.77s/it] 16%|█▌        | 72/450 [1:18:13<6:54:41, 65.82s/it] 16%|█▌        | 73/450 [1:19:02<6:20:33, 60.57s/it] 16%|█▋        | 74/450 [1:20:01<6:17:37, 60.26s/it] 17%|█▋        | 75/450 [1:21:04<6:21:50, 61.09s/it] 17%|█▋        | 76/450 [1:22:16<6:41:31, 64.41s/it] 17%|█▋        | 77/450 [1:23:19<6:38:02, 64.03s/it] 17%|█▋        | 78/450 [1:24:14<6:19:40, 61.24s/it] 18%|█▊        | 79/450 [1:25:19<6:25:13, 62.30s/it] 18%|█▊        | 80/450 [1:26:19<6:19:03, 61.47s/it]                                                     18%|█▊        | 80/450 [1:26:19<6:19:03, 61.47s/it] 18%|█▊        | 81/450 [1:27:33<6:42:42, 65.48s/it] 18%|█▊        | 82/450 [1:28:36<6:35:35, 64.50s/it] 18%|█▊        | 83/450 [1:29:36<6:26:52, 63.25s/it] 19%|█▊        | 84/450 [1:30:37<6:21:11, 62.49s/it] 19%|█▉        | 85/450 [1:31:39<6:20:17, 62.51s/it] 19%|█▉        | 86/450 [1:32:44<6:22:51, 63.11s/it] 19%|█▉        | 87/450 [1:33:45<6:18:50, 62.62s/it] 20%|█▉        | 88/450 [1:34:54<6:28:29, 64.39s/it] 20%|█▉        | 89/450 [1:36:02<6:34:19, 65.54s/it] 20%|██        | 90/450 [1:36:53<6:07:42, 61.29s/it]                                                     20%|██        | 90/450 [1:36:53<6:07:42, 61.29s/it]{'loss': 0.0018, 'learning_rate': 0.0005, 'epoch': 20.51}
{'loss': 0.0007, 'learning_rate': 0.0005, 'epoch': 24.62}
{'loss': 0.0002, 'learning_rate': 0.0005, 'epoch': 28.72}
{'loss': 0.0001, 'learning_rate': 0.0005, 'epoch': 32.82}
{'loss': 0.0001, 'learning_rate': 0.0005, 'epoch': 36.92}

  0%|          | 0/1 [00:00<?, ?it/s][A                                                    
                                     [A 20%|██        | 90/450 [1:36:55<6:07:42, 61.29s/it]
100%|██████████| 1/1 [00:00<00:00, 35.44it/s][A
                                             [A{'eval_loss': 3.698641061782837, 'eval_runtime': 1.7142, 'eval_samples_per_second': 0.583, 'eval_steps_per_second': 0.583, 'epoch': 36.92}
2023-06-24 11:33:49,283 [INFO] on_evaluate in SampleGenerateCallback...
2023-06-24 11:33:49,284 [INFO] sample input: Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:

2023-06-24 11:34:13,077 [INFO] sample output: <s>Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:
 Asteroid City, Wes Anderson’s gorgeous cosmic comedy, is here

It’s everything you’d expect from the director, and more.

By Alison WillmoreJune 15, 2023 4:40am PT
A split screen: a bearded man
2023-06-24 11:34:13,078 [INFO] sample input: Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:

2023-06-24 11:34:36,788 [INFO] sample output: <s>Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:
 In “Asteroid City,” Wes Anderson Goes Where He Never Has Before
The film is a vigorous, deeply layered, and deeply moving exploration of the tools that we produce to help us see beyond our everyday vision.

By Richard BrodyJune 21, 2023
A woman
2023-06-24 11:34:36,788 [INFO] sample input: You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 
2023-06-24 11:35:00,509 [INFO] sample output: <s>You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 

Asteroid City

Focus Features presents, in association with Pop. 87 Productions, a Pop. 87 production, “Asteroid City,” to be released in theaters starting June 16, 2023.

“Asteroid City” is rated
2023-06-24 11:35:00,509 [INFO] sample input: Movie critic Michael Phillips's main view about the movie "asteroid city" are:
2023-06-24 11:35:24,223 [INFO] sample output: <s>Movie critic Michael Phillips's main view about the movie "asteroid city" are:

Asteroid City" is a gorgeous piece of work, from the perspective of visual design and layout. The film's color palette is a cyber-cool blend of blues and greens, with the occasional pop of yellow or red. The movie's best invention may be the high
2023-06-24 11:35:24,223 [INFO] sample input: Overall speaking the mainstream opinion about the movie "asteroid city" are:
2023-06-24 11:35:47,936 [INFO] sample output: <s>Overall speaking the mainstream opinion about the movie "asteroid city" are:
Asteroid City is a 1977 science fiction movie written and directed by Sean MacGregor. The film is set in the fictional American desert town of Asteroid City, the site of the first successful asteroid landing. A three-day celebration is taking place, but an uninvited guest
2023-06-24 11:35:55,510 [INFO] Saving PEFT checkpoint...
 20%|██        | 91/450 [1:40:06<10:02:01, 100.62s/it] 20%|██        | 92/450 [1:41:12<8:59:24, 90.40s/it]   21%|██        | 93/450 [1:42:24<8:23:57, 84.70s/it] 21%|██        | 94/450 [1:43:27<7:43:57, 78.19s/it] 21%|██        | 95/450 [1:44:21<7:00:28, 71.07s/it] 21%|██▏       | 96/450 [1:45:29<6:53:19, 70.05s/it] 22%|██▏       | 97/450 [1:46:26<6:28:52, 66.10s/it] 22%|██▏       | 98/450 [1:47:41<6:43:41, 68.81s/it] 22%|██▏       | 99/450 [1:48:43<6:30:42, 66.79s/it] 22%|██▏       | 100/450 [1:49:38<6:09:18, 63.31s/it]                                                      22%|██▏       | 100/450 [1:49:38<6:09:18, 63.31s/it] 22%|██▏       | 101/450 [1:50:39<6:03:58, 62.57s/it] 23%|██▎       | 102/450 [1:51:41<6:01:20, 62.30s/it] 23%|██▎       | 103/450 [1:52:49<6:11:46, 64.28s/it] 23%|██▎       | 104/450 [1:53:53<6:09:53, 64.14s/it] 23%|██▎       | 105/450 [1:54:59<6:12:04, 64.71s/it] 24%|██▎       | 106/450 [1:56:09<6:18:47, 66.07s/it] 24%|██▍       | 107/450 [1:57:01<5:54:33, 62.02s/it] 24%|██▍       | 108/450 [1:58:03<5:53:07, 61.95s/it] 24%|██▍       | 109/450 [1:59:07<5:56:13, 62.68s/it] 24%|██▍       | 110/450 [2:00:12<5:59:18, 63.41s/it]                                                      24%|██▍       | 110/450 [2:00:12<5:59:18, 63.41s/it] 25%|██▍       | 111/450 [2:01:18<6:02:37, 64.18s/it] 25%|██▍       | 112/450 [2:02:14<5:47:38, 61.71s/it] 25%|██▌       | 113/450 [2:03:16<5:46:03, 61.61s/it] 25%|██▌       | 114/450 [2:04:28<6:02:34, 64.75s/it] 26%|██▌       | 115/450 [2:05:26<5:49:49, 62.66s/it] 26%|██▌       | 116/450 [2:06:31<5:53:09, 63.44s/it] 26%|██▌       | 117/450 [2:07:26<5:38:56, 61.07s/it] 26%|██▌       | 118/450 [2:08:33<5:47:26, 62.79s/it] 26%|██▋       | 119/450 [2:09:32<5:39:51, 61.61s/it] 27%|██▋       | 120/450 [2:10:42<5:51:55, 63.99s/it]                                                      27%|██▋       | 120/450 [2:10:42<5:51:55, 63.99s/it] 27%|██▋       | 121/450 [2:11:43<5:46:26, 63.18s/it] 27%|██▋       | 122/450 [2:12:49<5:50:08, 64.05s/it] 27%|██▋       | 123/450 [2:13:53<5:48:20, 63.91s/it] 28%|██▊       | 124/450 [2:14:49<5:35:43, 61.79s/it] 28%|██▊       | 125/450 [2:16:05<5:56:31, 65.82s/it] 28%|██▊       | 126/450 [2:17:03<5:43:25, 63.60s/it] 28%|██▊       | 127/450 [2:18:07<5:43:24, 63.79s/it] 28%|██▊       | 128/450 [2:19:08<5:37:38, 62.91s/it] 29%|██▊       | 129/450 [2:20:06<5:29:18, 61.55s/it] 29%|██▉       | 130/450 [2:21:11<5:32:39, 62.37s/it]                                                      29%|██▉       | 130/450 [2:21:11<5:32:39, 62.37s/it] 29%|██▉       | 131/450 [2:22:17<5:37:09, 63.41s/it] 29%|██▉       | 132/450 [2:23:21<5:37:45, 63.73s/it] 30%|██▉       | 133/450 [2:24:27<5:39:31, 64.26s/it] 30%|██▉       | 134/450 [2:25:21<5:22:13, 61.18s/it] 30%|███       | 135/450 [2:26:25<5:25:46, 62.05s/it]{'loss': 0.0001, 'learning_rate': 0.0005, 'epoch': 41.03}
{'loss': 0.0001, 'learning_rate': 0.0005, 'epoch': 45.13}
{'loss': 0.0001, 'learning_rate': 0.0005, 'epoch': 49.23}
{'loss': 0.0, 'learning_rate': 0.0005, 'epoch': 53.33}

  0%|          | 0/1 [00:00<?, ?it/s][A                                                     
                                     [A 30%|███       | 135/450 [2:26:26<5:25:46, 62.05s/it]
100%|██████████| 1/1 [00:00<00:00, 38.90it/s][A
                                             [A{'eval_loss': 3.7489521503448486, 'eval_runtime': 1.7101, 'eval_samples_per_second': 0.585, 'eval_steps_per_second': 0.585, 'epoch': 55.38}
2023-06-24 12:23:20,680 [INFO] on_evaluate in SampleGenerateCallback...
2023-06-24 12:23:20,680 [INFO] sample input: Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:

2023-06-24 12:23:44,484 [INFO] sample output: <s>Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:
 Asteroid City, Wes Anderson’s gorgeous cosmic comedy, is here

It’s everything you’d expect from the director, and more.

By Alison WillmoreJune 15, 2023 4:40am PT
A split screen: a bearded man
2023-06-24 12:23:44,485 [INFO] sample input: Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:

2023-06-24 12:24:08,199 [INFO] sample output: <s>Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:
 In “Asteroid City,” Wes Anderson Goes Where He Never Has Before
The film is a vigorous, deeply layered, and deeply moving exploration of the tools that we produce to help us see beyond our everyday vision.

By Richard BrodyJune 21, 2023
A woman
2023-06-24 12:24:08,200 [INFO] sample input: You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 
2023-06-24 12:24:31,921 [INFO] sample output: <s>You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 

Asteroid City

Wes Anderson

2023

124 min

As soon as I heard that Wes Anderson was making a movie about a group of disparate characters who find themselves stranded in the American desert, I thought, “That’s Wes’s ‘The Misf
2023-06-24 12:24:31,922 [INFO] sample input: Movie critic Michael Phillips's main view about the movie "asteroid city" are:
2023-06-24 12:24:55,642 [INFO] sample output: <s>Movie critic Michael Phillips's main view about the movie "asteroid city" are:

Asteroid City" is a gorgeous piece of work, from the perspective of visual design and layout. The film's color palette is a cyber-cool blend of blues and greens, with the occasional pop of yellow or red. The movie's best invention may be the high
2023-06-24 12:24:55,642 [INFO] sample input: Overall speaking the mainstream opinion about the movie "asteroid city" are:
2023-06-24 12:25:19,354 [INFO] sample output: <s>Overall speaking the mainstream opinion about the movie "asteroid city" are:
Asteroid City is a 1977 science fiction movie written and directed by Sean MacGregor. The film is set in a desert locale in the American southwest known as Asteroid City, population 87. The town is the site of the first successful asteroid landing, and it is also where
2023-06-24 12:25:26,739 [INFO] Saving PEFT checkpoint...
 30%|███       | 136/450 [2:29:44<8:59:50, 103.16s/it] 30%|███       | 137/450 [2:30:49<7:59:28, 91.91s/it]  31%|███       | 138/450 [2:31:55<7:17:15, 84.09s/it] 31%|███       | 139/450 [2:32:48<6:27:49, 74.82s/it] 31%|███       | 140/450 [2:33:53<6:10:35, 71.73s/it]                                                      31%|███       | 140/450 [2:33:53<6:10:35, 71.73s/it] 31%|███▏      | 141/450 [2:34:55<5:55:07, 68.96s/it] 32%|███▏      | 142/450 [2:35:58<5:44:20, 67.08s/it] 32%|███▏      | 143/450 [2:36:59<5:33:01, 65.09s/it] 32%|███▏      | 144/450 [2:38:04<5:32:26, 65.19s/it] 32%|███▏      | 145/450 [2:39:04<5:22:53, 63.52s/it] 32%|███▏      | 146/450 [2:40:09<5:24:45, 64.10s/it] 33%|███▎      | 147/450 [2:41:14<5:25:01, 64.36s/it] 33%|███▎      | 148/450 [2:42:21<5:27:33, 65.08s/it] 33%|███▎      | 149/450 [2:43:22<5:21:09, 64.02s/it] 33%|███▎      | 150/450 [2:44:29<5:23:43, 64.74s/it]                                                      33%|███▎      | 150/450 [2:44:29<5:23:43, 64.74s/it] 34%|███▎      | 151/450 [2:45:24<5:07:51, 61.78s/it] 34%|███▍      | 152/450 [2:46:21<5:00:34, 60.52s/it] 34%|███▍      | 153/450 [2:47:21<4:59:14, 60.45s/it] 34%|███▍      | 154/450 [2:48:41<5:26:06, 66.10s/it] 34%|███▍      | 155/450 [2:49:41<5:16:17, 64.33s/it] 35%|███▍      | 156/450 [2:50:36<5:01:27, 61.52s/it] 35%|███▍      | 157/450 [2:51:41<5:05:53, 62.64s/it] 35%|███▌      | 158/450 [2:52:41<5:00:11, 61.68s/it] 35%|███▌      | 159/450 [2:54:01<5:26:48, 67.38s/it] 36%|███▌      | 160/450 [2:54:57<5:08:02, 63.73s/it]                                                      36%|███▌      | 160/450 [2:54:57<5:08:02, 63.73s/it] 36%|███▌      | 161/450 [2:55:58<5:03:17, 62.97s/it] 36%|███▌      | 162/450 [2:57:03<5:05:47, 63.71s/it] 36%|███▌      | 163/450 [2:58:00<4:54:45, 61.62s/it] 36%|███▋      | 164/450 [2:59:05<4:58:36, 62.65s/it] 37%|███▋      | 165/450 [3:00:12<5:04:29, 64.10s/it] 37%|███▋      | 166/450 [3:01:14<5:00:20, 63.45s/it] 37%|███▋      | 167/450 [3:02:21<5:03:07, 64.27s/it] 37%|███▋      | 168/450 [3:03:16<4:50:18, 61.77s/it] 38%|███▊      | 169/450 [3:04:19<4:50:09, 61.96s/it] 38%|███▊      | 170/450 [3:05:21<4:49:55, 62.13s/it]                                                      38%|███▊      | 170/450 [3:05:21<4:49:55, 62.13s/it] 38%|███▊      | 171/450 [3:06:37<5:08:05, 66.26s/it] 38%|███▊      | 172/450 [3:07:38<4:59:22, 64.61s/it] 38%|███▊      | 173/450 [3:08:30<4:40:15, 60.71s/it] 39%|███▊      | 174/450 [3:09:34<4:43:53, 61.71s/it] 39%|███▉      | 175/450 [3:10:30<4:35:59, 60.22s/it] 39%|███▉      | 176/450 [3:11:51<5:03:06, 66.37s/it] 39%|███▉      | 177/450 [3:12:53<4:55:40, 64.98s/it] 40%|███▉      | 178/450 [3:13:48<4:40:25, 61.86s/it] 40%|███▉      | 179/450 [3:14:51<4:42:06, 62.46s/it] 40%|████      | 180/450 [3:15:54<4:41:45, 62.61s/it]                                                      40%|████      | 180/450 [3:15:54<4:41:45, 62.61s/it]{'loss': 0.0, 'learning_rate': 0.0005, 'epoch': 57.44}
{'loss': 0.0, 'learning_rate': 0.0005, 'epoch': 61.54}
{'loss': 0.0, 'learning_rate': 0.0005, 'epoch': 65.64}
{'loss': 0.0, 'learning_rate': 0.0005, 'epoch': 69.74}
{'loss': 0.0, 'learning_rate': 0.0005, 'epoch': 73.85}

  0%|          | 0/1 [00:00<?, ?it/s][A                                                     
                                     [A 40%|████      | 180/450 [3:15:56<4:41:45, 62.61s/it]
100%|██████████| 1/1 [00:00<00:00, 35.49it/s][A
                                             [A{'eval_loss': 3.782343864440918, 'eval_runtime': 1.7083, 'eval_samples_per_second': 0.585, 'eval_steps_per_second': 0.585, 'epoch': 73.85}
2023-06-24 13:12:50,368 [INFO] on_evaluate in SampleGenerateCallback...
2023-06-24 13:12:50,368 [INFO] sample input: Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:

2023-06-24 13:13:14,223 [INFO] sample output: <s>Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:
 Asteroid City, Wes Anderson’s gorgeous cosmic comedy, is here

It’s everything you’d expect from the director, and more.

By Alison WillmoreJune 15, 2023 4:40am PT
A split screen: a bearded man
2023-06-24 13:13:14,224 [INFO] sample input: Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:

2023-06-24 13:13:37,981 [INFO] sample output: <s>Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:
 In “Asteroid City,” Wes Anderson Goes Where He Never Has Before
The film is a vigorous, deeply layered, and deeply moving exploration of the tools that we produce to help us see beyond our everyday vision.

By Richard BrodyJune 21, 2023
A woman
2023-06-24 13:13:37,982 [INFO] sample input: You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 
2023-06-24 13:14:01,717 [INFO] sample output: <s>You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 

Asteroid City

Focus Features presents, in association with Pop. 87 Productions, a Pop. 87 production, “Asteroid City,” a film by Wes Anderson. Aspect ratio 1.33:1, color, 104 minutes.





2023-06-24 13:14:01,718 [INFO] sample input: Movie critic Michael Phillips's main view about the movie "asteroid city" are:
2023-06-24 13:14:25,446 [INFO] sample output: <s>Movie critic Michael Phillips's main view about the movie "asteroid city" are:

Asteroid City" is a gorgeous piece of work, from the perspective of visual design and layout. The film's color palette is a cyber-cool blend of blues and greens, with the occasional pop of yellow or red. The movie's best invention may be the high
2023-06-24 13:14:25,447 [INFO] sample input: Overall speaking the mainstream opinion about the movie "asteroid city" are:
2023-06-24 13:14:49,181 [INFO] sample output: <s>Overall speaking the mainstream opinion about the movie "asteroid city" are:
Asteroid City is a 1977 science fiction movie written and directed by Sean MacGregor. The film is set in a desert locale in the American southwest known as Asteroid City, population 87. The town is the site of the first successful asteroid landing, and it is also where
2023-06-24 13:14:57,057 [INFO] Saving PEFT checkpoint...
 40%|████      | 181/450 [3:19:12<7:42:41, 103.20s/it] 40%|████      | 182/450 [3:20:15<6:47:21, 91.20s/it]  41%|████      | 183/450 [3:21:18<6:07:11, 82.52s/it] 41%|████      | 184/450 [3:22:20<5:38:47, 76.42s/it] 41%|████      | 185/450 [3:23:20<5:15:50, 71.51s/it] 41%|████▏     | 186/450 [3:24:31<5:14:20, 71.44s/it] 42%|████▏     | 187/450 [3:25:29<4:55:49, 67.49s/it] 42%|████▏     | 188/450 [3:26:32<4:48:09, 65.99s/it] 42%|████▏     | 189/450 [3:27:34<4:41:18, 64.67s/it] 42%|████▏     | 190/450 [3:28:33<4:33:57, 63.22s/it]                                                      42%|████▏     | 190/450 [3:28:33<4:33:57, 63.22s/it] 42%|████▏     | 191/450 [3:29:46<4:45:22, 66.11s/it] 43%|████▎     | 192/450 [3:30:47<4:37:24, 64.51s/it] 43%|████▎     | 193/450 [3:31:50<4:34:34, 64.10s/it] 43%|████▎     | 194/450 [3:32:51<4:29:26, 63.15s/it] 43%|████▎     | 195/450 [3:33:47<4:19:30, 61.06s/it] 44%|████▎     | 196/450 [3:34:42<4:09:54, 59.03s/it] 44%|████▍     | 197/450 [3:35:52<4:23:42, 62.54s/it] 44%|████▍     | 198/450 [3:37:03<4:32:53, 64.98s/it] 44%|████▍     | 199/450 [3:38:08<4:32:24, 65.12s/it] 44%|████▍     | 200/450 [3:39:09<4:25:20, 63.68s/it]                                                      44%|████▍     | 200/450 [3:39:09<4:25:20, 63.68s/it] 45%|████▍     | 201/450 [3:40:09<4:20:15, 62.71s/it] 45%|████▍     | 202/450 [3:41:14<4:21:45, 63.33s/it] 45%|████▌     | 203/450 [3:42:25<4:29:37, 65.50s/it] 45%|████▌     | 204/450 [3:43:26<4:24:07, 64.42s/it] 46%|████▌     | 205/450 [3:44:27<4:18:42, 63.36s/it] 46%|████▌     | 206/450 [3:45:35<4:22:25, 64.53s/it] 46%|████▌     | 207/450 [3:46:29<4:08:28, 61.35s/it] 46%|████▌     | 208/450 [3:47:34<4:12:40, 62.65s/it] 46%|████▋     | 209/450 [3:48:40<4:15:18, 63.56s/it] 47%|████▋     | 210/450 [3:49:39<4:08:52, 62.22s/it]                                                      47%|████▋     | 210/450 [3:49:39<4:08:52, 62.22s/it] 47%|████▋     | 211/450 [3:50:42<4:08:56, 62.49s/it] 47%|████▋     | 212/450 [3:51:43<4:06:12, 62.07s/it] 47%|████▋     | 213/450 [3:52:46<4:05:38, 62.19s/it] 48%|████▊     | 214/450 [3:53:56<4:13:37, 64.48s/it] 48%|████▊     | 215/450 [3:54:52<4:02:52, 62.01s/it] 48%|████▊     | 216/450 [3:55:57<4:06:02, 63.09s/it] 48%|████▊     | 217/450 [3:57:00<4:04:29, 62.96s/it] 48%|████▊     | 218/450 [3:58:00<3:59:44, 62.00s/it] 49%|████▊     | 219/450 [3:58:57<3:53:34, 60.67s/it] 49%|████▉     | 220/450 [4:00:19<4:16:30, 66.92s/it]                                                      49%|████▉     | 220/450 [4:00:19<4:16:30, 66.92s/it] 49%|████▉     | 221/450 [4:01:15<4:03:13, 63.73s/it] 49%|████▉     | 222/450 [4:02:22<4:05:32, 64.62s/it] 50%|████▉     | 223/450 [4:03:26<4:03:45, 64.43s/it] 50%|████▉     | 224/450 [4:04:22<3:53:47, 62.07s/it] 50%|█████     | 225/450 [4:05:21<3:48:27, 60.92s/it]{'loss': 0.0, 'learning_rate': 0.0005, 'epoch': 77.95}
{'loss': 0.0, 'learning_rate': 0.0005, 'epoch': 82.05}
{'loss': 0.0, 'learning_rate': 0.0005, 'epoch': 86.15}
{'loss': 0.0, 'learning_rate': 0.0005, 'epoch': 90.26}

  0%|          | 0/1 [00:00<?, ?it/s][A                                                     
                                     [A 50%|█████     | 225/450 [4:05:22<3:48:27, 60.92s/it]
100%|██████████| 1/1 [00:00<00:00, 36.53it/s][A
                                             [A{'eval_loss': 3.8084840774536133, 'eval_runtime': 1.7109, 'eval_samples_per_second': 0.584, 'eval_steps_per_second': 0.584, 'epoch': 92.31}
2023-06-24 14:02:16,638 [INFO] on_evaluate in SampleGenerateCallback...
2023-06-24 14:02:16,638 [INFO] sample input: Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:

2023-06-24 14:02:40,514 [INFO] sample output: <s>Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:
 Asteroid City, Wes Anderson’s gorgeous cosmic comedy, is here

It’s everything you’d expect from the director, and more.

By Alison WillmoreJune 15, 2023 4:40am PT
A split screen: a bearded man
2023-06-24 14:02:40,515 [INFO] sample input: Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:

2023-06-24 14:03:04,231 [INFO] sample output: <s>Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:
 In “Asteroid City,” Wes Anderson Goes Where He Never Has Before
The film is a vigorous, deeply layered, and deeply moving exploration of the tools that artists work with, the methods that they use, and the visions that they produce.

By Richard BrodyJune 21, 2
2023-06-24 14:03:04,231 [INFO] sample input: You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 
2023-06-24 14:03:27,947 [INFO] sample output: <s>You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 

Asteroid City

Focus Features presents, in association with Pop. 87 Productions, a Pop. 87 production, “Asteroid City,” a film by Wes Anderson. Aspect ratio 1.33:1, color, 104 minutes.





2023-06-24 14:03:27,948 [INFO] sample input: Movie critic Michael Phillips's main view about the movie "asteroid city" are:
2023-06-24 14:03:51,657 [INFO] sample output: <s>Movie critic Michael Phillips's main view about the movie "asteroid city" are:

Asteroid City" is a gorgeous piece of work, from the perspective of visual design and layout. The film's color palette is a cyber-cool blend of blues and greens, with some sharp yellows and reddish browns for contrast. The movie's best in
2023-06-24 14:03:51,658 [INFO] sample input: Overall speaking the mainstream opinion about the movie "asteroid city" are:
2023-06-24 14:04:15,372 [INFO] sample output: <s>Overall speaking the mainstream opinion about the movie "asteroid city" are:
Asteroid City is a 1977 science fiction movie written and directed by Sean MacGregor. The film is set in a desert locale in the American southwest known as Asteroid City, population 87. The town is the site of the first successful asteroid landing, and it is also where
2023-06-24 14:04:22,801 [INFO] Saving PEFT checkpoint...
 50%|█████     | 226/450 [4:08:37<6:19:25, 101.63s/it] 50%|█████     | 227/450 [4:09:40<5:34:28, 89.99s/it]  51%|█████     | 228/450 [4:10:44<5:04:11, 82.21s/it] 51%|█████     | 229/450 [4:11:47<4:41:06, 76.32s/it] 51%|█████     | 230/450 [4:12:50<4:25:08, 72.31s/it]                                                      51%|█████     | 230/450 [4:12:50<4:25:08, 72.31s/it] 51%|█████▏    | 231/450 [4:13:53<4:14:32, 69.74s/it] 52%|█████▏    | 232/450 [4:14:58<4:07:23, 68.09s/it] 52%|█████▏    | 233/450 [4:16:00<4:00:12, 66.42s/it] 52%|█████▏    | 234/450 [4:16:57<3:48:55, 63.59s/it] 52%|█████▏    | 235/450 [4:17:54<3:40:29, 61.53s/it] 52%|█████▏    | 236/450 [4:19:01<3:45:38, 63.26s/it] 53%|█████▎    | 237/450 [4:20:17<3:57:30, 66.91s/it] 53%|█████▎    | 238/450 [4:21:22<3:54:31, 66.38s/it] 53%|█████▎    | 239/450 [4:22:18<3:43:11, 63.47s/it] 53%|█████▎    | 240/450 [4:23:21<3:41:18, 63.23s/it]                                                      53%|█████▎    | 240/450 [4:23:21<3:41:18, 63.23s/it] 54%|█████▎    | 241/450 [4:24:21<3:36:31, 62.16s/it] 54%|█████▍    | 242/450 [4:25:31<3:43:41, 64.53s/it] 54%|█████▍    | 243/450 [4:26:33<3:40:21, 63.87s/it] 54%|█████▍    | 244/450 [4:27:36<3:38:16, 63.58s/it] 54%|█████▍    | 245/450 [4:28:36<3:33:05, 62.37s/it] 55%|█████▍    | 246/450 [4:29:34<3:28:29, 61.32s/it] 55%|█████▍    | 247/450 [4:30:50<3:42:13, 65.68s/it] 55%|█████▌    | 248/450 [4:31:47<3:32:21, 63.08s/it] 55%|█████▌    | 249/450 [4:32:49<3:30:12, 62.75s/it] 56%|█████▌    | 250/450 [4:33:50<3:27:29, 62.25s/it]                                                      56%|█████▌    | 250/450 [4:33:50<3:27:29, 62.25s/it] 56%|█████▌    | 251/450 [4:34:48<3:21:37, 60.79s/it] 56%|█████▌    | 252/450 [4:35:50<3:21:55, 61.19s/it] 56%|█████▌    | 253/450 [4:36:51<3:20:58, 61.21s/it] 56%|█████▋    | 254/450 [4:38:04<3:31:01, 64.60s/it] 57%|█████▋    | 255/450 [4:39:07<3:28:37, 64.19s/it] 57%|█████▋    | 256/450 [4:40:05<3:22:04, 62.50s/it] 57%|█████▋    | 257/450 [4:41:11<3:24:05, 63.45s/it] 57%|█████▋    | 258/450 [4:42:10<3:19:04, 62.21s/it] 58%|█████▊    | 259/450 [4:43:27<3:32:07, 66.64s/it] 58%|█████▊    | 260/450 [4:44:28<3:25:07, 64.77s/it]                                                      58%|█████▊    | 260/450 [4:44:28<3:25:07, 64.77s/it] 58%|█████▊    | 261/450 [4:45:24<3:15:29, 62.06s/it] 58%|█████▊    | 262/450 [4:46:27<3:15:58, 62.55s/it] 58%|█████▊    | 263/450 [4:47:28<3:12:57, 61.91s/it] 59%|█████▊    | 264/450 [4:48:26<3:08:27, 60.79s/it] 59%|█████▉    | 265/450 [4:49:30<3:10:28, 61.78s/it] 59%|█████▉    | 266/450 [4:50:39<3:16:13, 63.99s/it] 59%|█████▉    | 267/450 [4:51:43<3:15:32, 64.11s/it] 60%|█████▉    | 268/450 [4:52:38<3:05:22, 61.11s/it] 60%|█████▉    | 269/450 [4:53:38<3:03:30, 60.83s/it] 60%|██████    | 270/450 [4:54:47<3:09:59, 63.33s/it]                                                      60%|██████    | 270/450 [4:54:47<3:09:59, 63.33s/it]{'loss': 0.0, 'learning_rate': 0.0005, 'epoch': 94.36}
{'loss': 0.0, 'learning_rate': 0.0005, 'epoch': 98.46}
{'loss': 0.0, 'learning_rate': 0.0005, 'epoch': 102.56}
{'loss': 0.0, 'learning_rate': 0.0005, 'epoch': 106.67}
{'loss': 0.0, 'learning_rate': 0.0005, 'epoch': 110.77}

  0%|          | 0/1 [00:00<?, ?it/s][A                                                     
                                     [A 60%|██████    | 270/450 [4:54:49<3:09:59, 63.33s/it]
100%|██████████| 1/1 [00:00<00:00, 35.23it/s][A
                                             [A{'eval_loss': 3.831676483154297, 'eval_runtime': 1.7084, 'eval_samples_per_second': 0.585, 'eval_steps_per_second': 0.585, 'epoch': 110.77}
2023-06-24 14:51:42,943 [INFO] on_evaluate in SampleGenerateCallback...
2023-06-24 14:51:42,944 [INFO] sample input: Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:

2023-06-24 14:52:06,705 [INFO] sample output: <s>Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:
 Asteroid City, Wes Anderson’s gorgeous cosmic comedy, is here

It’s everything you’d expect from the director, and more.

By Alison WillmoreJune 15, 2023 4:40am PT
A split screen: a bearded man
2023-06-24 14:52:06,706 [INFO] sample input: Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:

2023-06-24 14:52:30,424 [INFO] sample output: <s>Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:
 In “Asteroid City,” Wes Anderson Goes Where He Never Has Before
The film is a vigorous, deeply layered, and deeply moving exploration of the tools that artists work with, the methods that they use, and the visions that they attain.

By Richard BrodyJune 21, 
2023-06-24 14:52:30,425 [INFO] sample input: You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 
2023-06-24 14:52:54,133 [INFO] sample output: <s>You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 

Asteroid City

Focus Features presents, in association with Pop. 87 Productions, a Pop. 87 production, “Asteroid City,” a film by Wes Anderson. Aspect ratio 1.33:1, color, 104 minutes.





2023-06-24 14:52:54,134 [INFO] sample input: Movie critic Michael Phillips's main view about the movie "asteroid city" are:
2023-06-24 14:53:17,836 [INFO] sample output: <s>Movie critic Michael Phillips's main view about the movie "asteroid city" are:

Asteroid City" is a gorgeous piece of work, from the perspective of visual design and layout. The film's color palette is a cyber-cool blend of blues and greens, with some sharp yellows and reddish browns for contrast. The movie's best in
2023-06-24 14:53:17,837 [INFO] sample input: Overall speaking the mainstream opinion about the movie "asteroid city" are:
2023-06-24 14:53:41,579 [INFO] sample output: <s>Overall speaking the mainstream opinion about the movie "asteroid city" are:
Asteroid City is a 1977 science fiction movie written and directed by Sean MacGregor. The film is set in a desert locale in the American southwest known as Asteroid City, population 87. The town is the site of the first successful asteroid landing, and it is also where
2023-06-24 14:53:49,125 [INFO] Saving PEFT checkpoint...
 60%|██████    | 271/450 [4:58:07<5:11:16, 104.34s/it] 60%|██████    | 272/450 [4:59:11<4:33:47, 92.29s/it]  61%|██████    | 273/450 [5:00:00<3:54:07, 79.37s/it] 61%|██████    | 274/450 [5:01:01<3:36:27, 73.79s/it] 61%|██████    | 275/450 [5:02:09<3:30:21, 72.12s/it] 61%|██████▏   | 276/450 [5:03:17<3:25:24, 70.83s/it] 62%|██████▏   | 277/450 [5:04:13<3:11:30, 66.42s/it] 62%|██████▏   | 278/450 [5:05:20<3:10:15, 66.37s/it] 62%|██████▏   | 279/450 [5:06:13<2:58:19, 62.57s/it] 62%|██████▏   | 280/450 [5:07:23<3:03:46, 64.86s/it]                                                      62%|██████▏   | 280/450 [5:07:23<3:03:46, 64.86s/it] 62%|██████▏   | 281/450 [5:08:26<3:00:42, 64.16s/it] 63%|██████▎   | 282/450 [5:09:31<3:00:35, 64.50s/it] 63%|██████▎   | 283/450 [5:10:38<3:01:21, 65.16s/it] 63%|██████▎   | 284/450 [5:11:37<2:55:25, 63.41s/it] 63%|██████▎   | 285/450 [5:12:40<2:53:31, 63.10s/it] 64%|██████▎   | 286/450 [5:13:49<2:57:56, 65.10s/it] 64%|██████▍   | 287/450 [5:14:50<2:53:11, 63.75s/it] 64%|██████▍   | 288/450 [5:15:56<2:54:15, 64.54s/it] 64%|██████▍   | 289/450 [5:16:58<2:50:38, 63.59s/it] 64%|██████▍   | 290/450 [5:17:53<2:43:02, 61.14s/it]                                                      64%|██████▍   | 290/450 [5:17:53<2:43:02, 61.14s/it] 65%|██████▍   | 291/450 [5:18:55<2:42:27, 61.30s/it] 65%|██████▍   | 292/450 [5:20:05<2:48:38, 64.04s/it] 65%|██████▌   | 293/450 [5:21:07<2:46:03, 63.46s/it] 65%|██████▌   | 294/450 [5:22:11<2:45:01, 63.47s/it] 66%|██████▌   | 295/450 [5:23:10<2:40:13, 62.02s/it] 66%|██████▌   | 296/450 [5:24:12<2:39:11, 62.02s/it] 66%|██████▌   | 297/450 [5:25:17<2:40:29, 62.94s/it] 66%|██████▌   | 298/450 [5:26:17<2:37:41, 62.24s/it] 66%|██████▋   | 299/450 [5:27:20<2:36:44, 62.28s/it] 67%|██████▋   | 300/450 [5:28:28<2:40:28, 64.19s/it]                                                      67%|██████▋   | 300/450 [5:28:28<2:40:28, 64.19s/it] 67%|██████▋   | 301/450 [5:29:34<2:40:46, 64.74s/it] 67%|██████▋   | 302/450 [5:30:33<2:35:02, 62.86s/it] 67%|██████▋   | 303/450 [5:31:38<2:35:47, 63.59s/it] 68%|██████▊   | 304/450 [5:32:34<2:29:03, 61.26s/it] 68%|██████▊   | 305/450 [5:33:48<2:37:11, 65.04s/it] 68%|██████▊   | 306/450 [5:34:52<2:35:36, 64.84s/it] 68%|██████▊   | 307/450 [5:35:44<2:25:26, 61.02s/it] 68%|██████▊   | 308/450 [5:36:51<2:28:44, 62.85s/it] 69%|██████▊   | 309/450 [5:37:52<2:26:22, 62.29s/it] 69%|██████▉   | 310/450 [5:38:57<2:27:12, 63.09s/it]                                                      69%|██████▉   | 310/450 [5:38:57<2:27:12, 63.09s/it] 69%|██████▉   | 311/450 [5:39:59<2:25:02, 62.61s/it] 69%|██████▉   | 312/450 [5:40:56<2:20:31, 61.10s/it] 70%|██████▉   | 313/450 [5:42:05<2:24:41, 63.37s/it] 70%|██████▉   | 314/450 [5:43:08<2:23:16, 63.21s/it] 70%|███████   | 315/450 [5:44:17<2:26:25, 65.08s/it]{'loss': 0.0, 'learning_rate': 0.0005, 'epoch': 114.87}
{'loss': 0.0, 'learning_rate': 0.0005, 'epoch': 118.97}
{'loss': 0.0, 'learning_rate': 0.0005, 'epoch': 123.08}
{'loss': 0.0, 'learning_rate': 0.0005, 'epoch': 127.18}

  0%|          | 0/1 [00:00<?, ?it/s][A                                                     
                                     [A 70%|███████   | 315/450 [5:44:19<2:26:25, 65.08s/it]
100%|██████████| 1/1 [00:00<00:00, 34.14it/s][A
                                             [A{'eval_loss': 3.850616455078125, 'eval_runtime': 1.7107, 'eval_samples_per_second': 0.585, 'eval_steps_per_second': 0.585, 'epoch': 129.23}
2023-06-24 15:41:13,339 [INFO] on_evaluate in SampleGenerateCallback...
2023-06-24 15:41:13,339 [INFO] sample input: Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:

2023-06-24 15:41:37,057 [INFO] sample output: <s>Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:
 Asteroid City, Wes Anderson’s gorgeous cosmic comedy, is here

It’s everything you’d expect from the director, and more.

By Alison WillmoreJune 15, 2023 6:15am PT
A split screen: a bearded man
2023-06-24 15:41:37,057 [INFO] sample input: Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:

2023-06-24 15:42:00,786 [INFO] sample output: <s>Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:
 In “Asteroid City,” Wes Anderson Goes Where He Never Has Before
The film is a vigorous, deeply layered, and deeply moving exploration of the tools that artists work with, the methods that they use, and the visions that they attain.

By Richard BrodyJune 21, 
2023-06-24 15:42:00,787 [INFO] sample input: You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 
2023-06-24 15:42:24,498 [INFO] sample output: <s>You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 

Asteroid City

Focus Features presents, in association with Pop. 87 Productions, a Pop. 87 production, “Asteroid City,” a film by Wes Anderson. Aspect ratio 1.33:1, color, 104 minutes.





2023-06-24 15:42:24,499 [INFO] sample input: Movie critic Michael Phillips's main view about the movie "asteroid city" are:
2023-06-24 15:42:48,220 [INFO] sample output: <s>Movie critic Michael Phillips's main view about the movie "asteroid city" are:

Asteroid City" is a gorgeous piece of work, from the perspective of visual design and layout. The film's color palette is a cyber-cool blend of blues and greens, with some sharp yellows and reddish browns for contrast. The movie's best in
2023-06-24 15:42:48,221 [INFO] sample input: Overall speaking the mainstream opinion about the movie "asteroid city" are:
2023-06-24 15:43:11,941 [INFO] sample output: <s>Overall speaking the mainstream opinion about the movie "asteroid city" are:
Asteroid City is a 1977 science fiction movie written and directed by Sean MacGregor. The film is set in a desert locale in the American southwest known as Asteroid City, population 87. The town is the site of the first successful asteroid landing, and it is also where
2023-06-24 15:43:21,154 [INFO] Saving PEFT checkpoint...
 70%|███████   | 316/450 [5:47:32<3:51:55, 103.85s/it] 70%|███████   | 317/450 [5:48:30<3:19:45, 90.11s/it]  71%|███████   | 318/450 [5:49:34<3:01:19, 82.42s/it] 71%|███████   | 319/450 [5:50:33<2:44:44, 75.45s/it] 71%|███████   | 320/450 [5:51:47<2:42:01, 74.78s/it]                                                      71%|███████   | 320/450 [5:51:47<2:42:01, 74.78s/it] 71%|███████▏  | 321/450 [5:52:46<2:30:34, 70.04s/it] 72%|███████▏  | 322/450 [5:53:50<2:25:43, 68.31s/it] 72%|███████▏  | 323/450 [5:54:53<2:21:26, 66.82s/it] 72%|███████▏  | 324/450 [5:55:47<2:12:20, 63.02s/it] 72%|███████▏  | 325/450 [5:56:58<2:16:15, 65.41s/it] 72%|███████▏  | 326/450 [5:58:03<2:14:38, 65.15s/it] 73%|███████▎  | 327/450 [5:59:04<2:11:18, 64.05s/it] 73%|███████▎  | 328/450 [6:00:08<2:09:55, 63.90s/it] 73%|███████▎  | 329/450 [6:01:03<2:03:19, 61.15s/it] 73%|███████▎  | 330/450 [6:02:10<2:05:55, 62.96s/it]                                                      73%|███████▎  | 330/450 [6:02:10<2:05:55, 62.96s/it] 74%|███████▎  | 331/450 [6:03:11<2:03:58, 62.51s/it] 74%|███████▍  | 332/450 [6:04:13<2:02:12, 62.14s/it] 74%|███████▍  | 333/450 [6:05:14<2:00:59, 62.05s/it] 74%|███████▍  | 334/450 [6:06:20<2:02:03, 63.14s/it] 74%|███████▍  | 335/450 [6:07:20<1:59:06, 62.14s/it] 75%|███████▍  | 336/450 [6:08:27<2:00:45, 63.56s/it] 75%|███████▍  | 337/450 [6:09:34<2:01:42, 64.63s/it] 75%|███████▌  | 338/450 [6:10:38<2:00:22, 64.49s/it] 75%|███████▌  | 339/450 [6:11:41<1:58:39, 64.14s/it] 76%|███████▌  | 340/450 [6:12:49<1:59:34, 65.23s/it]                                                      76%|███████▌  | 340/450 [6:12:49<1:59:34, 65.23s/it] 76%|███████▌  | 341/450 [6:13:43<1:52:03, 61.68s/it] 76%|███████▌  | 342/450 [6:14:42<1:49:38, 60.91s/it] 76%|███████▌  | 343/450 [6:15:39<1:46:41, 59.82s/it] 76%|███████▋  | 344/450 [6:16:57<1:55:27, 65.35s/it] 77%|███████▋  | 345/450 [6:17:52<1:48:59, 62.28s/it] 77%|███████▋  | 346/450 [6:18:55<1:48:14, 62.45s/it] 77%|███████▋  | 347/450 [6:20:02<1:49:25, 63.74s/it] 77%|███████▋  | 348/450 [6:20:57<1:43:58, 61.17s/it] 78%|███████▊  | 349/450 [6:22:15<1:51:36, 66.30s/it] 78%|███████▊  | 350/450 [6:23:19<1:49:13, 65.53s/it]                                                      78%|███████▊  | 350/450 [6:23:19<1:49:13, 65.53s/it] 78%|███████▊  | 351/450 [6:24:09<1:40:19, 60.81s/it] 78%|███████▊  | 352/450 [6:25:20<1:44:17, 63.86s/it] 78%|███████▊  | 353/450 [6:26:23<1:42:40, 63.52s/it] 79%|███████▊  | 354/450 [6:27:29<1:43:04, 64.42s/it] 79%|███████▉  | 355/450 [6:28:36<1:43:19, 65.26s/it] 79%|███████▉  | 356/450 [6:29:31<1:37:12, 62.05s/it] 79%|███████▉  | 357/450 [6:30:41<1:40:01, 64.53s/it] 80%|███████▉  | 358/450 [6:31:39<1:35:50, 62.51s/it] 80%|███████▉  | 359/450 [6:32:44<1:35:54, 63.23s/it] 80%|████████  | 360/450 [6:33:42<1:32:20, 61.56s/it]                                                      80%|████████  | 360/450 [6:33:42<1:32:20, 61.56s/it]{'loss': 0.0, 'learning_rate': 0.0005, 'epoch': 131.28}
{'loss': 0.0, 'learning_rate': 0.0005, 'epoch': 135.38}
{'loss': 0.0, 'learning_rate': 0.0005, 'epoch': 139.49}
{'loss': 0.0, 'learning_rate': 0.0005, 'epoch': 143.59}
{'loss': 0.0, 'learning_rate': 0.0005, 'epoch': 147.69}

  0%|          | 0/1 [00:00<?, ?it/s][A                                                     
                                     [A 80%|████████  | 360/450 [6:33:43<1:32:20, 61.56s/it]
100%|██████████| 1/1 [00:00<00:00, 35.29it/s][A
                                             [A{'eval_loss': 3.8679938316345215, 'eval_runtime': 1.716, 'eval_samples_per_second': 0.583, 'eval_steps_per_second': 0.583, 'epoch': 147.69}
2023-06-24 16:30:37,536 [INFO] on_evaluate in SampleGenerateCallback...
2023-06-24 16:30:37,536 [INFO] sample input: Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:

2023-06-24 16:31:01,331 [INFO] sample output: <s>Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:
 Asteroid City, Wes Anderson’s gorgeous cosmic comedy, is here

It’s everything you’d expect from the director, and more.

By Alison WillmoreJune 15, 2023 6:15am PT
A split screen: a bearded man
2023-06-24 16:31:01,331 [INFO] sample input: Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:

2023-06-24 16:31:25,047 [INFO] sample output: <s>Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:
 In “Asteroid City,” Wes Anderson Goes Where He Never Has Before
The film is a vigorous, deeply layered, and deeply moving exploration of the tools that artists work with, the methods that they use, and the visions that they attain.

By Richard BrodyJune 21, 
2023-06-24 16:31:25,048 [INFO] sample input: You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 
2023-06-24 16:31:48,754 [INFO] sample output: <s>You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 

Asteroid City

Focus Features presents, in association with Pop. 87 Productions, a Pop. 87 production, “Asteroid City,” directed by Wes Anderson, written by Roman Coppola, Wes Anderson and Jason Schwartzman, based on the work of Edward Norton.
2023-06-24 16:31:48,754 [INFO] sample input: Movie critic Michael Phillips's main view about the movie "asteroid city" are:
2023-06-24 16:32:12,460 [INFO] sample output: <s>Movie critic Michael Phillips's main view about the movie "asteroid city" are:

Asteroid City" is a gorgeous piece of work, from the perspective of visual design and layout. The film's color palette is a cyber-cool blend of blues and greens, with some sharp yellows and reddish browns for contrast. The movie's best in
2023-06-24 16:32:12,460 [INFO] sample input: Overall speaking the mainstream opinion about the movie "asteroid city" are:
2023-06-24 16:32:36,193 [INFO] sample output: <s>Overall speaking the mainstream opinion about the movie "asteroid city" are:
Asteroid City is a 1977 science fiction movie written and directed by Sean MacGregor. The film is set in a desert locale in the American southwest known as Asteroid City, population 87. The town is the site of the first successful asteroid landing, and it is also where
2023-06-24 16:32:43,650 [INFO] Saving PEFT checkpoint...
 80%|████████  | 361/450 [6:36:56<2:30:23, 101.39s/it] 80%|████████  | 362/450 [6:38:00<2:12:07, 90.09s/it]  81%|████████  | 363/450 [6:38:58<1:56:41, 80.48s/it] 81%|████████  | 364/450 [6:40:01<1:47:47, 75.21s/it] 81%|████████  | 365/450 [6:41:02<1:40:42, 71.09s/it] 81%|████████▏ | 366/450 [6:42:09<1:37:56, 69.96s/it] 82%|████████▏ | 367/450 [6:43:17<1:35:39, 69.15s/it] 82%|████████▏ | 368/450 [6:44:14<1:29:38, 65.59s/it]Killed
+ date +%s
+ run_id=1687624905
+ echo RUN ID: 
RUN ID: 
+ date
+ echo START TIME: Sat Jun 24 16:41:45 UTC 2023
START TIME: Sat Jun 24 16:41:45 UTC 2023
+ ROOT_DIR_BASE=/home/ubuntu/cloudfs/saved_models/qlora_cn
+ OUTPUT_PATH=/home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687624905
+ mkdir -p /home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687624905
+ python qlora_fact_encoder.py --dataset=/home/ubuntu/qlora/metacritics_fact_encoder_training_data.pickle --dataset_format=fact_encoder --learning_rate 0.0001 --per_device_train_batch_size 1 --gradient_accumulation_steps 16 --max_steps 450 --model_name_or_path timdettmers/guanaco-33b-merged --source_max_len 42 --target_max_len 2829 --eval_dataset_size 1 --do_eval --evaluation_strategy steps --eval_steps 45 --output_dir /home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687624905 --report_to wandb --sample_generate --save_steps 45 --train_on_source true
2023-06-24 16:41:49.099987: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F AVX512_VNNI AVX512_BF16 AVX_VNNI
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-06-24 16:41:49.412438: I tensorflow/core/util/port.cc:104] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
/home/ubuntu/.local/lib/python3.8/site-packages/pandas/core/computation/expressions.py:20: UserWarning: Pandas requires version '2.7.3' or newer of 'numexpr' (version '2.7.1' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /home/ubuntu/.local/lib/python3.8/site-packages/bitsandbytes/libbitsandbytes_cuda118.so
CUDA SETUP: CUDA runtime path found: /usr/lib/x86_64-linux-gnu/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 9.0
CUDA SETUP: Detected CUDA version 118
CUDA SETUP: Loading binary /home/ubuntu/.local/lib/python3.8/site-packages/bitsandbytes/libbitsandbytes_cuda118.so...
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.8/site-packages/transformers/utils/import_utils.py", line 1082, in _get_module
    return importlib.import_module("." + module_name, self.__name__)
  File "/usr/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/ubuntu/.local/lib/python3.8/site-packages/transformers/trainer_utils.py", line 47, in <module>
    import tensorflow as tf
  File "/usr/lib/python3/dist-packages/tensorflow/__init__.py", line 37, in <module>
    from tensorflow.python.tools import module_util as _module_util
  File "/usr/lib/python3/dist-packages/tensorflow/python/__init__.py", line 37, in <module>
    from tensorflow.python.eager import context
  File "/usr/lib/python3/dist-packages/tensorflow/python/eager/context.py", line 28, in <module>
    from tensorflow.core.framework import function_pb2
  File "/usr/lib/python3/dist-packages/tensorflow/core/framework/function_pb2.py", line 14, in <module>
    from tensorflow.core.framework import attr_value_pb2 as tensorflow_dot_core_dot_framework_dot_attr__value__pb2
  File "/usr/lib/python3/dist-packages/tensorflow/core/framework/attr_value_pb2.py", line 14, in <module>
    from tensorflow.core.framework import tensor_pb2 as tensorflow_dot_core_dot_framework_dot_tensor__pb2
  File "/usr/lib/python3/dist-packages/tensorflow/core/framework/tensor_pb2.py", line 14, in <module>
    from tensorflow.core.framework import resource_handle_pb2 as tensorflow_dot_core_dot_framework_dot_resource__handle__pb2
  File "/usr/lib/python3/dist-packages/tensorflow/core/framework/resource_handle_pb2.py", line 14, in <module>
    from tensorflow.core.framework import tensor_shape_pb2 as tensorflow_dot_core_dot_framework_dot_tensor__shape__pb2
  File "/usr/lib/python3/dist-packages/tensorflow/core/framework/tensor_shape_pb2.py", line 34, in <module>
    _descriptor.FieldDescriptor(
  File "/home/ubuntu/.local/lib/python3.8/site-packages/google/protobuf/descriptor.py", line 561, in __new__
    _message.Message._CheckCalledFromGeneratedFile()
TypeError: Descriptors cannot not be created directly.
If this call came from a _pb2.py file, your generated code is out of date and must be regenerated with protoc >= 3.19.0.
If you cannot immediately regenerate your protos, some other possible workarounds are:
 1. Downgrade the protobuf package to 3.20.x or lower.
 2. Set PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python (but this will use pure-Python parsing and will be much slower).

More information: https://developers.google.com/protocol-buffers/docs/news/2022-05-06#python-updates

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "qlora_fact_encoder.py", line 22, in <module>
    from transformers import (
  File "<frozen importlib._bootstrap>", line 1039, in _handle_fromlist
  File "/home/ubuntu/.local/lib/python3.8/site-packages/transformers/utils/import_utils.py", line 1072, in __getattr__
    module = self._get_module(self._class_to_module[name])
  File "/home/ubuntu/.local/lib/python3.8/site-packages/transformers/utils/import_utils.py", line 1084, in _get_module
    raise RuntimeError(
RuntimeError: Failed to import transformers.trainer_utils because of the following error (look up to see its traceback):
Descriptors cannot not be created directly.
If this call came from a _pb2.py file, your generated code is out of date and must be regenerated with protoc >= 3.19.0.
If you cannot immediately regenerate your protos, some other possible workarounds are:
 1. Downgrade the protobuf package to 3.20.x or lower.
 2. Set PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python (but this will use pure-Python parsing and will be much slower).

More information: https://developers.google.com/protocol-buffers/docs/news/2022-05-06#python-updates
+ date +%s
+ run_id=1687624919
+ echo RUN ID: 
RUN ID: 
+ date
+ echo START TIME: Sat Jun 24 16:41:59 UTC 2023
START TIME: Sat Jun 24 16:41:59 UTC 2023
+ ROOT_DIR_BASE=/home/ubuntu/cloudfs/saved_models/qlora_cn
+ OUTPUT_PATH=/home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687624919
+ mkdir -p /home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687624919
+ python qlora_fact_encoder.py --dataset=/home/ubuntu/qlora/metacritics_fact_encoder_training_data.pickle --dataset_format=fact_encoder --learning_rate 0.0001 --per_device_train_batch_size 1 --gradient_accumulation_steps 16 --max_steps 450 --model_name_or_path timdettmers/guanaco-33b-merged --source_max_len 42 --target_max_len 2829 --eval_dataset_size 1 --do_eval --evaluation_strategy steps --eval_steps 45 --output_dir /home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687624919 --report_to wandb --sample_generate --save_steps 45 --train_on_source true
2023-06-24 16:42:02.469443: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F AVX512_VNNI AVX512_BF16 AVX_VNNI
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-06-24 16:42:02.675599: I tensorflow/core/util/port.cc:104] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
--------------------------------------------------------------------------
WARNING: No preset parameters were found for the device that Open MPI
detected:

  Local host:            209-20-157-252
  Device name:           mlx5_0
  Device vendor ID:      0x02c9
  Device vendor part ID: 4122

Default device parameters will be used, which may result in lower
performance.  You can edit any of the files specified by the
btl_openib_device_param_files MCA parameter to set values for your
device.

NOTE: You can turn off this warning by setting the MCA parameter
      btl_openib_warn_no_device_params_found to 0.
--------------------------------------------------------------------------
--------------------------------------------------------------------------
No OpenFabrics connection schemes reported that they were able to be
used on a specific port.  As such, the openib BTL (OpenFabrics
support) will be disabled for this port.

  Local host:           209-20-157-252
  Local device:         mlx5_0
  Local port:           1
  CPCs attempted:       udcm
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Open MPI failed an OFI Libfabric library call (fi_domain).  This is highly
unusual; your job may behave unpredictably (and/or abort) after this.

  Local host: 209-20-157-252
  Location: mtl_ofi_component.c:610
  Error: No data available (61)
--------------------------------------------------------------------------

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /home/ubuntu/.local/lib/python3.8/site-packages/bitsandbytes/libbitsandbytes_cuda118.so
CUDA SETUP: CUDA runtime path found: /usr/lib/x86_64-linux-gnu/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 9.0
CUDA SETUP: Detected CUDA version 118
CUDA SETUP: Loading binary /home/ubuntu/.local/lib/python3.8/site-packages/bitsandbytes/libbitsandbytes_cuda118.so...
2023-06-24 16:42:08,057 [INFO] args: Namespace(__cached__setup_devices=device(type='cuda', index=0), _n_gpu=1, adafactor=False, adam8bit=False, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, auto_find_batch_size=False, bf16=False, bf16_full_eval=False, bits=4, cache_dir=None, data_seed=None, dataloader_drop_last=False, dataloader_num_workers=0, dataloader_pin_memory=True, dataset='/home/ubuntu/qlora/metacritics_fact_encoder_training_data.pickle', dataset_format='fact_encoder', ddp_backend=None, ddp_broadcast_buffers=None, ddp_bucket_cap_mb=None, ddp_find_unused_parameters=None, ddp_timeout=1800, debug=[], debug_mode=False, deepspeed=None, deepspeed_plugin=None, disable_tqdm=False, distributed_state=Distributed environment: NO
Num processes: 1
Process index: 0
Local process index: 0
Device: cuda
, do_eval=True, do_mmlu_eval=False, do_predict=False, do_train=True, double_quant=True, eval_accumulation_steps=None, eval_dataset_size=1, eval_delay=0, eval_steps=45, evaluation_strategy=<IntervalStrategy.STEPS: 'steps'>, fp16=False, fp16_backend='auto', fp16_full_eval=False, fp16_opt_level='O1', fsdp=[], fsdp_config={'fsdp_min_num_params': 0, 'xla': False, 'xla_fsdp_grad_ckpt': False}, fsdp_min_num_params=0, fsdp_transformer_layer_cls_to_wrap=None, full_determinism=False, full_finetune=False, generation_config=GenerationConfig {
  "max_new_tokens": 256,
  "transformers_version": "4.31.0.dev0"
}
, generation_max_length=None, generation_num_beams=None, gradient_accumulation_steps=16, gradient_checkpointing=True, greater_is_better=None, group_by_length=True, half_precision_backend='auto', hub_model_id=None, hub_private_repo=False, hub_strategy=<HubStrategy.EVERY_SAVE: 'every_save'>, hub_token=None, ignore_data_skip=False, include_inputs_for_metrics=False, jit_mode_eval=False, label_names=None, label_smoothing_factor=0.0, learning_rate=0.0001, length_column_name='length', load_best_model_at_end=False, local_rank=0, log_level='passive', log_level_replica='warning', log_on_each_node=True, logging_dir='/home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687624919/runs/Jun24_16-42-08_209-20-157-252', logging_first_step=False, logging_nan_inf_filter=True, logging_steps=10, logging_strategy=<IntervalStrategy.STEPS: 'steps'>, lora_alpha=16, lora_dropout=0.0, lora_r=64, lr_scheduler_type=<SchedulerType.CONSTANT: 'constant'>, max_eval_samples=None, max_grad_norm=0.3, max_memory_MB=80000, max_mmlu_samples=None, max_steps=450, max_train_samples=None, metric_for_best_model=None, mmlu_dataset='mmlu-fs', mmlu_source_max_len=2048, mmlu_split='eval', model_name_or_path='timdettmers/guanaco-33b-merged', mp_parameters='', no_cuda=False, num_train_epochs=3.0, optim=<OptimizerNames.PAGED_ADAMW: 'paged_adamw_32bit'>, optim_args=None, output_dir='/home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687624919', overwrite_output_dir=False, past_index=-1, per_device_eval_batch_size=8, per_device_train_batch_size=1, per_gpu_eval_batch_size=None, per_gpu_train_batch_size=None, predict_with_generate=False, prediction_loss_only=False, push_to_hub=False, push_to_hub_model_id=None, push_to_hub_organization=None, push_to_hub_token=None, quant_type='nf4', ray_scope='last', remove_unused_columns=False, report_to=['wandb'], resume_from_checkpoint=None, run_name='/home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687624919', sample_generate=True, save_on_each_node=False, save_safetensors=False, save_steps=45, save_strategy=<IntervalStrategy.STEPS: 'steps'>, save_total_limit=40, seed=42, sharded_ddp=[], skip_memory_metrics=True, sortish_sampler=False, source_max_len=42, target_max_len=2829, tf32=None, torch_compile=False, torch_compile_backend=None, torch_compile_mode=None, torchdynamo=None, tpu_metrics_debug=False, tpu_num_cores=None, train_on_source=True, trust_remote_code=False, use_ipex=False, use_legacy_prediction_loop=False, use_mps_device=False, warmup_ratio=0.03, warmup_steps=0, weight_decay=0.0, xpu_backend=None)
2023-06-24 16:42:08,057 [INFO] loading base model timdettmers/guanaco-33b-merged...
/home/ubuntu/.local/lib/python3.8/site-packages/pandas/core/computation/expressions.py:20: UserWarning: Pandas requires version '2.7.3' or newer of 'numexpr' (version '2.7.1' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:35<03:31, 35.17s/it]Loading checkpoint shards:  29%|██▊       | 2/7 [01:07<02:47, 33.41s/it]Loading checkpoint shards:  43%|████▎     | 3/7 [01:41<02:14, 33.61s/it]Loading checkpoint shards:  57%|█████▋    | 4/7 [02:15<01:42, 34.00s/it]Loading checkpoint shards:  71%|███████▏  | 5/7 [02:49<01:07, 33.86s/it]Loading checkpoint shards:  86%|████████▌ | 6/7 [03:23<00:33, 33.88s/it]Loading checkpoint shards: 100%|██████████| 7/7 [03:43<00:00, 29.40s/it]Loading checkpoint shards: 100%|██████████| 7/7 [03:43<00:00, 31.93s/it]2023-06-24 16:45:53,406 [INFO] adding LoRA modules...
2023-06-24 16:48:21,614 [INFO] trainable params: 243793920.0 || all params: 16965454336 || trainable: 1.4370020110966275
2023-06-24 16:48:21,614 [INFO] loaded model
2023-06-24 16:48:23,838 [INFO] Adding special tokens.
2023-06-24 16:48:23,853 [INFO] Splitting train dataset in train and validation according to `eval_dataset_size`

Map:   0%|          | 0/1 [00:00<?, ? examples/s]                                                 Map:   0%|          | 0/39 [00:00<?, ? examples/s]                                                  2023-06-24 16:48:23,874 [INFO] *** Train ***
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.8/logging/__init__.py", line 1085, in emit
    msg = self.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 929, in format
    return fmt.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 668, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.8/logging/__init__.py", line 373, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "qlora_fact_encoder.py", line 849, in <module>
    train()
  File "qlora_fact_encoder.py", line 803, in train
    logger.info(k, v, v/total)
Message: torch.float32
Arguments: (914390528, 0.053897160218144315)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.8/logging/__init__.py", line 1085, in emit
    msg = self.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 929, in format
    return fmt.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 668, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.8/logging/__init__.py", line 373, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "qlora_fact_encoder.py", line 849, in <module>
    train()
  File "qlora_fact_encoder.py", line 803, in train
    logger.info(k, v, v/total)
Message: torch.float32
Arguments: (914390528, 0.053897160218144315)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.8/logging/__init__.py", line 1085, in emit
    msg = self.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 929, in format
    return fmt.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 668, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.8/logging/__init__.py", line 373, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "qlora_fact_encoder.py", line 849, in <module>
    train()
  File "qlora_fact_encoder.py", line 803, in train
    logger.info(k, v, v/total)
Message: torch.uint8
Arguments: (16051077120, 0.9461028397818557)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.8/logging/__init__.py", line 1085, in emit
    msg = self.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 929, in format
    return fmt.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 668, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.8/logging/__init__.py", line 373, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "qlora_fact_encoder.py", line 849, in <module>
    train()
  File "qlora_fact_encoder.py", line 803, in train
    logger.info(k, v, v/total)
Message: torch.uint8
Arguments: (16051077120, 0.9461028397818557)
wandb: Currently logged in as: lyo-gavin. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/ubuntu/qlora/wandb/run-20230624_164825-0uxt8oqp
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run floral-sky-101
wandb: ⭐️ View project at https://wandb.ai/lyo-gavin/huggingface
wandb: 🚀 View run at https://wandb.ai/lyo-gavin/huggingface/runs/0uxt8oqp
  0%|          | 0/450 [00:00<?, ?it/s]  0%|          | 1/450 [01:04<7:59:43, 64.11s/it]  0%|          | 2/450 [02:04<7:44:20, 62.19s/it]  1%|          | 3/450 [03:22<8:35:54, 69.25s/it]  1%|          | 4/450 [04:26<8:18:06, 67.01s/it]  1%|          | 5/450 [05:25<7:56:12, 64.21s/it]  1%|▏         | 6/450 [06:34<8:06:31, 65.75s/it]  2%|▏         | 7/450 [07:27<7:35:44, 61.73s/it]  2%|▏         | 8/450 [08:30<7:37:32, 62.11s/it]  2%|▏         | 9/450 [09:37<7:48:29, 63.74s/it]  2%|▏         | 10/450 [10:46<7:57:37, 65.13s/it]                                                    2%|▏         | 10/450 [10:46<7:57:37, 65.13s/it]  2%|▏         | 11/450 [11:52<7:58:31, 65.40s/it]  3%|▎         | 12/450 [12:44<7:28:43, 61.47s/it]  3%|▎         | 13/450 [13:54<7:47:16, 64.16s/it]  3%|▎         | 14/450 [14:52<7:31:38, 62.15s/it]  3%|▎         | 15/450 [15:58<7:39:01, 63.31s/it]  4%|▎         | 16/450 [17:03<7:41:34, 63.81s/it]  4%|▍         | 17/450 [17:57<7:18:55, 60.82s/it]  4%|▍         | 18/450 [19:10<7:44:54, 64.57s/it]  4%|▍         | 19/450 [20:11<7:36:19, 63.53s/it]  4%|▍         | 20/450 [21:17<7:39:38, 64.14s/it]                                                    4%|▍         | 20/450 [21:17<7:39:38, 64.14s/it]  5%|▍         | 21/450 [22:16<7:27:11, 62.54s/it]  5%|▍         | 22/450 [23:15<7:19:20, 61.59s/it]  5%|▌         | 23/450 [24:16<7:16:18, 61.31s/it]  5%|▌         | 24/450 [25:17<7:15:48, 61.38s/it]  6%|▌         | 25/450 [26:22<7:21:55, 62.39s/it]  6%|▌         | 26/450 [27:31<7:35:44, 64.49s/it]  6%|▌         | 27/450 [28:34<7:31:00, 63.97s/it]  6%|▌         | 28/450 [29:35<7:24:11, 63.16s/it]  6%|▋         | 29/450 [30:36<7:17:36, 62.37s/it]  7%|▋         | 30/450 [31:45<7:30:20, 64.33s/it]                                                    7%|▋         | 30/450 [31:45<7:30:20, 64.33s/it]  7%|▋         | 31/450 [32:51<7:32:36, 64.81s/it]  7%|▋         | 32/450 [33:50<7:19:01, 63.02s/it]  7%|▋         | 33/450 [34:51<7:15:03, 62.60s/it]  8%|▊         | 34/450 [35:51<7:08:18, 61.77s/it]  8%|▊         | 35/450 [36:49<7:00:13, 60.76s/it]  8%|▊         | 36/450 [37:57<7:12:57, 62.75s/it]  8%|▊         | 37/450 [39:11<7:36:20, 66.30s/it]  8%|▊         | 38/450 [40:11<7:20:38, 64.17s/it]  9%|▊         | 39/450 [41:04<6:58:26, 61.09s/it]  9%|▉         | 40/450 [42:01<6:48:59, 59.85s/it]                                                    9%|▉         | 40/450 [42:01<6:48:59, 59.85s/it]  9%|▉         | 41/450 [43:08<7:01:14, 61.80s/it]  9%|▉         | 42/450 [44:20<7:20:47, 64.82s/it] 10%|▉         | 43/450 [45:26<7:22:04, 65.17s/it] 10%|▉         | 44/450 [46:28<7:15:21, 64.34s/it] 10%|█         | 45/450 [47:35<7:20:15, 65.22s/it]{'loss': 1.9674, 'learning_rate': 0.0001, 'epoch': 4.1}
{'loss': 1.3497, 'learning_rate': 0.0001, 'epoch': 8.21}
{'loss': 0.9024, 'learning_rate': 0.0001, 'epoch': 12.31}
{'loss': 0.5323, 'learning_rate': 0.0001, 'epoch': 16.41}

  0%|          | 0/1 [00:00<?, ?it/s][A                                                  
                                     [A 10%|█         | 45/450 [47:37<7:20:15, 65.22s/it]
100%|██████████| 1/1 [00:00<00:00, 35.06it/s][A
                                             [A{'eval_loss': 2.343048572540283, 'eval_runtime': 1.7151, 'eval_samples_per_second': 0.583, 'eval_steps_per_second': 0.583, 'epoch': 18.46}
2023-06-24 17:36:04,020 [INFO] on_evaluate in SampleGenerateCallback...
2023-06-24 17:36:04,020 [INFO] sample input: Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:

2023-06-24 17:36:28,044 [INFO] sample output: <s>Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:
 Asteroid City, Wes Anderson’s 11th movie, is a heart-stirring delight

The film makes a compelling case that art can convey feelings that even its creators don’t understand.

Alissa Wilkinson

Senior critic

June 15, 2
2023-06-24 17:36:28,044 [INFO] sample input: Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:

2023-06-24 17:36:51,882 [INFO] sample output: <s>Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:
 “Asteroid City”: Wes Anderson’s Spacey Surface
In this new film, the director’s signature style is all the more distancing.

By Richard BrodyJune 21, 2023

Wes Anderson’s “Asteroid City” is a box of
2023-06-24 17:36:51,882 [INFO] sample input: You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 
2023-06-24 17:37:15,712 [INFO] sample output: <s>You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 

From director Wes Anderson, "Asteroid City" is a star-studded action-comedy about a group of strangers who find themselves stuck in the middle of nowhere after their planes are grounded in the tiny town of Asteroid City. 

Among the stranded passengers are a famous
2023-06-24 17:37:15,713 [INFO] sample input: Movie critic Michael Phillips's main view about the movie "asteroid city" are:
2023-06-24 17:37:39,538 [INFO] sample output: <s>Movie critic Michael Phillips's main view about the movie "asteroid city" are:

Asteroid City' is a crashing bore

Michael PhillipsFilm Critic

Asteroid City” is a crashing bore, a 104-minute collection of scenes and characters that add up to a lump of storytelling inertia. The movie’s writer-
2023-06-24 17:37:39,538 [INFO] sample input: Overall speaking the mainstream opinion about the movie "asteroid city" are:
2023-06-24 17:38:03,369 [INFO] sample output: <s>Overall speaking the mainstream opinion about the movie "asteroid city" are:
Asteroid City is a movie that is based on a story written by a famous writer. The movie is about a man who is a carpenter and he is also a widower. The movie is about his struggle to deal with the loss of his wife and his children. The movie is about his struggle to deal with the fact
2023-06-24 17:38:12,334 [INFO] Saving PEFT checkpoint...
 10%|█         | 46/450 [50:42<11:25:05, 101.75s/it] 10%|█         | 47/450 [51:54<10:23:55, 92.89s/it]  11%|█         | 48/450 [52:56<9:19:02, 83.44s/it]  11%|█         | 49/450 [53:56<8:31:24, 76.52s/it] 11%|█         | 50/450 [54:58<8:00:46, 72.12s/it]                                                   11%|█         | 50/450 [54:58<8:00:46, 72.12s/it] 11%|█▏        | 51/450 [55:58<7:35:03, 68.43s/it] 12%|█▏        | 52/450 [57:02<7:25:28, 67.16s/it] 12%|█▏        | 53/450 [58:04<7:14:50, 65.72s/it] 12%|█▏        | 54/450 [59:17<7:26:28, 67.65s/it] 12%|█▏        | 55/450 [1:00:23<7:22:01, 67.14s/it] 12%|█▏        | 56/450 [1:01:12<6:46:55, 61.97s/it] 13%|█▎        | 57/450 [1:02:23<7:02:48, 64.55s/it] 13%|█▎        | 58/450 [1:03:22<6:49:56, 62.74s/it] 13%|█▎        | 59/450 [1:04:27<6:54:34, 63.62s/it] 13%|█▎        | 60/450 [1:05:36<7:03:26, 65.14s/it]                                                     13%|█▎        | 60/450 [1:05:36<7:03:26, 65.14s/it] 14%|█▎        | 61/450 [1:06:30<6:41:28, 61.92s/it] 14%|█▍        | 62/450 [1:07:25<6:25:41, 59.64s/it] 14%|█▍        | 63/450 [1:08:31<6:38:09, 61.73s/it] 14%|█▍        | 64/450 [1:09:43<6:56:09, 64.69s/it] 14%|█▍        | 65/450 [1:10:51<7:02:31, 65.85s/it] 15%|█▍        | 66/450 [1:11:50<6:48:09, 63.78s/it] 15%|█▍        | 67/450 [1:12:54<6:47:32, 63.84s/it] 15%|█▌        | 68/450 [1:13:57<6:44:06, 63.47s/it] 15%|█▌        | 69/450 [1:15:00<6:42:51, 63.44s/it] 16%|█▌        | 70/450 [1:16:01<6:35:56, 62.52s/it]                                                     16%|█▌        | 70/450 [1:16:01<6:35:56, 62.52s/it] 16%|█▌        | 71/450 [1:17:11<6:49:44, 64.87s/it] 16%|█▌        | 72/450 [1:18:20<6:55:27, 65.95s/it] 16%|█▌        | 73/450 [1:19:08<6:21:07, 60.66s/it] 16%|█▋        | 74/450 [1:20:07<6:18:07, 60.34s/it] 17%|█▋        | 75/450 [1:21:10<6:22:03, 61.13s/it] 17%|█▋        | 76/450 [1:22:23<6:41:45, 64.45s/it] 17%|█▋        | 77/450 [1:23:26<6:38:16, 64.07s/it] 17%|█▋        | 78/450 [1:24:21<6:20:01, 61.29s/it] 18%|█▊        | 79/450 [1:25:25<6:25:39, 62.37s/it] 18%|█▊        | 80/450 [1:26:25<6:19:18, 61.51s/it]                                                     18%|█▊        | 80/450 [1:26:25<6:19:18, 61.51s/it] 18%|█▊        | 81/450 [1:27:40<6:42:56, 65.52s/it] 18%|█▊        | 82/450 [1:28:42<6:35:47, 64.53s/it] 18%|█▊        | 83/450 [1:29:42<6:26:58, 63.27s/it] 19%|█▊        | 84/450 [1:30:43<6:21:33, 62.55s/it] 19%|█▉        | 85/450 [1:31:46<6:20:38, 62.57s/it] 19%|█▉        | 86/450 [1:32:51<6:23:21, 63.19s/it] 19%|█▉        | 87/450 [1:33:52<6:19:26, 62.72s/it] 20%|█▉        | 88/450 [1:35:01<6:29:07, 64.49s/it] 20%|█▉        | 89/450 [1:36:09<6:34:47, 65.62s/it] 20%|██        | 90/450 [1:37:00<6:08:00, 61.34s/it]                                                     20%|██        | 90/450 [1:37:00<6:08:00, 61.34s/it]{'loss': 0.2749, 'learning_rate': 0.0001, 'epoch': 20.51}
{'loss': 0.0823, 'learning_rate': 0.0001, 'epoch': 24.62}
{'loss': 0.0147, 'learning_rate': 0.0001, 'epoch': 28.72}
{'loss': 0.0059, 'learning_rate': 0.0001, 'epoch': 32.82}
{'loss': 0.0043, 'learning_rate': 0.0001, 'epoch': 36.92}

  0%|          | 0/1 [00:00<?, ?it/s][A                                                    
                                     [A 20%|██        | 90/450 [1:37:02<6:08:00, 61.34s/it]
100%|██████████| 1/1 [00:00<00:00, 35.14it/s][A
                                             [A{'eval_loss': 2.7129065990448, 'eval_runtime': 1.7158, 'eval_samples_per_second': 0.583, 'eval_steps_per_second': 0.583, 'epoch': 36.92}
2023-06-24 18:25:29,100 [INFO] on_evaluate in SampleGenerateCallback...
2023-06-24 18:25:29,100 [INFO] sample input: Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:

2023-06-24 18:25:53,017 [INFO] sample output: <s>Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:
 Asteroid City, Wes Anderson’s 11th feature, is a play within a teleplay within a movie

By Alissa Wilkinson Jun 15, 2023

Almost halfway through Asteroid City, the new movie from Wes Anderson, a character says to another, “I
2023-06-24 18:25:53,017 [INFO] sample input: Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:

2023-06-24 18:26:16,880 [INFO] sample output: <s>Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:
 “Asteroid City,” Wes Anderson’s New Film, Is a Piece of 1950s Desert Americana
In this delightful movie, which plays like a double feature with “Asteroid City,” Wes Anderson takes a break from his characteristic elaborate mise-en-scène and concentrates on the
2023-06-24 18:26:16,881 [INFO] sample input: You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 
2023-06-24 18:26:40,712 [INFO] sample output: <s>You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 

Director Wes Anderson’s new movie, “Asteroid City,” is a lighthearted and exhilarating film about a group of students who attend a space academy in the fictional city of Asteroid City. The film follows the students as they learn about the wonders of the universe, make new friends
2023-06-24 18:26:40,713 [INFO] sample input: Movie critic Michael Phillips's main view about the movie "asteroid city" are:
2023-06-24 18:27:04,542 [INFO] sample output: <s>Movie critic Michael Phillips's main view about the movie "asteroid city" are:

1. "Asteroid City" is a movie about a man-made asteroid that orbits Earth, population 87, which is also the title of the movie. The film was directed by Wes Anderson, who wrote the screenplay with Roman Coppola. The cast includes Jason Schwartzman, Scar
2023-06-24 18:27:04,542 [INFO] sample input: Overall speaking the mainstream opinion about the movie "asteroid city" are:
2023-06-24 18:27:28,366 [INFO] sample output: <s>Overall speaking the mainstream opinion about the movie "asteroid city" are:
Asteroid City is a movie that is based on a story written by a famous writer. The movie is a sci-fi movie and it is based on a story that is written in a fictional world. The movie is about a man who is living in a place where there are no living things and he is alone. The only
2023-06-24 18:27:35,730 [INFO] Saving PEFT checkpoint...
 20%|██        | 91/450 [1:40:12<10:00:30, 100.36s/it] 20%|██        | 92/450 [1:41:18<8:58:28, 90.25s/it]   21%|██        | 93/450 [1:42:30<8:23:30, 84.62s/it] 21%|██        | 94/450 [1:43:33<7:43:38, 78.14s/it] 21%|██        | 95/450 [1:44:28<7:00:50, 71.13s/it] 21%|██▏       | 96/450 [1:45:36<6:53:52, 70.15s/it] 22%|██▏       | 97/450 [1:46:33<6:29:24, 66.19s/it] 22%|██▏       | 98/450 [1:47:48<6:44:08, 68.89s/it] 22%|██▏       | 99/450 [1:48:50<6:31:04, 66.85s/it] 22%|██▏       | 100/450 [1:49:45<6:09:39, 63.37s/it]                                                      22%|██▏       | 100/450 [1:49:45<6:09:39, 63.37s/it] 22%|██▏       | 101/450 [1:50:46<6:04:07, 62.60s/it] 23%|██▎       | 102/450 [1:51:48<6:01:29, 62.33s/it] 23%|██▎       | 103/450 [1:52:56<6:11:54, 64.31s/it] 23%|██▎       | 104/450 [1:54:00<6:10:17, 64.21s/it] 23%|██▎       | 105/450 [1:55:07<6:12:34, 64.79s/it] 24%|██▎       | 106/450 [1:56:16<6:19:13, 66.14s/it] 24%|██▍       | 107/450 [1:57:09<5:54:56, 62.09s/it] 24%|██▍       | 108/450 [1:58:10<5:53:28, 62.01s/it] 24%|██▍       | 109/450 [1:59:15<5:56:35, 62.74s/it] 24%|██▍       | 110/450 [2:00:20<5:59:43, 63.48s/it]                                                      24%|██▍       | 110/450 [2:00:20<5:59:43, 63.48s/it] 25%|██▍       | 111/450 [2:01:26<6:03:04, 64.26s/it] 25%|██▍       | 112/450 [2:02:22<5:48:18, 61.83s/it] 25%|██▌       | 113/450 [2:03:24<5:46:45, 61.74s/it] 25%|██▌       | 114/450 [2:04:36<6:03:14, 64.86s/it] 26%|██▌       | 115/450 [2:05:34<5:50:33, 62.79s/it] 26%|██▌       | 116/450 [2:06:39<5:53:59, 63.59s/it] 26%|██▌       | 117/450 [2:07:35<5:39:37, 61.19s/it] 26%|██▌       | 118/450 [2:08:42<5:48:02, 62.90s/it] 26%|██▋       | 119/450 [2:09:41<5:40:23, 61.70s/it] 27%|██▋       | 120/450 [2:10:50<5:52:31, 64.10s/it]                                                      27%|██▋       | 120/450 [2:10:50<5:52:31, 64.10s/it] 27%|██▋       | 121/450 [2:11:52<5:46:55, 63.27s/it] 27%|██▋       | 122/450 [2:12:58<5:50:31, 64.12s/it] 27%|██▋       | 123/450 [2:14:02<5:48:41, 63.98s/it] 28%|██▊       | 124/450 [2:14:58<5:36:07, 61.86s/it] 28%|██▊       | 125/450 [2:16:14<5:56:59, 65.91s/it] 28%|██▊       | 126/450 [2:17:12<5:43:52, 63.68s/it] 28%|██▊       | 127/450 [2:18:17<5:43:46, 63.86s/it] 28%|██▊       | 128/450 [2:19:17<5:37:53, 62.96s/it] 29%|██▊       | 129/450 [2:20:16<5:29:36, 61.61s/it] 29%|██▉       | 130/450 [2:21:20<5:32:50, 62.41s/it]                                                      29%|██▉       | 130/450 [2:21:20<5:32:50, 62.41s/it] 29%|██▉       | 131/450 [2:22:26<5:37:13, 63.43s/it] 29%|██▉       | 132/450 [2:23:30<5:37:43, 63.72s/it] 30%|██▉       | 133/450 [2:24:36<5:39:33, 64.27s/it] 30%|██▉       | 134/450 [2:25:30<5:22:17, 61.20s/it] 30%|███       | 135/450 [2:26:34<5:25:57, 62.09s/it]{'loss': 0.0037, 'learning_rate': 0.0001, 'epoch': 41.03}
{'loss': 0.0035, 'learning_rate': 0.0001, 'epoch': 45.13}
{'loss': 0.0034, 'learning_rate': 0.0001, 'epoch': 49.23}
{'loss': 0.0033, 'learning_rate': 0.0001, 'epoch': 53.33}

  0%|          | 0/1 [00:00<?, ?it/s][A                                                     
                                     [A 30%|███       | 135/450 [2:26:36<5:25:57, 62.09s/it]
100%|██████████| 1/1 [00:00<00:00, 35.09it/s][A
                                             [A{'eval_loss': 2.771336317062378, 'eval_runtime': 1.7109, 'eval_samples_per_second': 0.584, 'eval_steps_per_second': 0.584, 'epoch': 55.38}
2023-06-24 19:15:02,833 [INFO] on_evaluate in SampleGenerateCallback...
2023-06-24 19:15:02,833 [INFO] sample input: Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:

2023-06-24 19:15:26,796 [INFO] sample output: <s>Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:
 Asteroid City, Wes Anderson’s 1950s sci-fi comedy, is a crashing bore

Alissa Wilkinson

Alissa Wilkinson

Scarlett Johansson in Asteroid City.

Image by Focus Features

Wes Anderson’s Astero
2023-06-24 19:15:26,796 [INFO] sample input: Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:

2023-06-24 19:15:50,713 [INFO] sample output: <s>Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:
 “Asteroid City,” Wes Anderson’s New Film, Is a Piece of 1950s Desert Americana
In this delightful movie, which plays like a theatre piece on film, all the action takes place in a single setting—a luncheonette with a motel out back.

By
2023-06-24 19:15:50,714 [INFO] sample input: You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 
2023-06-24 19:16:14,562 [INFO] sample output: <s>You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 

Directed by Wes Anderson, Asteroid City is a 2023 American comedy-drama film written by Anderson and Roman Coppola and produced by Indian Paintbrush. The film stars Jason Schwartzman, Scarlett Johansson, Tom Hanks, Jeffrey Wright, Tilda Swinton
2023-06-24 19:16:14,563 [INFO] sample input: Movie critic Michael Phillips's main view about the movie "asteroid city" are:
2023-06-24 19:16:38,381 [INFO] sample output: <s>Movie critic Michael Phillips's main view about the movie "asteroid city" are:

1. "Asteroid City" is a movie about a man-made asteroid that orbits Earth, population 87, which is also the title of the movie. The film was directed by Wes Anderson, from a script he wrote with Roman Coppola. The actors included in the movie are Jason Schwartz
2023-06-24 19:16:38,382 [INFO] sample input: Overall speaking the mainstream opinion about the movie "asteroid city" are:
2023-06-24 19:17:02,206 [INFO] sample output: <s>Overall speaking the mainstream opinion about the movie "asteroid city" are:
Asteroid City is a movie that is based on a story written by a famous writer in the past. The movie is a sci-fi movie that is based on a story about a UFO that came to Earth and the chaos that it brings. The movie is a movie that is filled with action and it is a movie that
2023-06-24 19:17:12,280 [INFO] Saving PEFT checkpoint...
 30%|███       | 136/450 [2:29:57<9:05:48, 104.30s/it] 30%|███       | 137/450 [2:31:03<8:03:54, 92.76s/it]  31%|███       | 138/450 [2:32:09<7:20:27, 84.70s/it] 31%|███       | 139/450 [2:33:02<6:29:52, 75.22s/it] 31%|███       | 140/450 [2:34:06<6:12:15, 72.05s/it]                                                      31%|███       | 140/450 [2:34:06<6:12:15, 72.05s/it] 31%|███▏      | 141/450 [2:35:09<5:56:15, 69.17s/it] 32%|███▏      | 142/450 [2:36:12<5:45:12, 67.25s/it] 32%|███▏      | 143/450 [2:37:12<5:33:40, 65.21s/it] 32%|███▏      | 144/450 [2:38:18<5:32:58, 65.29s/it] 32%|███▏      | 145/450 [2:39:17<5:23:38, 63.67s/it] 32%|███▏      | 146/450 [2:40:23<5:25:35, 64.26s/it] 33%|███▎      | 147/450 [2:41:28<5:25:41, 64.49s/it] 33%|███▎      | 148/450 [2:42:35<5:28:03, 65.18s/it] 33%|███▎      | 149/450 [2:43:37<5:21:40, 64.12s/it] 33%|███▎      | 150/450 [2:44:43<5:24:02, 64.81s/it]                                                      33%|███▎      | 150/450 [2:44:43<5:24:02, 64.81s/it] 34%|███▎      | 151/450 [2:45:38<5:08:20, 61.87s/it] 34%|███▍      | 152/450 [2:46:36<5:00:58, 60.60s/it] 34%|███▍      | 153/450 [2:47:36<4:59:32, 60.51s/it] 34%|███▍      | 154/450 [2:48:55<5:26:29, 66.18s/it] 34%|███▍      | 155/450 [2:49:56<5:16:44, 64.42s/it] 35%|███▍      | 156/450 [2:50:51<5:01:56, 61.62s/it] 35%|███▍      | 157/450 [2:51:56<5:06:14, 62.71s/it] 35%|███▌      | 158/450 [2:52:56<5:00:44, 61.80s/it] 35%|███▌      | 159/450 [2:54:16<5:27:27, 67.52s/it] 36%|███▌      | 160/450 [2:55:12<5:08:52, 63.91s/it]                                                      36%|███▌      | 160/450 [2:55:12<5:08:52, 63.91s/it] 36%|███▌      | 161/450 [2:56:13<5:03:59, 63.11s/it] 36%|███▌      | 162/450 [2:57:19<5:06:19, 63.82s/it] 36%|███▌      | 163/450 [2:58:15<4:54:58, 61.67s/it] 36%|███▋      | 164/450 [2:59:20<4:58:54, 62.71s/it] 37%|███▋      | 165/450 [3:00:28<5:04:50, 64.18s/it] 37%|███▋      | 166/450 [3:01:30<5:00:39, 63.52s/it] 37%|███▋      | 167/450 [3:02:36<5:03:31, 64.35s/it] 37%|███▋      | 168/450 [3:03:32<4:50:43, 61.86s/it] 38%|███▊      | 169/450 [3:04:35<4:50:37, 62.05s/it] 38%|███▊      | 170/450 [3:05:38<4:50:22, 62.22s/it]                                                      38%|███▊      | 170/450 [3:05:38<4:50:22, 62.22s/it] 38%|███▊      | 171/450 [3:06:53<5:08:27, 66.34s/it] 38%|███▊      | 172/450 [3:07:54<4:59:43, 64.69s/it] 38%|███▊      | 173/450 [3:08:46<4:40:32, 60.77s/it]Killed
+ date +%s
+ run_id=1687636653
+ echo RUN ID: 
RUN ID: 
+ date
+ echo START TIME: Sat Jun 24 19:57:33 UTC 2023
START TIME: Sat Jun 24 19:57:33 UTC 2023
+ ROOT_DIR_BASE=/home/ubuntu/cloudfs/saved_models/qlora_cn
+ OUTPUT_PATH=/home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687636653
+ mkdir -p /home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687636653
+ python qlora_fact_encoder.py --dataset=/home/ubuntu/qlora/metacritics_fact_encoder_training_data.pickle --dataset_format=fact_encoder --learning_rate 0.0001 --per_device_train_batch_size 1 --gradient_accumulation_steps 16 --max_steps 450 --model_name_or_path timdettmers/guanaco-33b-merged --source_max_len 42 --target_max_len 2829 --eval_dataset_size 1 --do_eval --evaluation_strategy steps --eval_steps 45 --output_dir /home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687636653 --report_to wandb --sample_generate --save_steps 45 --train_on_source true --lora_r 256
2023-06-24 19:57:37.341200: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F AVX512_VNNI AVX512_BF16 AVX_VNNI
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-06-24 19:57:37.724040: I tensorflow/core/util/port.cc:104] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
--------------------------------------------------------------------------
WARNING: No preset parameters were found for the device that Open MPI
detected:

  Local host:            209-20-157-252
  Device name:           mlx5_0
  Device vendor ID:      0x02c9
  Device vendor part ID: 4122

Default device parameters will be used, which may result in lower
performance.  You can edit any of the files specified by the
btl_openib_device_param_files MCA parameter to set values for your
device.

NOTE: You can turn off this warning by setting the MCA parameter
      btl_openib_warn_no_device_params_found to 0.
--------------------------------------------------------------------------
--------------------------------------------------------------------------
No OpenFabrics connection schemes reported that they were able to be
used on a specific port.  As such, the openib BTL (OpenFabrics
support) will be disabled for this port.

  Local host:           209-20-157-252
  Local device:         mlx5_0
  Local port:           1
  CPCs attempted:       udcm
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Open MPI failed an OFI Libfabric library call (fi_domain).  This is highly
unusual; your job may behave unpredictably (and/or abort) after this.

  Local host: 209-20-157-252
  Location: mtl_ofi_component.c:610
  Error: No data available (61)
--------------------------------------------------------------------------

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /home/ubuntu/.local/lib/python3.8/site-packages/bitsandbytes/libbitsandbytes_cuda118.so
CUDA SETUP: CUDA runtime path found: /usr/lib/x86_64-linux-gnu/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 9.0
CUDA SETUP: Detected CUDA version 118
CUDA SETUP: Loading binary /home/ubuntu/.local/lib/python3.8/site-packages/bitsandbytes/libbitsandbytes_cuda118.so...
2023-06-24 19:57:42,967 [INFO] args: Namespace(__cached__setup_devices=device(type='cuda', index=0), _n_gpu=1, adafactor=False, adam8bit=False, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, auto_find_batch_size=False, bf16=False, bf16_full_eval=False, bits=4, cache_dir=None, data_seed=None, dataloader_drop_last=False, dataloader_num_workers=0, dataloader_pin_memory=True, dataset='/home/ubuntu/qlora/metacritics_fact_encoder_training_data.pickle', dataset_format='fact_encoder', ddp_backend=None, ddp_broadcast_buffers=None, ddp_bucket_cap_mb=None, ddp_find_unused_parameters=None, ddp_timeout=1800, debug=[], debug_mode=False, deepspeed=None, deepspeed_plugin=None, disable_tqdm=False, distributed_state=Distributed environment: NO
Num processes: 1
Process index: 0
Local process index: 0
Device: cuda
, do_eval=True, do_mmlu_eval=False, do_predict=False, do_train=True, double_quant=True, eval_accumulation_steps=None, eval_dataset_size=1, eval_delay=0, eval_steps=45, evaluation_strategy=<IntervalStrategy.STEPS: 'steps'>, fp16=False, fp16_backend='auto', fp16_full_eval=False, fp16_opt_level='O1', fsdp=[], fsdp_config={'fsdp_min_num_params': 0, 'xla': False, 'xla_fsdp_grad_ckpt': False}, fsdp_min_num_params=0, fsdp_transformer_layer_cls_to_wrap=None, full_determinism=False, full_finetune=False, generation_config=GenerationConfig {
  "max_new_tokens": 256,
  "transformers_version": "4.31.0.dev0"
}
, generation_max_length=None, generation_num_beams=None, gradient_accumulation_steps=16, gradient_checkpointing=True, greater_is_better=None, group_by_length=True, half_precision_backend='auto', hub_model_id=None, hub_private_repo=False, hub_strategy=<HubStrategy.EVERY_SAVE: 'every_save'>, hub_token=None, ignore_data_skip=False, include_inputs_for_metrics=False, jit_mode_eval=False, label_names=None, label_smoothing_factor=0.0, learning_rate=0.0001, length_column_name='length', load_best_model_at_end=False, local_rank=0, log_level='passive', log_level_replica='warning', log_on_each_node=True, logging_dir='/home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687636653/runs/Jun24_19-57-42_209-20-157-252', logging_first_step=False, logging_nan_inf_filter=True, logging_steps=10, logging_strategy=<IntervalStrategy.STEPS: 'steps'>, lora_alpha=16, lora_dropout=0.0, lora_r=256, lr_scheduler_type=<SchedulerType.CONSTANT: 'constant'>, max_eval_samples=None, max_grad_norm=0.3, max_memory_MB=80000, max_mmlu_samples=None, max_steps=450, max_train_samples=None, metric_for_best_model=None, mmlu_dataset='mmlu-fs', mmlu_source_max_len=2048, mmlu_split='eval', model_name_or_path='timdettmers/guanaco-33b-merged', mp_parameters='', no_cuda=False, num_train_epochs=3.0, optim=<OptimizerNames.PAGED_ADAMW: 'paged_adamw_32bit'>, optim_args=None, output_dir='/home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687636653', overwrite_output_dir=False, past_index=-1, per_device_eval_batch_size=8, per_device_train_batch_size=1, per_gpu_eval_batch_size=None, per_gpu_train_batch_size=None, predict_with_generate=False, prediction_loss_only=False, push_to_hub=False, push_to_hub_model_id=None, push_to_hub_organization=None, push_to_hub_token=None, quant_type='nf4', ray_scope='last', remove_unused_columns=False, report_to=['wandb'], resume_from_checkpoint=None, run_name='/home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687636653', sample_generate=True, save_on_each_node=False, save_safetensors=False, save_steps=45, save_strategy=<IntervalStrategy.STEPS: 'steps'>, save_total_limit=40, seed=42, sharded_ddp=[], skip_memory_metrics=True, sortish_sampler=False, source_max_len=42, target_max_len=2829, tf32=None, torch_compile=False, torch_compile_backend=None, torch_compile_mode=None, torchdynamo=None, tpu_metrics_debug=False, tpu_num_cores=None, train_on_source=True, trust_remote_code=False, use_ipex=False, use_legacy_prediction_loop=False, use_mps_device=False, warmup_ratio=0.03, warmup_steps=0, weight_decay=0.0, xpu_backend=None)
2023-06-24 19:57:42,967 [INFO] loading base model timdettmers/guanaco-33b-merged...
/home/ubuntu/.local/lib/python3.8/site-packages/pandas/core/computation/expressions.py:20: UserWarning: Pandas requires version '2.7.3' or newer of 'numexpr' (version '2.7.1' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:34<03:29, 34.93s/it]Loading checkpoint shards:  29%|██▊       | 2/7 [01:06<02:44, 32.90s/it]Loading checkpoint shards:  43%|████▎     | 3/7 [01:35<02:04, 31.24s/it]Loading checkpoint shards:  57%|█████▋    | 4/7 [02:04<01:30, 30.28s/it]Loading checkpoint shards:  71%|███████▏  | 5/7 [02:35<01:00, 30.49s/it]Loading checkpoint shards:  86%|████████▌ | 6/7 [03:06<00:30, 30.72s/it]Loading checkpoint shards: 100%|██████████| 7/7 [03:24<00:00, 26.40s/it]Loading checkpoint shards: 100%|██████████| 7/7 [03:24<00:00, 29.15s/it]2023-06-24 20:01:08,713 [INFO] adding LoRA modules...
2023-06-24 20:03:41,019 [INFO] trainable params: 975175680.0 || all params: 18428217856 || trainable: 5.2917525048820435
2023-06-24 20:03:41,019 [INFO] loaded model
2023-06-24 20:03:43,151 [INFO] Adding special tokens.
2023-06-24 20:03:43,165 [INFO] Splitting train dataset in train and validation according to `eval_dataset_size`

Map:   0%|          | 0/1 [00:00<?, ? examples/s]                                                 Map:   0%|          | 0/39 [00:00<?, ? examples/s]                                                  2023-06-24 20:03:43,186 [INFO] *** Train ***
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.8/logging/__init__.py", line 1085, in emit
    msg = self.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 929, in format
    return fmt.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 668, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.8/logging/__init__.py", line 373, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "qlora_fact_encoder.py", line 849, in <module>
    train()
  File "qlora_fact_encoder.py", line 803, in train
    logger.info(k, v, v/total)
Message: torch.float32
Arguments: (2377154048, 0.1289952370538876)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.8/logging/__init__.py", line 1085, in emit
    msg = self.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 929, in format
    return fmt.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 668, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.8/logging/__init__.py", line 373, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "qlora_fact_encoder.py", line 849, in <module>
    train()
  File "qlora_fact_encoder.py", line 803, in train
    logger.info(k, v, v/total)
Message: torch.float32
Arguments: (2377154048, 0.1289952370538876)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.8/logging/__init__.py", line 1085, in emit
    msg = self.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 929, in format
    return fmt.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 668, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.8/logging/__init__.py", line 373, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "qlora_fact_encoder.py", line 849, in <module>
    train()
  File "qlora_fact_encoder.py", line 803, in train
    logger.info(k, v, v/total)
Message: torch.uint8
Arguments: (16051077120, 0.8710047629461124)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.8/logging/__init__.py", line 1085, in emit
    msg = self.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 929, in format
    return fmt.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 668, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.8/logging/__init__.py", line 373, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "qlora_fact_encoder.py", line 849, in <module>
    train()
  File "qlora_fact_encoder.py", line 803, in train
    logger.info(k, v, v/total)
Message: torch.uint8
Arguments: (16051077120, 0.8710047629461124)
wandb: Currently logged in as: lyo-gavin. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/ubuntu/qlora/wandb/run-20230624_200345-si8ez9g7
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run woven-butterfly-102
wandb: ⭐️ View project at https://wandb.ai/lyo-gavin/huggingface
wandb: 🚀 View run at https://wandb.ai/lyo-gavin/huggingface/runs/si8ez9g7
  0%|          | 0/450 [00:00<?, ?it/s]  0%|          | 1/450 [01:06<8:18:39, 66.64s/it]  0%|          | 2/450 [02:09<8:02:00, 64.55s/it]  1%|          | 3/450 [03:29<8:53:50, 71.66s/it]  1%|          | 4/450 [04:35<8:35:33, 69.36s/it]  1%|          | 5/450 [05:37<8:13:35, 66.55s/it]  1%|▏         | 6/450 [06:48<8:24:17, 68.15s/it]  2%|▏         | 7/450 [07:44<7:53:16, 64.10s/it]  2%|▏         | 8/450 [08:49<7:54:48, 64.45s/it]  2%|▏         | 9/450 [09:59<8:05:25, 66.04s/it]  2%|▏         | 10/450 [11:09<8:14:36, 67.45s/it]                                                    2%|▏         | 10/450 [11:09<8:14:36, 67.45s/it]  2%|▏         | 11/450 [12:18<8:15:42, 67.75s/it]  3%|▎         | 12/450 [13:12<7:45:06, 63.71s/it]  3%|▎         | 13/450 [14:25<8:03:49, 66.43s/it]  3%|▎         | 14/450 [15:24<7:47:35, 64.35s/it]  3%|▎         | 15/450 [16:33<7:55:08, 65.54s/it]  4%|▎         | 16/450 [17:40<7:57:57, 66.08s/it]  4%|▍         | 17/450 [18:36<7:34:35, 62.99s/it]  4%|▍         | 18/450 [19:52<8:01:28, 66.87s/it]  4%|▍         | 19/450 [20:55<7:52:52, 65.83s/it]  4%|▍         | 20/450 [22:03<7:56:21, 66.47s/it]                                                    4%|▍         | 20/450 [22:03<7:56:21, 66.47s/it]  5%|▍         | 21/450 [23:04<7:43:42, 64.86s/it]  5%|▍         | 22/450 [24:06<7:35:39, 63.88s/it]  5%|▌         | 23/450 [25:09<7:32:29, 63.58s/it]  5%|▌         | 24/450 [26:12<7:32:03, 63.67s/it]  6%|▌         | 25/450 [27:19<7:38:12, 64.69s/it]  6%|▌         | 26/450 [28:31<7:52:32, 66.87s/it]  6%|▌         | 27/450 [29:36<7:47:26, 66.30s/it]  6%|▌         | 28/450 [30:40<7:40:17, 65.45s/it]  6%|▋         | 29/450 [31:43<7:33:49, 64.68s/it]  7%|▋         | 30/450 [32:54<7:46:51, 66.69s/it]                                                    7%|▋         | 30/450 [32:54<7:46:51, 66.69s/it]  7%|▋         | 31/450 [34:02<7:49:04, 67.17s/it]  7%|▋         | 32/450 [35:03<7:35:03, 65.32s/it]  7%|▋         | 33/450 [36:07<7:30:42, 64.85s/it]  8%|▊         | 34/450 [37:09<7:24:13, 64.07s/it]  8%|▊         | 35/450 [38:10<7:15:49, 63.01s/it]  8%|▊         | 36/450 [39:20<7:28:46, 65.04s/it]  8%|▊         | 37/450 [40:37<7:52:35, 68.66s/it]  8%|▊         | 38/450 [41:38<7:36:22, 66.46s/it]  9%|▊         | 39/450 [42:34<7:13:31, 63.29s/it]  9%|▉         | 40/450 [43:33<7:03:45, 62.01s/it]                                                    9%|▉         | 40/450 [43:33<7:03:45, 62.01s/it]  9%|▉         | 41/450 [44:42<7:16:19, 64.01s/it]  9%|▉         | 42/450 [45:56<7:36:20, 67.11s/it] 10%|▉         | 43/450 [47:04<7:37:40, 67.47s/it] 10%|▉         | 44/450 [48:09<7:31:03, 66.66s/it] 10%|█         | 45/450 [49:19<7:36:03, 67.56s/it]{'loss': 1.9697, 'learning_rate': 0.0001, 'epoch': 4.1}
{'loss': 1.3581, 'learning_rate': 0.0001, 'epoch': 8.21}
{'loss': 0.9168, 'learning_rate': 0.0001, 'epoch': 12.31}
{'loss': 0.5522, 'learning_rate': 0.0001, 'epoch': 16.41}

  0%|          | 0/1 [00:00<?, ?it/s][A                                                  
                                     [A 10%|█         | 45/450 [49:21<7:36:03, 67.56s/it]
100%|██████████| 1/1 [00:00<00:00, 33.88it/s][A
                                             [A{'eval_loss': 2.3348731994628906, 'eval_runtime': 1.7582, 'eval_samples_per_second': 0.569, 'eval_steps_per_second': 0.569, 'epoch': 18.46}
2023-06-24 20:53:07,506 [INFO] on_evaluate in SampleGenerateCallback...
2023-06-24 20:53:07,506 [INFO] sample input: Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:

2023-06-24 20:53:31,826 [INFO] sample output: <s>Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:
 Asteroid City, Wes Anderson’s 11th movie, is a play within a teleplay within a movie

The latest film from the writer-director of The French Dispatch is a meta-movie about storytelling.

Alissa Wilkinson

Senior critic

June 1
2023-06-24 20:53:31,827 [INFO] sample input: Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:

2023-06-24 20:53:55,918 [INFO] sample output: <s>Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:
 “Asteroid City” and the Stifling of the American Imagination
Wes Anderson’s new movie is a grim fable about the creative life in the United States.

I am not a Wes Anderson hater. I don’t dislike his movies; I don’t even find them
2023-06-24 20:53:55,919 [INFO] sample input: You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 
2023-06-24 20:54:20,028 [INFO] sample output: <s>You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 

From director Wes Anderson, "Asteroid City" is a star-studded action-comedy about a group of disparate characters who find themselves in the middle of nowhere after their plane is shot down. The cast includes Tom Hanks, Scarlett Johansson, Bryan Cranston, Steve Carell
2023-06-24 20:54:20,029 [INFO] sample input: Movie critic Michael Phillips's main view about the movie "asteroid city" are:
2023-06-24 20:54:44,144 [INFO] sample output: <s>Movie critic Michael Phillips's main view about the movie "asteroid city" are:

Asteroid City" is a movie about a place, a moment, a dream of a thing. That place is the fictional southwestern desert town of Asteroid City, pop. 87. The year is 1955. In a few weeks the U.S. government will detonate an
2023-06-24 20:54:44,145 [INFO] sample input: Overall speaking the mainstream opinion about the movie "asteroid city" are:
2023-06-24 20:55:08,250 [INFO] sample output: <s>Overall speaking the mainstream opinion about the movie "asteroid city" are:
Asteroid City is a movie that is based on a story written by a 6-year-old. The movie is about a group of kids who come together to stop an asteroid from destroying their city. The movie is quite enjoyable and the characters are quite likable. The movie is quite fun to watch and
2023-06-24 20:55:41,283 [INFO] Saving PEFT checkpoint...
 10%|█         | 46/450 [53:00<12:44:39, 113.56s/it] 10%|█         | 47/450 [54:14<11:24:20, 101.89s/it] 11%|█         | 48/450 [55:18<10:05:21, 90.35s/it]  11%|█         | 49/450 [56:20<9:08:01, 82.00s/it]  11%|█         | 50/450 [57:24<8:30:20, 76.55s/it]                                                   11%|█         | 50/450 [57:24<8:30:20, 76.55s/it] 11%|█▏        | 51/450 [58:26<8:00:21, 72.24s/it] 12%|█▏        | 52/450 [59:33<7:47:51, 70.53s/it] 12%|█▏        | 53/450 [1:00:38<7:35:17, 68.81s/it] 12%|█▏        | 54/450 [1:01:52<7:45:26, 70.52s/it] 12%|█▏        | 55/450 [1:03:01<7:39:53, 69.86s/it] 12%|█▏        | 56/450 [1:03:52<7:03:06, 64.43s/it] 13%|█▎        | 57/450 [1:05:05<7:18:47, 66.99s/it] 13%|█▎        | 58/450 [1:06:06<7:05:23, 65.11s/it] 13%|█▎        | 59/450 [1:07:14<7:09:56, 65.98s/it] 13%|█▎        | 60/450 [1:08:25<7:18:54, 67.52s/it]                                                     13%|█▎        | 60/450 [1:08:25<7:18:54, 67.52s/it] 14%|█▎        | 61/450 [1:09:21<6:56:07, 64.18s/it] 14%|█▍        | 62/450 [1:10:18<6:39:58, 61.85s/it] 14%|█▍        | 63/450 [1:11:27<6:52:29, 63.95s/it] 14%|█▍        | 64/450 [1:12:41<7:10:50, 66.97s/it] 14%|█▍        | 65/450 [1:13:52<7:17:25, 68.17s/it] 15%|█▍        | 66/450 [1:14:53<7:02:45, 66.06s/it] 15%|█▍        | 67/450 [1:15:59<7:02:02, 66.12s/it] 15%|█▌        | 68/450 [1:17:04<6:58:34, 65.74s/it] 15%|█▌        | 69/450 [1:18:10<6:57:15, 65.71s/it] 16%|█▌        | 70/450 [1:19:12<6:50:23, 64.80s/it]                                                     16%|█▌        | 70/450 [1:19:12<6:50:23, 64.80s/it] 16%|█▌        | 71/450 [1:20:25<7:04:30, 67.20s/it] 16%|█▌        | 72/450 [1:21:36<7:10:13, 68.29s/it] 16%|█▌        | 73/450 [1:22:26<6:34:49, 62.84s/it] 16%|█▋        | 74/450 [1:23:28<6:31:43, 62.51s/it] 17%|█▋        | 75/450 [1:24:33<6:35:38, 63.30s/it] 17%|█▋        | 76/450 [1:25:48<6:55:41, 66.69s/it] 17%|█▋        | 77/450 [1:26:53<6:52:20, 66.33s/it] 17%|█▋        | 78/450 [1:27:50<6:33:22, 63.45s/it] 18%|█▊        | 79/450 [1:28:57<6:39:37, 64.63s/it] 18%|█▊        | 80/450 [1:29:59<6:33:10, 63.76s/it]                                                     18%|█▊        | 80/450 [1:29:59<6:33:10, 63.76s/it] 18%|█▊        | 81/450 [1:31:16<6:57:13, 67.84s/it] 18%|█▊        | 82/450 [1:32:21<6:49:47, 66.81s/it] 18%|█▊        | 83/450 [1:33:23<6:40:41, 65.51s/it] 19%|█▊        | 84/450 [1:34:26<6:34:57, 64.75s/it] 19%|█▉        | 85/450 [1:35:31<6:34:08, 64.79s/it] 19%|█▉        | 86/450 [1:36:38<6:36:53, 65.42s/it] 19%|█▉        | 87/450 [1:37:42<6:32:46, 64.92s/it] 20%|█▉        | 88/450 [1:38:53<6:42:36, 66.73s/it] 20%|█▉        | 89/450 [1:40:03<6:48:36, 67.91s/it] 20%|██        | 90/450 [1:40:57<6:21:20, 63.56s/it]                                                     20%|██        | 90/450 [1:40:57<6:21:20, 63.56s/it]{'loss': 0.297, 'learning_rate': 0.0001, 'epoch': 20.51}
{'loss': 0.0995, 'learning_rate': 0.0001, 'epoch': 24.62}
{'loss': 0.0212, 'learning_rate': 0.0001, 'epoch': 28.72}
{'loss': 0.007, 'learning_rate': 0.0001, 'epoch': 32.82}
{'loss': 0.0045, 'learning_rate': 0.0001, 'epoch': 36.92}

  0%|          | 0/1 [00:00<?, ?it/s][A                                                    
                                     [A 20%|██        | 90/450 [1:40:58<6:21:20, 63.56s/it]
100%|██████████| 1/1 [00:00<00:00, 34.06it/s][A
                                             [A{'eval_loss': 2.720444440841675, 'eval_runtime': 1.7589, 'eval_samples_per_second': 0.569, 'eval_steps_per_second': 0.569, 'epoch': 36.92}
2023-06-24 21:44:45,288 [INFO] on_evaluate in SampleGenerateCallback...
2023-06-24 21:44:45,289 [INFO] sample input: Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:

2023-06-24 21:45:09,456 [INFO] sample output: <s>Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:
 Asteroid City, Wes Anderson’s new movie, is a crashing bore

If you asked an AI program to create a Wes Anderson movie, you’d get Asteroid City.

Alissa Wilkinson

Senior critic

June 15, 20235:
2023-06-24 21:45:09,456 [INFO] sample input: Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:

2023-06-24 21:45:33,553 [INFO] sample output: <s>Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:
 “Asteroid City,” Wes Anderson’s New Film, Is a Piece of 1950s Desert Americana
In this delightful movie, Anderson takes a back seat to a team of live-action filmmakers—and to his own artistic impulses.

By Richard BrodyJune
2023-06-24 21:45:33,554 [INFO] sample input: You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 
2023-06-24 21:45:57,649 [INFO] sample output: <s>You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 

From director Wes Anderson comes a film about a group of students at a Swiss boarding school who plot to murder their headmaster. The film is a crime caper with elements of dark humor and is based on a popular graphic novel of the same name. The film stars Jason Schwartzman, Scarlett Johansson,
2023-06-24 21:45:57,649 [INFO] sample input: Movie critic Michael Phillips's main view about the movie "asteroid city" are:
2023-06-24 21:46:21,735 [INFO] sample output: <s>Movie critic Michael Phillips's main view about the movie "asteroid city" are:

1. "Asteroid City" is a movie about a fictional story. The movie is set in a galaxy far, far away where a man named Augie Steenbeck (Jason Schwartzman) buys a piece of land on a desert planet to open a hotel. The hotel is near a cr
2023-06-24 21:46:21,735 [INFO] sample input: Overall speaking the mainstream opinion about the movie "asteroid city" are:
2023-06-24 21:46:45,836 [INFO] sample output: <s>Overall speaking the mainstream opinion about the movie "asteroid city" are:
Asteroid City is a movie that is based on a story written by a famous writer. The movie is a sci-fi movie and it is about a story that is set in the fictional city of Asteroid City, on a fictional asteroid. The movie is about a man who is a police inspector and he
2023-06-24 21:47:09,190 [INFO] Saving PEFT checkpoint...
 20%|██        | 91/450 [1:44:38<11:03:07, 110.83s/it] 20%|██        | 92/450 [1:45:47<9:46:04, 98.23s/it]   21%|██        | 93/450 [1:47:01<9:01:03, 90.93s/it] 21%|██        | 94/450 [1:48:06<8:14:05, 83.28s/it] 21%|██        | 95/450 [1:49:03<7:25:34, 75.31s/it] 21%|██▏       | 96/450 [1:50:13<7:15:10, 73.76s/it] 22%|██▏       | 97/450 [1:51:12<6:47:52, 69.33s/it] 22%|██▏       | 98/450 [1:52:29<7:01:30, 71.85s/it] 22%|██▏       | 99/450 [1:53:34<6:47:09, 69.60s/it] 22%|██▏       | 100/450 [1:54:31<6:24:22, 65.89s/it]                                                      22%|██▏       | 100/450 [1:54:31<6:24:22, 65.89s/it] 22%|██▏       | 101/450 [1:55:34<6:18:38, 65.10s/it] 23%|██▎       | 102/450 [1:56:38<6:15:55, 64.82s/it] 23%|██▎       | 103/450 [1:57:50<6:26:27, 66.82s/it] 23%|██▎       | 104/450 [1:58:56<6:24:25, 66.66s/it] 23%|██▎       | 105/450 [2:00:05<6:26:19, 67.19s/it] 24%|██▎       | 106/450 [2:01:17<6:33:14, 68.59s/it] 24%|██▍       | 107/450 [2:02:11<6:08:30, 64.46s/it] 24%|██▍       | 108/450 [2:03:16<6:06:58, 64.38s/it] 24%|██▍       | 109/450 [2:04:22<6:10:03, 65.11s/it] 24%|██▍       | 110/450 [2:05:30<6:13:09, 65.85s/it]                                                      24%|██▍       | 110/450 [2:05:30<6:13:09, 65.85s/it] 25%|██▍       | 111/450 [2:06:38<6:16:28, 66.63s/it] 25%|██▍       | 112/450 [2:07:37<6:01:04, 64.10s/it] 25%|██▌       | 113/450 [2:08:40<5:59:31, 64.01s/it] 25%|██▌       | 114/450 [2:09:55<6:16:33, 67.24s/it] 26%|██▌       | 115/450 [2:10:55<6:03:30, 65.11s/it] 26%|██▌       | 116/450 [2:12:03<6:06:45, 65.89s/it] 26%|██▌       | 117/450 [2:13:01<5:52:12, 63.46s/it] 26%|██▌       | 118/450 [2:14:10<6:00:44, 65.20s/it] 26%|██▋       | 119/450 [2:15:11<5:52:57, 63.98s/it] 27%|██▋       | 120/450 [2:16:23<6:05:24, 66.44s/it]                                                      27%|██▋       | 120/450 [2:16:23<6:05:24, 66.44s/it] 27%|██▋       | 121/450 [2:17:27<5:59:41, 65.60s/it] 27%|██▋       | 122/450 [2:18:36<6:03:27, 66.49s/it] 27%|██▋       | 123/450 [2:19:42<6:01:34, 66.34s/it] 28%|██▊       | 124/450 [2:20:41<5:48:44, 64.19s/it] 28%|██▊       | 125/450 [2:21:59<6:10:07, 68.33s/it] 28%|██▊       | 126/450 [2:23:00<5:56:50, 66.08s/it] 28%|██▊       | 127/450 [2:24:06<5:56:42, 66.26s/it] 28%|██▊       | 128/450 [2:25:09<5:50:35, 65.33s/it] 29%|██▊       | 129/450 [2:26:10<5:41:59, 63.92s/it]Killed
+ date +%s
+ run_id=1687645871
+ echo RUN ID: 
RUN ID: 
+ date
+ echo START TIME: Sat Jun 24 22:31:11 UTC 2023
START TIME: Sat Jun 24 22:31:11 UTC 2023
+ ROOT_DIR_BASE=/home/ubuntu/cloudfs/saved_models/qlora_cn
+ OUTPUT_PATH=/home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687645871
+ mkdir -p /home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687645871
+ python qlora_fact_encoder.py --dataset=/home/ubuntu/qlora/metacritics_fact_encoder_training_data_fixed_prompt.pickle --dataset_format=fact_encoder --learning_rate 0.0001 --per_device_train_batch_size 1 --gradient_accumulation_steps 16 --max_steps 450 --model_name_or_path timdettmers/guanaco-33b-merged --source_max_len 42 --target_max_len 2829 --eval_dataset_size 1 --do_eval --evaluation_strategy steps --eval_steps 45 --output_dir /home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687645871 --report_to wandb --sample_generate --save_steps 45 --train_on_source true --lora_r 256
2023-06-24 22:31:15.895942: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F AVX512_VNNI AVX512_BF16 AVX_VNNI
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-06-24 22:31:16.286112: I tensorflow/core/util/port.cc:104] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
--------------------------------------------------------------------------
WARNING: No preset parameters were found for the device that Open MPI
detected:

  Local host:            209-20-157-252
  Device name:           mlx5_0
  Device vendor ID:      0x02c9
  Device vendor part ID: 4122

Default device parameters will be used, which may result in lower
performance.  You can edit any of the files specified by the
btl_openib_device_param_files MCA parameter to set values for your
device.

NOTE: You can turn off this warning by setting the MCA parameter
      btl_openib_warn_no_device_params_found to 0.
--------------------------------------------------------------------------
--------------------------------------------------------------------------
No OpenFabrics connection schemes reported that they were able to be
used on a specific port.  As such, the openib BTL (OpenFabrics
support) will be disabled for this port.

  Local host:           209-20-157-252
  Local device:         mlx5_0
  Local port:           1
  CPCs attempted:       udcm
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Open MPI failed an OFI Libfabric library call (fi_domain).  This is highly
unusual; your job may behave unpredictably (and/or abort) after this.

  Local host: 209-20-157-252
  Location: mtl_ofi_component.c:610
  Error: No data available (61)
--------------------------------------------------------------------------

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /home/ubuntu/.local/lib/python3.8/site-packages/bitsandbytes/libbitsandbytes_cuda118.so
CUDA SETUP: CUDA runtime path found: /usr/lib/x86_64-linux-gnu/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 9.0
CUDA SETUP: Detected CUDA version 118
CUDA SETUP: Loading binary /home/ubuntu/.local/lib/python3.8/site-packages/bitsandbytes/libbitsandbytes_cuda118.so...
2023-06-24 22:31:21,469 [INFO] args: Namespace(__cached__setup_devices=device(type='cuda', index=0), _n_gpu=1, adafactor=False, adam8bit=False, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, auto_find_batch_size=False, bf16=False, bf16_full_eval=False, bits=4, cache_dir=None, data_seed=None, dataloader_drop_last=False, dataloader_num_workers=0, dataloader_pin_memory=True, dataset='/home/ubuntu/qlora/metacritics_fact_encoder_training_data_fixed_prompt.pickle', dataset_format='fact_encoder', ddp_backend=None, ddp_broadcast_buffers=None, ddp_bucket_cap_mb=None, ddp_find_unused_parameters=None, ddp_timeout=1800, debug=[], debug_mode=False, deepspeed=None, deepspeed_plugin=None, disable_tqdm=False, distributed_state=Distributed environment: NO
Num processes: 1
Process index: 0
Local process index: 0
Device: cuda
, do_eval=True, do_mmlu_eval=False, do_predict=False, do_train=True, double_quant=True, eval_accumulation_steps=None, eval_dataset_size=1, eval_delay=0, eval_steps=45, evaluation_strategy=<IntervalStrategy.STEPS: 'steps'>, fp16=False, fp16_backend='auto', fp16_full_eval=False, fp16_opt_level='O1', fsdp=[], fsdp_config={'fsdp_min_num_params': 0, 'xla': False, 'xla_fsdp_grad_ckpt': False}, fsdp_min_num_params=0, fsdp_transformer_layer_cls_to_wrap=None, full_determinism=False, full_finetune=False, generation_config=GenerationConfig {
  "max_new_tokens": 256,
  "transformers_version": "4.31.0.dev0"
}
, generation_max_length=None, generation_num_beams=None, gradient_accumulation_steps=16, gradient_checkpointing=True, greater_is_better=None, group_by_length=True, half_precision_backend='auto', hub_model_id=None, hub_private_repo=False, hub_strategy=<HubStrategy.EVERY_SAVE: 'every_save'>, hub_token=None, ignore_data_skip=False, include_inputs_for_metrics=False, jit_mode_eval=False, label_names=None, label_smoothing_factor=0.0, learning_rate=0.0001, length_column_name='length', load_best_model_at_end=False, local_rank=0, log_level='passive', log_level_replica='warning', log_on_each_node=True, logging_dir='/home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687645871/runs/Jun24_22-31-21_209-20-157-252', logging_first_step=False, logging_nan_inf_filter=True, logging_steps=10, logging_strategy=<IntervalStrategy.STEPS: 'steps'>, lora_alpha=16, lora_dropout=0.0, lora_r=256, lr_scheduler_type=<SchedulerType.CONSTANT: 'constant'>, max_eval_samples=None, max_grad_norm=0.3, max_memory_MB=80000, max_mmlu_samples=None, max_steps=450, max_train_samples=None, metric_for_best_model=None, mmlu_dataset='mmlu-fs', mmlu_source_max_len=2048, mmlu_split='eval', model_name_or_path='timdettmers/guanaco-33b-merged', mp_parameters='', no_cuda=False, num_train_epochs=3.0, optim=<OptimizerNames.PAGED_ADAMW: 'paged_adamw_32bit'>, optim_args=None, output_dir='/home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687645871', overwrite_output_dir=False, past_index=-1, per_device_eval_batch_size=8, per_device_train_batch_size=1, per_gpu_eval_batch_size=None, per_gpu_train_batch_size=None, predict_with_generate=False, prediction_loss_only=False, push_to_hub=False, push_to_hub_model_id=None, push_to_hub_organization=None, push_to_hub_token=None, quant_type='nf4', ray_scope='last', remove_unused_columns=False, report_to=['wandb'], resume_from_checkpoint=None, run_name='/home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687645871', sample_generate=True, save_on_each_node=False, save_safetensors=False, save_steps=45, save_strategy=<IntervalStrategy.STEPS: 'steps'>, save_total_limit=40, seed=42, sharded_ddp=[], skip_memory_metrics=True, sortish_sampler=False, source_max_len=42, target_max_len=2829, tf32=None, torch_compile=False, torch_compile_backend=None, torch_compile_mode=None, torchdynamo=None, tpu_metrics_debug=False, tpu_num_cores=None, train_on_source=True, trust_remote_code=False, use_ipex=False, use_legacy_prediction_loop=False, use_mps_device=False, warmup_ratio=0.03, warmup_steps=0, weight_decay=0.0, xpu_backend=None)
2023-06-24 22:31:21,471 [INFO] loading base model timdettmers/guanaco-33b-merged...
/home/ubuntu/.local/lib/python3.8/site-packages/pandas/core/computation/expressions.py:20: UserWarning: Pandas requires version '2.7.3' or newer of 'numexpr' (version '2.7.1' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:15<01:35, 15.85s/it]Loading checkpoint shards:  29%|██▊       | 2/7 [00:29<01:11, 14.28s/it]Loading checkpoint shards:  43%|████▎     | 3/7 [00:42<00:55, 13.83s/it]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:56<00:41, 13.88s/it]Loading checkpoint shards:  71%|███████▏  | 5/7 [01:10<00:28, 14.08s/it]Loading checkpoint shards:  86%|████████▌ | 6/7 [01:27<00:15, 15.12s/it]Loading checkpoint shards: 100%|██████████| 7/7 [01:37<00:00, 13.46s/it]Loading checkpoint shards: 100%|██████████| 7/7 [01:37<00:00, 13.99s/it]2023-06-24 22:33:01,070 [INFO] adding LoRA modules...
2023-06-24 22:35:32,664 [INFO] trainable params: 975175680.0 || all params: 18428217856 || trainable: 5.2917525048820435
2023-06-24 22:35:32,664 [INFO] loaded model
2023-06-24 22:35:34,767 [INFO] Adding special tokens.
2023-06-24 22:35:34,779 [INFO] Splitting train dataset in train and validation according to `eval_dataset_size`

Map:   0%|          | 0/1 [00:00<?, ? examples/s]                                                 Map:   0%|          | 0/39 [00:00<?, ? examples/s]                                                  2023-06-24 22:35:34,797 [INFO] *** Train ***
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.8/logging/__init__.py", line 1085, in emit
    msg = self.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 929, in format
    return fmt.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 668, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.8/logging/__init__.py", line 373, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "qlora_fact_encoder.py", line 849, in <module>
    train()
  File "qlora_fact_encoder.py", line 803, in train
    logger.info(k, v, v/total)
Message: torch.float32
Arguments: (2377154048, 0.1289952370538876)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.8/logging/__init__.py", line 1085, in emit
    msg = self.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 929, in format
    return fmt.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 668, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.8/logging/__init__.py", line 373, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "qlora_fact_encoder.py", line 849, in <module>
    train()
  File "qlora_fact_encoder.py", line 803, in train
    logger.info(k, v, v/total)
Message: torch.float32
Arguments: (2377154048, 0.1289952370538876)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.8/logging/__init__.py", line 1085, in emit
    msg = self.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 929, in format
    return fmt.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 668, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.8/logging/__init__.py", line 373, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "qlora_fact_encoder.py", line 849, in <module>
    train()
  File "qlora_fact_encoder.py", line 803, in train
    logger.info(k, v, v/total)
Message: torch.uint8
Arguments: (16051077120, 0.8710047629461124)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.8/logging/__init__.py", line 1085, in emit
    msg = self.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 929, in format
    return fmt.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 668, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.8/logging/__init__.py", line 373, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "qlora_fact_encoder.py", line 849, in <module>
    train()
  File "qlora_fact_encoder.py", line 803, in train
    logger.info(k, v, v/total)
Message: torch.uint8
Arguments: (16051077120, 0.8710047629461124)
wandb: Currently logged in as: lyo-gavin. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/ubuntu/qlora/wandb/run-20230624_223536-pnntqkyg
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run peach-bee-103
wandb: ⭐️ View project at https://wandb.ai/lyo-gavin/huggingface
wandb: 🚀 View run at https://wandb.ai/lyo-gavin/huggingface/runs/pnntqkyg
  0%|          | 0/450 [00:00<?, ?it/s]  0%|          | 1/450 [01:08<8:29:53, 68.14s/it]  0%|          | 2/450 [02:10<8:05:04, 64.97s/it]  1%|          | 3/450 [03:30<8:54:57, 71.81s/it]  1%|          | 4/450 [04:36<8:35:20, 69.33s/it]  1%|          | 5/450 [05:37<8:11:51, 66.32s/it]  1%|▏         | 6/450 [06:48<8:22:34, 67.92s/it]  2%|▏         | 7/450 [07:43<7:50:51, 63.77s/it]  2%|▏         | 8/450 [08:48<7:52:25, 64.13s/it]  2%|▏         | 9/450 [09:57<8:03:13, 65.74s/it]  2%|▏         | 10/450 [11:08<8:12:22, 67.14s/it]                                                    2%|▏         | 10/450 [11:08<8:12:22, 67.14s/it]  2%|▏         | 11/450 [12:16<8:13:18, 67.42s/it]  3%|▎         | 12/450 [13:10<7:42:54, 63.41s/it]  3%|▎         | 13/450 [14:22<8:01:39, 66.13s/it]  3%|▎         | 14/450 [15:21<7:45:26, 64.05s/it]  3%|▎         | 15/450 [16:29<7:52:25, 65.16s/it]  4%|▎         | 16/450 [17:36<7:55:13, 65.70s/it]  4%|▍         | 17/450 [18:32<7:32:23, 62.69s/it]  4%|▍         | 18/450 [19:48<7:59:44, 66.63s/it]  4%|▍         | 19/450 [20:51<7:50:41, 65.53s/it]  4%|▍         | 20/450 [21:58<7:53:30, 66.07s/it]                                                    4%|▍         | 20/450 [21:58<7:53:30, 66.07s/it]  5%|▍         | 21/450 [22:59<7:40:54, 64.46s/it]  5%|▍         | 22/450 [24:00<7:33:36, 63.59s/it]  5%|▌         | 23/450 [25:03<7:30:44, 63.34s/it]  5%|▌         | 24/450 [26:06<7:29:35, 63.32s/it]  6%|▌         | 25/450 [27:13<7:36:07, 64.39s/it]  6%|▌         | 26/450 [28:25<7:50:38, 66.60s/it]  6%|▌         | 27/450 [29:29<7:45:06, 65.97s/it]  6%|▌         | 28/450 [30:33<7:38:03, 65.13s/it]  6%|▋         | 29/450 [31:35<7:31:29, 64.35s/it]  7%|▋         | 30/450 [32:46<7:44:40, 66.38s/it]                                                    7%|▋         | 30/450 [32:46<7:44:40, 66.38s/it]  7%|▋         | 31/450 [33:54<7:46:51, 66.85s/it]  7%|▋         | 32/450 [34:55<7:32:40, 64.98s/it]  7%|▋         | 33/450 [35:58<7:28:45, 64.57s/it]  8%|▊         | 34/450 [37:00<7:22:02, 63.76s/it]  8%|▊         | 35/450 [38:00<7:13:39, 62.70s/it]  8%|▊         | 36/450 [39:10<7:26:28, 64.71s/it]  8%|▊         | 37/450 [40:27<7:50:29, 68.35s/it]  8%|▊         | 38/450 [41:28<7:34:47, 66.23s/it]  9%|▊         | 39/450 [42:24<7:11:39, 63.02s/it]  9%|▉         | 40/450 [43:22<7:02:08, 61.78s/it]                                                    9%|▉         | 40/450 [43:22<7:02:08, 61.78s/it]  9%|▉         | 41/450 [44:31<7:14:40, 63.77s/it]  9%|▉         | 42/450 [45:45<7:34:29, 66.84s/it] 10%|▉         | 43/450 [46:53<7:36:02, 67.23s/it] 10%|▉         | 44/450 [47:57<7:28:53, 66.34s/it] 10%|█         | 45/450 [49:07<7:34:02, 67.27s/it]{'loss': 1.9685, 'learning_rate': 0.0001, 'epoch': 4.1}
{'loss': 1.3546, 'learning_rate': 0.0001, 'epoch': 8.21}
{'loss': 0.9143, 'learning_rate': 0.0001, 'epoch': 12.31}
{'loss': 0.552, 'learning_rate': 0.0001, 'epoch': 16.41}

  0%|          | 0/1 [00:00<?, ?it/s][A                                                  
                                     [A 10%|█         | 45/450 [49:08<7:34:02, 67.27s/it]
100%|██████████| 1/1 [00:00<00:00, 33.56it/s][A
                                             [A{'eval_loss': 2.326383590698242, 'eval_runtime': 1.7925, 'eval_samples_per_second': 0.558, 'eval_steps_per_second': 0.558, 'epoch': 18.46}
2023-06-24 23:24:46,749 [INFO] on_evaluate in SampleGenerateCallback...
2023-06-24 23:24:46,749 [INFO] sample input: Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:

2023-06-24 23:25:10,810 [INFO] sample output: <s>Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:
 Asteroid City, Wes Anderson’s 11th movie, is a heart-stirring delight

The film makes a strong case that art can convey feelings that even its creators don’t understand.

Alissa Wilkinson

Senior critic

June 15, 20
2023-06-24 23:25:10,810 [INFO] sample input: Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:

2023-06-24 23:25:34,787 [INFO] sample output: <s>Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:
Wes Anderson’s “Asteroid City”: A Spacey Surface
The film’s quirky setting and stellar cast, which includes Jason Schwartzman, Tom Hanks, and Scarlett Johansson, cannot redeem its languid incoherence.

I am not
2023-06-24 23:25:34,788 [INFO] sample input: You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 
2023-06-24 23:25:58,756 [INFO] sample output: <s>You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 

asteroid city

A woman (Scarlett Johansson) and a group of children living in an underground bunker in the American Southwest make a grisly discovery.





























2023-06-24 23:25:58,757 [INFO] sample input: Movie critic Michael Phillips's main view about the movie "asteroid city" are:
2023-06-24 23:26:22,728 [INFO] sample output: <s>Movie critic Michael Phillips's main view about the movie "asteroid city" are:
Asteroid City" is a movie about a movie, and a movie about a play, and a movie about a television show, and a movie about a graphic novel, and a movie about the people who make all of the above. It's a movie about the interlocking, overlapping, often toxic inter
2023-06-24 23:26:22,728 [INFO] sample input: Overall speaking the mainstream opinion about the movie "asteroid city" are:
2023-06-24 23:26:46,700 [INFO] sample output: <s>Overall speaking the mainstream opinion about the movie "asteroid city" are:
Asteroid City is a movie about a group of young people who come together to attend a music festival in the desert. The movie is about the characters and their lives. The movie is about the characters and their lives.
The movie is about the characters and their lives. The movie is about the characters and their lives. The movie
2023-06-24 23:27:14,738 [INFO] Saving PEFT checkpoint...
 10%|█         | 46/450 [52:42<12:32:07, 111.70s/it] 10%|█         | 47/450 [53:56<11:15:09, 100.52s/it] 11%|█         | 48/450 [55:00<9:59:02, 89.41s/it]   11%|█         | 49/450 [56:02<9:03:19, 81.30s/it] 11%|█         | 50/450 [57:06<8:26:40, 76.00s/it]                                                   11%|█         | 50/450 [57:06<8:26:40, 76.00s/it] 11%|█▏        | 51/450 [58:08<7:57:33, 71.81s/it] 12%|█▏        | 52/450 [59:14<7:45:32, 70.18s/it] 12%|█▏        | 53/450 [1:00:19<7:33:46, 68.58s/it] 12%|█▏        | 54/450 [1:01:34<7:44:05, 70.32s/it] 12%|█▏        | 55/450 [1:02:42<7:38:36, 69.66s/it] 12%|█▏        | 56/450 [1:03:33<7:01:58, 64.26s/it] 13%|█▎        | 57/450 [1:04:46<7:17:11, 66.75s/it] 13%|█▎        | 58/450 [1:05:47<7:04:16, 64.94s/it] 13%|█▎        | 59/450 [1:06:55<7:09:02, 65.84s/it] 13%|█▎        | 60/450 [1:08:06<7:17:53, 67.37s/it]                                                     13%|█▎        | 60/450 [1:08:06<7:17:53, 67.37s/it] 14%|█▎        | 61/450 [1:09:02<6:55:02, 64.02s/it] 14%|█▍        | 62/450 [1:09:58<6:38:33, 61.63s/it] 14%|█▍        | 63/450 [1:11:07<6:51:14, 63.76s/it] 14%|█▍        | 64/450 [1:12:21<7:09:58, 66.84s/it] 14%|█▍        | 65/450 [1:13:31<7:16:36, 68.04s/it] 15%|█▍        | 66/450 [1:14:32<7:01:16, 65.82s/it] 15%|█▍        | 67/450 [1:15:38<7:01:08, 65.97s/it] 15%|█▌        | 68/450 [1:16:43<6:57:31, 65.58s/it] 15%|█▌        | 69/450 [1:17:48<6:55:58, 65.51s/it] 16%|█▌        | 70/450 [1:18:51<6:49:18, 64.63s/it]                                                     16%|█▌        | 70/450 [1:18:51<6:49:18, 64.63s/it] 16%|█▌        | 71/450 [1:20:03<7:03:04, 66.98s/it] 16%|█▌        | 72/450 [1:21:14<7:08:39, 68.04s/it] 16%|█▌        | 73/450 [1:22:04<6:33:56, 62.70s/it] 16%|█▋        | 74/450 [1:23:06<6:30:46, 62.36s/it] 17%|█▋        | 75/450 [1:24:11<6:34:58, 63.20s/it] 17%|█▋        | 76/450 [1:25:25<6:55:13, 66.61s/it] 17%|█▋        | 77/450 [1:26:31<6:52:08, 66.30s/it] 17%|█▋        | 78/450 [1:27:28<6:32:55, 63.37s/it] 18%|█▊        | 79/450 [1:28:35<6:38:33, 64.46s/it] 18%|█▊        | 80/450 [1:29:36<6:32:20, 63.62s/it]                                                     18%|█▊        | 80/450 [1:29:36<6:32:20, 63.62s/it] 18%|█▊        | 81/450 [1:30:54<6:56:30, 67.73s/it] 18%|█▊        | 82/450 [1:31:58<6:49:11, 66.72s/it] 18%|█▊        | 83/450 [1:33:00<6:40:12, 65.43s/it] 19%|█▊        | 84/450 [1:34:03<6:34:26, 64.66s/it] 19%|█▉        | 85/450 [1:35:08<6:33:26, 64.67s/it] 19%|█▉        | 86/450 [1:36:15<6:36:10, 65.30s/it] 19%|█▉        | 87/450 [1:37:18<6:32:04, 64.80s/it] 20%|█▉        | 88/450 [1:38:29<6:41:43, 66.59s/it] 20%|█▉        | 89/450 [1:39:40<6:47:47, 67.78s/it] 20%|██        | 90/450 [1:40:33<6:20:32, 63.42s/it]                                                     20%|██        | 90/450 [1:40:33<6:20:32, 63.42s/it]{'loss': 0.3037, 'learning_rate': 0.0001, 'epoch': 20.51}
{'loss': 0.1082, 'learning_rate': 0.0001, 'epoch': 24.62}
{'loss': 0.0217, 'learning_rate': 0.0001, 'epoch': 28.72}
{'loss': 0.0068, 'learning_rate': 0.0001, 'epoch': 32.82}
{'loss': 0.0044, 'learning_rate': 0.0001, 'epoch': 36.92}

  0%|          | 0/1 [00:00<?, ?it/s][A                                                    
                                     [A 20%|██        | 90/450 [1:40:35<6:20:32, 63.42s/it]
100%|██████████| 1/1 [00:00<00:00, 33.50it/s][A
                                             [A{'eval_loss': 2.71419358253479, 'eval_runtime': 1.7933, 'eval_samples_per_second': 0.558, 'eval_steps_per_second': 0.558, 'epoch': 36.92}
2023-06-25 00:16:12,957 [INFO] on_evaluate in SampleGenerateCallback...
2023-06-25 00:16:12,958 [INFO] sample input: Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:

2023-06-25 00:16:36,990 [INFO] sample output: <s>Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:
 Asteroid City, Wes Anderson’s new movie, is a crashing bore

Alissa Wilkinson

Alissa Wilkinson

Scarlett Johansson in Asteroid City.


Near the beginning of Asteroid City, the latest film from Wes Anderson, a young man named Aug
2023-06-25 00:16:36,991 [INFO] sample input: Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:

2023-06-25 00:17:00,957 [INFO] sample output: <s>Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:
 “Asteroid City,” Wes Anderson’s New Film, Is a Piece of 1950s Desert Americana That’s Visually Dazzling and Dramatically Inert
The film, which premiered at the Cannes Film Festival, is a collection of discrete little worlds—and characters—that
2023-06-25 00:17:00,957 [INFO] sample input: You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 
2023-06-25 00:17:24,924 [INFO] sample output: <s>You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city":  a movie about a group of teenagers who go on a road trip to the fictional city "asteroid city" to find a rare artifact that is worth a lot of money.

This movie review should be at least 300 words and include a detailed plot summary, an analysis of the movie’s strengths and weak
2023-06-25 00:17:24,924 [INFO] sample input: Movie critic Michael Phillips's main view about the movie "asteroid city" are:
2023-06-25 00:17:48,893 [INFO] sample output: <s>Movie critic Michael Phillips's main view about the movie "asteroid city" are:
Wes Anderson's "Asteroid City" is a movie about grief that dares to be funny, and a movie about fatherhood that dares to be hopeful. It's also a movie about storytelling itself, and how we invent characters and situations as a way of coping with the unexpected turns
2023-06-25 00:17:48,893 [INFO] sample input: Overall speaking the mainstream opinion about the movie "asteroid city" are:
2023-06-25 00:18:12,863 [INFO] sample output: <s>Overall speaking the mainstream opinion about the movie "asteroid city" are:
Asteroid City is a movie about a group of students who go to a science competition in a fictional city in the middle of the desert. The movie is based on a popular chinese web novel, and it is the first movie of a trilogy.
The movie is very popular in China, and it is the 
2023-06-25 00:18:34,172 [INFO] Saving PEFT checkpoint...
 20%|██        | 91/450 [1:44:06<10:49:02, 108.47s/it] 20%|██        | 92/450 [1:45:15<9:36:03, 96.55s/it]   21%|██        | 93/450 [1:46:29<8:53:40, 89.69s/it] 21%|██        | 94/450 [1:47:34<8:08:30, 82.33s/it] 21%|██        | 95/450 [1:48:31<7:22:03, 74.71s/it] 21%|██▏       | 96/450 [1:49:41<7:12:27, 73.30s/it] 22%|██▏       | 97/450 [1:50:40<6:45:45, 68.97s/it] 22%|██▏       | 98/450 [1:51:57<6:59:46, 71.55s/it] 22%|██▏       | 99/450 [1:53:02<6:45:51, 69.38s/it] 22%|██▏       | 100/450 [1:53:59<6:23:33, 65.75s/it]                                                      22%|██▏       | 100/450 [1:53:59<6:23:33, 65.75s/it] 22%|██▏       | 101/450 [1:55:02<6:17:31, 64.90s/it] 23%|██▎       | 102/450 [1:56:06<6:14:25, 64.56s/it] 23%|██▎       | 103/450 [1:57:17<6:25:20, 66.63s/it] 23%|██▎       | 104/450 [1:58:23<6:23:20, 66.48s/it] 23%|██▎       | 105/450 [1:59:31<6:25:14, 67.00s/it] 24%|██▎       | 106/450 [2:00:43<6:32:16, 68.42s/it] 24%|██▍       | 107/450 [2:01:38<6:07:25, 64.27s/it] 24%|██▍       | 108/450 [2:02:42<6:05:35, 64.14s/it] 24%|██▍       | 109/450 [2:03:49<6:09:17, 64.98s/it] 24%|██▍       | 110/450 [2:04:56<6:11:50, 65.62s/it]                                                      24%|██▍       | 110/450 [2:04:56<6:11:50, 65.62s/it] 25%|██▍       | 111/450 [2:06:04<6:15:27, 66.45s/it] 25%|██▍       | 112/450 [2:07:02<6:00:05, 63.92s/it] 25%|██▌       | 113/450 [2:08:06<5:58:09, 63.77s/it] 25%|██▌       | 114/450 [2:09:20<6:15:16, 67.01s/it] 26%|██▌       | 115/450 [2:10:20<6:02:10, 64.87s/it] 26%|██▌       | 116/450 [2:11:28<6:05:41, 65.69s/it] 26%|██▌       | 117/450 [2:12:25<5:51:04, 63.26s/it] 26%|██▌       | 118/450 [2:13:34<5:59:34, 64.98s/it] 26%|██▋       | 119/450 [2:14:35<5:52:06, 63.83s/it] 27%|██▋       | 120/450 [2:15:47<6:04:49, 66.33s/it]                                                      27%|██▋       | 120/450 [2:15:47<6:04:49, 66.33s/it] 27%|██▋       | 121/450 [2:16:51<5:58:52, 65.45s/it] 27%|██▋       | 122/450 [2:17:59<6:02:11, 66.25s/it] 27%|██▋       | 123/450 [2:19:05<6:00:41, 66.18s/it] 28%|██▊       | 124/450 [2:20:04<5:47:54, 64.03s/it] 28%|██▊       | 125/450 [2:21:22<6:09:10, 68.16s/it] 28%|██▊       | 126/450 [2:22:22<5:55:51, 65.90s/it] 28%|██▊       | 127/450 [2:23:29<5:55:22, 66.01s/it] 28%|██▊       | 128/450 [2:24:31<5:49:01, 65.04s/it] 29%|██▊       | 129/450 [2:25:32<5:41:03, 63.75s/it] 29%|██▉       | 130/450 [2:26:39<5:44:14, 64.55s/it]                                                      29%|██▉       | 130/450 [2:26:39<5:44:14, 64.55s/it] 29%|██▉       | 131/450 [2:27:46<5:48:29, 65.55s/it] 29%|██▉       | 132/450 [2:28:53<5:48:52, 65.83s/it] 30%|██▉       | 133/450 [2:30:01<5:51:13, 66.48s/it] 30%|██▉       | 134/450 [2:30:57<5:33:24, 63.31s/it] 30%|███       | 135/450 [2:32:03<5:37:01, 64.19s/it]{'loss': 0.0038, 'learning_rate': 0.0001, 'epoch': 41.03}
{'loss': 0.0035, 'learning_rate': 0.0001, 'epoch': 45.13}
{'loss': 0.0034, 'learning_rate': 0.0001, 'epoch': 49.23}
{'loss': 0.0033, 'learning_rate': 0.0001, 'epoch': 53.33}

  0%|          | 0/1 [00:00<?, ?it/s][A                                                     
                                     [A 30%|███       | 135/450 [2:32:05<5:37:01, 64.19s/it]
100%|██████████| 1/1 [00:00<00:00, 33.09it/s][A
                                             [A{'eval_loss': 2.768937587738037, 'eval_runtime': 1.792, 'eval_samples_per_second': 0.558, 'eval_steps_per_second': 0.558, 'epoch': 55.38}
2023-06-25 01:07:43,233 [INFO] on_evaluate in SampleGenerateCallback...
2023-06-25 01:07:43,233 [INFO] sample input: Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:

2023-06-25 01:08:07,296 [INFO] sample output: <s>Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:
 Asteroid City, Wes Anderson’s new movie, is a crashing bore

Alissa Wilkinson

Alissa Wilkinson

Scarlett Johansson in Asteroid City.


Image: Courtesy of Pop. 87 Productions/Focus Features

Wes Anderson
2023-06-25 01:08:07,296 [INFO] sample input: Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:

2023-06-25 01:08:31,277 [INFO] sample output: <s>Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:
 “Asteroid City,” Wes Anderson’s New Film, Is a Piece of 1950s Desert Americana That’s Visually Dazzling and Dramatically Inert
The film, which premiered at the Cannes Film Festival, stars Jason Schwartzman, Tom Hanks, Scar
2023-06-25 01:08:31,278 [INFO] sample input: You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 
2023-06-25 01:08:55,265 [INFO] sample output: <s>You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city":  a movie about a group of teenagers who go on a road trip to the fictional city "asteroid city" to find a rare artifact that is worth a lot of money.

This movie review should be at least 300 words and include a detailed plot summary, an analysis of the movie’s strengths and weak
2023-06-25 01:08:55,266 [INFO] sample input: Movie critic Michael Phillips's main view about the movie "asteroid city" are:
2023-06-25 01:09:19,282 [INFO] sample output: <s>Movie critic Michael Phillips's main view about the movie "asteroid city" are:
Wes Anderson’s ‘Asteroid City’ is a star-filled, gorgeous, dysfunctional train wreck
Wes Anderson’s latest mirage, “Asteroid City,” is a movie about a movie, sort of. It’s also about a family, and a town,
2023-06-25 01:09:19,282 [INFO] sample input: Overall speaking the mainstream opinion about the movie "asteroid city" are:
2023-06-25 01:09:43,254 [INFO] sample output: <s>Overall speaking the mainstream opinion about the movie "asteroid city" are:
Asteroid City is a movie about a group of students who go on a field trip to the desert. One of the students is a photographer and he is trying to take a picture of a rare meteorite. But then aliens come and abduct him and his friends have to go and rescue him. The movie is kind of
2023-06-25 01:10:07,329 [INFO] Saving PEFT checkpoint...
 30%|███       | 136/450 [2:35:50<9:51:04, 112.95s/it] 30%|███       | 137/450 [2:36:58<8:39:05, 99.51s/it]  31%|███       | 138/450 [2:38:06<7:48:21, 90.07s/it] 31%|███       | 139/450 [2:39:01<6:52:21, 79.55s/it] 31%|███       | 140/450 [2:40:08<6:31:03, 75.69s/it]                                                      31%|███       | 140/450 [2:40:08<6:31:03, 75.69s/it] 31%|███▏      | 141/450 [2:41:13<6:13:01, 72.43s/it] 32%|███▏      | 142/450 [2:42:17<6:00:06, 70.15s/it] 32%|███▏      | 143/450 [2:43:20<5:47:03, 67.83s/it] 32%|███▏      | 144/450 [2:44:27<5:45:24, 67.73s/it] 32%|███▏      | 145/450 [2:45:29<5:35:36, 66.02s/it] 32%|███▏      | 146/450 [2:46:37<5:37:16, 66.57s/it] 33%|███▎      | 147/450 [2:47:44<5:36:46, 66.69s/it] 33%|███▎      | 148/450 [2:48:53<5:39:09, 67.38s/it] 33%|███▎      | 149/450 [2:49:57<5:32:14, 66.23s/it] 33%|███▎      | 150/450 [2:51:05<5:34:32, 66.91s/it]                                                      33%|███▎      | 150/450 [2:51:05<5:34:32, 66.91s/it] 34%|███▎      | 151/450 [2:52:02<5:18:40, 63.95s/it] 34%|███▍      | 152/450 [2:53:02<5:10:43, 62.56s/it] 34%|███▍      | 153/450 [2:54:04<5:09:30, 62.53s/it] 34%|███▍      | 154/450 [2:55:26<5:36:45, 68.26s/it] 34%|███▍      | 155/450 [2:56:28<5:26:25, 66.39s/it] 35%|███▍      | 156/450 [2:57:25<5:11:22, 63.55s/it] 35%|███▍      | 157/450 [2:58:32<5:15:39, 64.64s/it] 35%|███▌      | 158/450 [2:59:33<5:09:55, 63.68s/it] 35%|███▌      | 159/450 [3:00:57<5:37:30, 69.59s/it] 36%|███▌      | 160/450 [3:01:54<5:18:20, 65.86s/it]                                                      36%|███▌      | 160/450 [3:01:54<5:18:20, 65.86s/it] 36%|███▌      | 161/450 [3:02:57<5:13:09, 65.02s/it] 36%|███▌      | 162/450 [3:04:04<5:15:44, 65.78s/it] 36%|███▌      | 163/450 [3:05:03<5:04:17, 63.61s/it] 36%|███▋      | 164/450 [3:06:10<5:08:05, 64.63s/it] 37%|███▋      | 165/450 [3:07:20<5:14:25, 66.19s/it] 37%|███▋      | 166/450 [3:08:24<5:10:11, 65.53s/it] 37%|███▋      | 167/450 [3:09:32<5:13:07, 66.39s/it] 37%|███▋      | 168/450 [3:10:30<4:59:33, 63.74s/it] 38%|███▊      | 169/450 [3:11:34<4:59:41, 63.99s/it] 38%|███▊      | 170/450 [3:12:39<4:59:36, 64.20s/it]                                                      38%|███▊      | 170/450 [3:12:39<4:59:36, 64.20s/it] 38%|███▊      | 171/450 [3:13:57<5:17:30, 68.28s/it] 38%|███▊      | 172/450 [3:15:00<5:08:50, 66.65s/it] 38%|███▊      | 173/450 [3:15:53<4:49:11, 62.64s/it] 39%|███▊      | 174/450 [3:16:59<4:52:56, 63.68s/it] 39%|███▉      | 175/450 [3:17:58<4:44:58, 62.18s/it] 39%|███▉      | 176/450 [3:19:21<5:13:02, 68.55s/it] 39%|███▉      | 177/450 [3:20:25<5:05:14, 67.09s/it] 40%|███▉      | 178/450 [3:21:21<4:49:30, 63.86s/it] 40%|███▉      | 179/450 [3:22:27<4:51:23, 64.51s/it] 40%|████      | 180/450 [3:23:32<4:50:57, 64.66s/it]                                                      40%|████      | 180/450 [3:23:32<4:50:57, 64.66s/it]{'loss': 0.0033, 'learning_rate': 0.0001, 'epoch': 57.44}
{'loss': 0.0032, 'learning_rate': 0.0001, 'epoch': 61.54}
{'loss': 0.0032, 'learning_rate': 0.0001, 'epoch': 65.64}
{'loss': 0.0031, 'learning_rate': 0.0001, 'epoch': 69.74}
{'loss': 0.0032, 'learning_rate': 0.0001, 'epoch': 73.85}

  0%|          | 0/1 [00:00<?, ?it/s][A                                                     
                                     [A 40%|████      | 180/450 [3:23:34<4:50:57, 64.66s/it]
100%|██████████| 1/1 [00:00<00:00, 33.78it/s][A
                                             [A{'eval_loss': 2.7911875247955322, 'eval_runtime': 1.7923, 'eval_samples_per_second': 0.558, 'eval_steps_per_second': 0.558, 'epoch': 73.85}
2023-06-25 01:59:12,216 [INFO] on_evaluate in SampleGenerateCallback...
2023-06-25 01:59:12,217 [INFO] sample input: Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:

2023-06-25 01:59:36,241 [INFO] sample output: <s>Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:
 Asteroid City, Wes Anderson’s new movie, is a crashing bore

Alissa Wilkinson

Alissa Wilkinson

Scarlett Johansson in Asteroid City.


Image: Courtesy of Pop. 87 Productions/Focus Features

Wes Anderson
2023-06-25 01:59:36,241 [INFO] sample input: Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:

2023-06-25 02:00:00,212 [INFO] sample output: <s>Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:
 “Asteroid City,” Wes Anderson’s New Film, Is a Piece of 1950s Desert Americana That’s Visually Dazzling and Dramatically Inert
The film, which premiered at the Cannes Film Festival, stars Jason Schwartzman, Scarlett Johansson
2023-06-25 02:00:00,212 [INFO] sample input: You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 
2023-06-25 02:00:24,184 [INFO] sample output: <s>You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city":  a movie about a group of teenagers who go on a road trip to the fictional city "asteroid city" to find a rare artifact that is worth a lot of money.

This movie review should be at least 300 words and include a detailed plot summary, an analysis of the movie’s strengths and weak
2023-06-25 02:00:24,185 [INFO] sample input: Movie critic Michael Phillips's main view about the movie "asteroid city" are:
2023-06-25 02:00:48,150 [INFO] sample output: <s>Movie critic Michael Phillips's main view about the movie "asteroid city" are:
Wes Anderson’s ‘Asteroid City’ is a star-filled, gorgeous, dysfunctional train wreck
Wes Anderson’s latest mirage, “Asteroid City,” is a movie about a movie, sort of. It’s also about a family, and a town,
2023-06-25 02:00:48,151 [INFO] sample input: Overall speaking the mainstream opinion about the movie "asteroid city" are:
2023-06-25 02:01:12,133 [INFO] sample output: <s>Overall speaking the mainstream opinion about the movie "asteroid city" are:
Asteroid City is a movie about a group of students who go on a school trip to a fictional city in Japan known for its asteroid crater. The movie is based on a stage play of the same name written by Japanese playwright Oriza Hirata. The movie was released on 23 June 20
2023-06-25 02:01:35,204 [INFO] Saving PEFT checkpoint...
 40%|████      | 181/450 [3:27:19<8:28:15, 113.37s/it] 40%|████      | 182/450 [3:28:25<7:22:09, 98.99s/it]  41%|████      | 183/450 [3:29:29<6:33:52, 88.51s/it] 41%|████      | 184/450 [3:30:33<6:00:22, 81.29s/it] 41%|████      | 185/450 [3:31:35<5:33:33, 75.52s/it] 41%|████▏     | 186/450 [3:32:49<5:29:57, 74.99s/it] 42%|████▏     | 187/450 [3:33:49<5:09:26, 70.60s/it] 42%|████▏     | 188/450 [3:34:54<5:00:30, 68.82s/it] 42%|████▏     | 189/450 [3:35:58<4:52:59, 67.35s/it] 42%|████▏     | 190/450 [3:37:00<4:44:58, 65.76s/it]                                                      42%|████▏     | 190/450 [3:37:00<4:44:58, 65.76s/it] 42%|████▏     | 191/450 [3:38:15<4:55:46, 68.52s/it] 43%|████▎     | 192/450 [3:39:18<4:47:30, 66.86s/it] 43%|████▎     | 193/450 [3:40:23<4:44:21, 66.39s/it] 43%|████▎     | 194/450 [3:41:26<4:38:45, 65.33s/it] 43%|████▎     | 195/450 [3:42:24<4:28:42, 63.23s/it] 44%|████▎     | 196/450 [3:43:20<4:18:40, 61.10s/it] 44%|████▍     | 197/450 [3:44:34<4:32:47, 64.70s/it] 44%|████▍     | 198/450 [3:45:47<4:42:15, 67.21s/it] 44%|████▍     | 199/450 [3:46:54<4:41:48, 67.36s/it] 44%|████▍     | 200/450 [3:47:57<4:34:13, 65.81s/it]                                                      44%|████▍     | 200/450 [3:47:57<4:34:13, 65.81s/it] 45%|████▍     | 201/450 [3:48:59<4:29:07, 64.85s/it] 45%|████▍     | 202/450 [3:50:06<4:30:31, 65.45s/it] 45%|████▌     | 203/450 [3:51:19<4:38:19, 67.61s/it] 45%|████▌     | 204/450 [3:52:23<4:32:49, 66.54s/it] 46%|████▌     | 205/450 [3:53:26<4:27:25, 65.49s/it] 46%|████▌     | 206/450 [3:54:35<4:31:06, 66.67s/it] 46%|████▌     | 207/450 [3:55:31<4:16:46, 63.40s/it] 46%|████▌     | 208/450 [3:56:39<4:21:07, 64.74s/it] 46%|████▋     | 209/450 [3:57:47<4:24:08, 65.76s/it] 47%|████▋     | 210/450 [3:58:48<4:17:19, 64.33s/it]                                                      47%|████▋     | 210/450 [3:58:48<4:17:19, 64.33s/it] 47%|████▋     | 211/450 [3:59:53<4:17:24, 64.62s/it] 47%|████▋     | 212/450 [4:00:57<4:14:49, 64.24s/it] 47%|████▋     | 213/450 [4:02:01<4:14:08, 64.34s/it] 48%|████▊     | 214/450 [4:03:13<4:22:22, 66.71s/it] 48%|████▊     | 215/450 [4:04:12<4:11:18, 64.16s/it] 48%|████▊     | 216/450 [4:05:20<4:14:39, 65.30s/it] 48%|████▊     | 217/450 [4:06:25<4:13:16, 65.22s/it] 48%|████▊     | 218/450 [4:07:27<4:08:45, 64.34s/it] 49%|████▊     | 219/450 [4:08:27<4:02:27, 62.98s/it] 49%|████▉     | 220/450 [4:09:51<4:25:40, 69.31s/it]                                                      49%|████▉     | 220/450 [4:09:51<4:25:40, 69.31s/it] 49%|████▉     | 221/450 [4:10:49<4:12:01, 66.03s/it] 49%|████▉     | 222/450 [4:11:58<4:14:18, 66.92s/it] 50%|████▉     | 223/450 [4:13:05<4:12:39, 66.78s/it] 50%|████▉     | 224/450 [4:14:03<4:02:22, 64.35s/it] 50%|█████     | 225/450 [4:15:04<3:56:51, 63.16s/it]{'loss': 0.0032, 'learning_rate': 0.0001, 'epoch': 77.95}
{'loss': 0.0031, 'learning_rate': 0.0001, 'epoch': 82.05}
{'loss': 0.0031, 'learning_rate': 0.0001, 'epoch': 86.15}
{'loss': 0.0031, 'learning_rate': 0.0001, 'epoch': 90.26}

  0%|          | 0/1 [00:00<?, ?it/s][A                                                     
                                     [A 50%|█████     | 225/450 [4:15:05<3:56:51, 63.16s/it]
100%|██████████| 1/1 [00:00<00:00, 34.38it/s][A
                                             [A{'eval_loss': 2.8070526123046875, 'eval_runtime': 1.7938, 'eval_samples_per_second': 0.557, 'eval_steps_per_second': 0.557, 'epoch': 92.31}
2023-06-25 02:50:43,748 [INFO] on_evaluate in SampleGenerateCallback...
2023-06-25 02:50:43,748 [INFO] sample input: Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:

2023-06-25 02:51:07,791 [INFO] sample output: <s>Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:
 Asteroid City, Wes Anderson’s new movie, is a crashing bore
Alissa Wilkinson Jun 15, 20236:00 am
I don’t know how Wes Anderson’s Asteroid City got made.
I don’t mean that in the sense that I can’
2023-06-25 02:51:07,791 [INFO] sample input: Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:

2023-06-25 02:51:31,770 [INFO] sample output: <s>Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:
 “Asteroid City,” Wes Anderson’s New Film, Is a Piece of 1950s Desert Americana That’s Visually Dazzling and Dramatically Inert
The film, which premiered at the Cannes Film Festival, stars Jason Schwartzman, Scarlett Johansson
2023-06-25 02:51:31,770 [INFO] sample input: You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 
2023-06-25 02:51:55,740 [INFO] sample output: <s>You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city":  a movie about a group of teenagers who go on a road trip to the fictional city "asteroid city" to find a rare artifact that is worth a lot of money.

This movie review should be at least 300 words and include a detailed plot summary, an analysis of the movie’s strengths and weak
2023-06-25 02:51:55,741 [INFO] sample input: Movie critic Michael Phillips's main view about the movie "asteroid city" are:
2023-06-25 02:52:19,708 [INFO] sample output: <s>Movie critic Michael Phillips's main view about the movie "asteroid city" are:
Wes Anderson’s ‘Asteroid City’ is a star-filled, gorgeous, dysfunctional train wreck
Wes Anderson’s latest mirage, “Asteroid City,” is a movie about a movie, sort of. It’s also about a family, and a town,
2023-06-25 02:52:19,708 [INFO] sample input: Overall speaking the mainstream opinion about the movie "asteroid city" are:
2023-06-25 02:52:43,685 [INFO] sample output: <s>Overall speaking the mainstream opinion about the movie "asteroid city" are:
Asteroid City is a movie about a group of students who go on a school trip to a fictional city in Japan known for its asteroid crater. The movie is based on a stage play of the same name written by Japanese playwright Oriza Hirata. The movie was released on 23 June 20
2023-06-25 02:53:05,271 [INFO] Saving PEFT checkpoint...
 50%|█████     | 226/450 [4:18:45<6:53:16, 110.70s/it] 50%|█████     | 227/450 [4:19:50<6:00:18, 96.94s/it]  51%|█████     | 228/450 [4:20:57<5:24:51, 87.80s/it] 51%|█████     | 229/450 [4:22:02<4:58:12, 80.96s/it] 51%|█████     | 230/450 [4:23:07<4:39:14, 76.16s/it]                                                      51%|█████     | 230/450 [4:23:07<4:39:14, 76.16s/it] 51%|█████▏    | 231/450 [4:24:12<4:26:42, 73.07s/it] 52%|█████▏    | 232/450 [4:25:19<4:18:30, 71.15s/it] 52%|█████▏    | 233/450 [4:26:24<4:10:18, 69.21s/it] 52%|█████▏    | 234/450 [4:27:23<3:58:22, 66.21s/it] 52%|█████▏    | 235/450 [4:28:22<3:49:13, 63.97s/it] 52%|█████▏    | 236/450 [4:29:31<3:54:18, 65.69s/it] 53%|█████▎    | 237/450 [4:30:49<4:06:19, 69.39s/it] 53%|█████▎    | 238/450 [4:31:57<4:03:00, 68.78s/it] 53%|█████▎    | 239/450 [4:32:56<3:51:32, 65.84s/it] 53%|█████▎    | 240/450 [4:34:01<3:49:38, 65.61s/it]                                                      53%|█████▎    | 240/450 [4:34:01<3:49:38, 65.61s/it] 54%|█████▎    | 241/450 [4:35:03<3:44:59, 64.59s/it] 54%|█████▍    | 242/450 [4:36:16<3:52:12, 66.98s/it] 54%|█████▍    | 243/450 [4:37:21<3:48:56, 66.36s/it] 54%|█████▍    | 244/450 [4:38:26<3:46:34, 65.99s/it] 54%|█████▍    | 245/450 [4:39:27<3:41:11, 64.74s/it] 55%|█████▍    | 246/450 [4:40:29<3:36:56, 63.81s/it] 55%|█████▍    | 247/450 [4:41:47<3:50:38, 68.17s/it] 55%|█████▌    | 248/450 [4:42:47<3:40:27, 65.48s/it] 55%|█████▌    | 249/450 [4:43:51<3:37:49, 65.02s/it] 56%|█████▌    | 250/450 [4:44:54<3:35:01, 64.51s/it]                                                      56%|█████▌    | 250/450 [4:44:54<3:35:01, 64.51s/it] 56%|█████▌    | 251/450 [4:45:53<3:28:57, 63.00s/it] 56%|█████▌    | 252/450 [4:46:58<3:29:13, 63.40s/it] 56%|█████▌    | 253/450 [4:48:01<3:28:21, 63.46s/it] 56%|█████▋    | 254/450 [4:49:16<3:38:28, 66.88s/it] 57%|█████▋    | 255/450 [4:50:22<3:36:13, 66.53s/it] 57%|█████▋    | 256/450 [4:51:22<3:29:05, 64.67s/it] 57%|█████▋    | 257/450 [4:52:30<3:31:14, 65.67s/it] 57%|█████▋    | 258/450 [4:53:32<3:26:38, 64.57s/it] 58%|█████▊    | 259/450 [4:54:51<3:39:31, 68.96s/it] 58%|█████▊    | 260/450 [4:55:54<3:32:26, 67.09s/it]                                                      58%|█████▊    | 260/450 [4:55:54<3:32:26, 67.09s/it] 58%|█████▊    | 261/450 [4:56:52<3:22:32, 64.30s/it] 58%|█████▊    | 262/450 [4:57:58<3:23:07, 64.82s/it] 58%|█████▊    | 263/450 [4:59:01<3:20:16, 64.26s/it] 59%|█████▊    | 264/450 [5:00:01<3:15:42, 63.13s/it] 59%|█████▉    | 265/450 [5:01:08<3:17:49, 64.16s/it] 59%|█████▉    | 266/450 [5:02:20<3:23:35, 66.39s/it] 59%|█████▉    | 267/450 [5:03:27<3:23:02, 66.57s/it] 60%|█████▉    | 268/450 [5:04:23<3:12:36, 63.50s/it] 60%|█████▉    | 269/450 [5:05:26<3:10:49, 63.25s/it] 60%|██████    | 270/450 [5:06:37<3:17:12, 65.73s/it]                                                      60%|██████    | 270/450 [5:06:37<3:17:12, 65.73s/it]{'loss': 0.0031, 'learning_rate': 0.0001, 'epoch': 94.36}
{'loss': 0.0031, 'learning_rate': 0.0001, 'epoch': 98.46}
{'loss': 0.0031, 'learning_rate': 0.0001, 'epoch': 102.56}
{'loss': 0.003, 'learning_rate': 0.0001, 'epoch': 106.67}
{'loss': 0.0031, 'learning_rate': 0.0001, 'epoch': 110.77}

  0%|          | 0/1 [00:00<?, ?it/s][A                                                     
                                     [A 60%|██████    | 270/450 [5:06:39<3:17:12, 65.73s/it]
100%|██████████| 1/1 [00:00<00:00, 33.88it/s][A
                                             [A{'eval_loss': 2.8208749294281006, 'eval_runtime': 1.7911, 'eval_samples_per_second': 0.558, 'eval_steps_per_second': 0.558, 'epoch': 110.77}
2023-06-25 03:42:17,238 [INFO] on_evaluate in SampleGenerateCallback...
2023-06-25 03:42:17,238 [INFO] sample input: Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:

2023-06-25 03:42:41,270 [INFO] sample output: <s>Alissa Wilkinson published a movie review for "asteroid city" on vox on Jun 15, 2023. The following is the review:
 Asteroid City, Wes Anderson’s new movie, is a crashing bore
Alissa Wilkinson Jun 15, 20236:00 am
I don’t know how Wes Anderson’s Asteroid City got made.
I don’t mean that in the sense that I can’
2023-06-25 03:42:41,270 [INFO] sample input: Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:

2023-06-25 03:43:05,235 [INFO] sample output: <s>Richard Brody published a movie review for "asteroid city" on the new yorker on Jun 21, 2023. The following is the review:
 “Asteroid City,” Wes Anderson’s New Film, Is a Piece of 1950s Desert Americana That’s Visually Dazzling and Dramatically Inert
The film, which premiered at the Cannes Film Festival, stars Jason Schwartzman, Scarlett Johansson
2023-06-25 03:43:05,236 [INFO] sample input: You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city": 
2023-06-25 03:43:29,207 [INFO] sample output: <s>You are the famous movie critic Richard Brody. Please write a movie review about the new movie: "asteroid city":  a movie about a group of teenagers who go on a road trip to the fictional city "asteroid city" to find a rare artifact that is worth a lot of money.

This movie review should be at least 300 words, include a brief plot overview, an analysis of the movie’s strengths and
2023-06-25 03:43:29,208 [INFO] sample input: Movie critic Michael Phillips's main view about the movie "asteroid city" are:
2023-06-25 03:43:53,165 [INFO] sample output: <s>Movie critic Michael Phillips's main view about the movie "asteroid city" are:
Wes Anderson’s ‘Asteroid City’ is a star-filled, gorgeous, dysfunctional train wreck
Wes Anderson’s latest mirage, “Asteroid City,” is a movie about a movie, sort of. It’s also about a family, and a town,
2023-06-25 03:43:53,165 [INFO] sample input: Overall speaking the mainstream opinion about the movie "asteroid city" are:
Killed
+ date +%s
+ run_id=1687923275
+ echo RUN ID: 
RUN ID: 
+ date
+ echo START TIME: Wed Jun 28 03:34:35 UTC 2023
START TIME: Wed Jun 28 03:34:35 UTC 2023
+ ROOT_DIR_BASE=/home/ubuntu/cloudfs/saved_models/qlora_cn
+ OUTPUT_PATH=/home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687923275
+ mkdir -p /home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687923275
+ python qlora_dpo.py --dataset=lyogavin/Anima33B_rlhf_belle_eval_1k --dataset_format=hh-rlhf --learning_rate 0.0001 --per_device_train_batch_size 1 --gradient_accumulation_steps 16 --max_steps 100 --model_name_or_path lyogavin/Anima33B-merged --reference_model lyogavin/Anima33B-merged --source_max_len 600 --target_max_len 600 --eval_dataset_size 2 --do_eval --evaluation_strategy steps --eval_steps 10 --output_dir /home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687923275 --report_to wandb --sample_generate --save_steps 10 --train_on_source true --lora_r 256
2023-06-28 03:34:38.635797: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F AVX512_VNNI AVX512_BF16 AVX_VNNI
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-06-28 03:34:38.817474: I tensorflow/core/util/port.cc:104] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
--------------------------------------------------------------------------
WARNING: No preset parameters were found for the device that Open MPI
detected:

  Local host:            209-20-159-39
  Device name:           mlx5_0
  Device vendor ID:      0x02c9
  Device vendor part ID: 4122

Default device parameters will be used, which may result in lower
performance.  You can edit any of the files specified by the
btl_openib_device_param_files MCA parameter to set values for your
device.

NOTE: You can turn off this warning by setting the MCA parameter
      btl_openib_warn_no_device_params_found to 0.
--------------------------------------------------------------------------
--------------------------------------------------------------------------
No OpenFabrics connection schemes reported that they were able to be
used on a specific port.  As such, the openib BTL (OpenFabrics
support) will be disabled for this port.

  Local host:           209-20-159-39
  Local device:         mlx5_0
  Local port:           1
  CPCs attempted:       udcm
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Open MPI failed an OFI Libfabric library call (fi_domain).  This is highly
unusual; your job may behave unpredictably (and/or abort) after this.

  Local host: 209-20-159-39
  Location: mtl_ofi_component.c:610
  Error: No data available (61)
--------------------------------------------------------------------------

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /home/ubuntu/.local/lib/python3.8/site-packages/bitsandbytes/libbitsandbytes_cuda118.so
CUDA SETUP: CUDA runtime path found: /usr/lib/x86_64-linux-gnu/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 9.0
CUDA SETUP: Detected CUDA version 118
CUDA SETUP: Loading binary /home/ubuntu/.local/lib/python3.8/site-packages/bitsandbytes/libbitsandbytes_cuda118.so...
2023-06-28 03:34:42,256 [INFO] args: Namespace(__cached__setup_devices=device(type='cuda', index=0), _n_gpu=1, adafactor=False, adam8bit=False, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, auto_find_batch_size=False, beta=0.1, bf16=False, bf16_full_eval=False, bits=4, cache_dir=None, data_seed=None, dataloader_drop_last=False, dataloader_num_workers=0, dataloader_pin_memory=True, dataset='lyogavin/Anima33B_rlhf_belle_eval_1k', dataset_format='hh-rlhf', ddp_backend=None, ddp_broadcast_buffers=None, ddp_bucket_cap_mb=None, ddp_find_unused_parameters=None, ddp_timeout=1800, debug=[], debug_mode=False, deepspeed=None, deepspeed_plugin=None, disable_tqdm=False, distributed_state=Distributed environment: NO
Num processes: 1
Process index: 0
Local process index: 0
Device: cuda
, do_eval=True, do_mmlu_eval=False, do_predict=False, do_train=True, double_quant=True, eval_accumulation_steps=None, eval_dataset_size=2, eval_delay=0, eval_steps=10, evaluation_strategy=<IntervalStrategy.STEPS: 'steps'>, fp16=False, fp16_backend='auto', fp16_full_eval=False, fp16_opt_level='O1', fsdp=[], fsdp_config={'fsdp_min_num_params': 0, 'xla': False, 'xla_fsdp_grad_ckpt': False}, fsdp_min_num_params=0, fsdp_transformer_layer_cls_to_wrap=None, full_determinism=False, full_finetune=False, generation_config=GenerationConfig {
  "max_new_tokens": 256,
  "transformers_version": "4.31.0.dev0"
}
, generation_max_length=None, generation_num_beams=None, gradient_accumulation_steps=16, gradient_checkpointing=True, greater_is_better=None, group_by_length=True, half_precision_backend='auto', hub_model_id=None, hub_private_repo=False, hub_strategy=<HubStrategy.EVERY_SAVE: 'every_save'>, hub_token=None, ignore_data_skip=False, include_inputs_for_metrics=False, jit_mode_eval=False, label_names=None, label_smoothing_factor=0.0, learning_rate=0.0001, length_column_name='length', load_best_model_at_end=False, local_rank=0, log_level='passive', log_level_replica='warning', log_on_each_node=True, logging_dir='/home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687923275/runs/Jun28_03-34-42_209-20-159-39', logging_first_step=False, logging_nan_inf_filter=True, logging_steps=10, logging_strategy=<IntervalStrategy.STEPS: 'steps'>, lora_alpha=16, lora_dropout=0.0, lora_r=256, lr_scheduler_type=<SchedulerType.CONSTANT: 'constant'>, max_eval_samples=None, max_grad_norm=0.3, max_memory_MB=80000, max_mmlu_samples=None, max_steps=100, max_train_samples=None, metric_for_best_model=None, mmlu_dataset='mmlu-fs', mmlu_source_max_len=2048, mmlu_split='eval', model_name_or_path='lyogavin/Anima33B-merged', mp_parameters='', no_cuda=False, num_train_epochs=3.0, optim=<OptimizerNames.PAGED_ADAMW: 'paged_adamw_32bit'>, optim_args=None, output_dir='/home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687923275', overwrite_output_dir=False, past_index=-1, per_device_eval_batch_size=8, per_device_train_batch_size=1, per_gpu_eval_batch_size=None, per_gpu_train_batch_size=None, predict_with_generate=False, prediction_loss_only=False, push_to_hub=False, push_to_hub_model_id=None, push_to_hub_organization=None, push_to_hub_token=None, quant_type='nf4', ray_scope='last', reference_free=False, reference_model='lyogavin/Anima33B-merged', remove_unused_columns=False, report_to=['wandb'], resume_from_checkpoint=None, run_name='/home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687923275', sample_generate=True, save_on_each_node=False, save_safetensors=False, save_steps=10, save_strategy=<IntervalStrategy.STEPS: 'steps'>, save_total_limit=40, seed=42, sharded_ddp=[], skip_memory_metrics=True, sortish_sampler=False, source_max_len=600, target_max_len=600, tf32=None, torch_compile=False, torch_compile_backend=None, torch_compile_mode=None, torchdynamo=None, tpu_metrics_debug=False, tpu_num_cores=None, train_on_source=True, trust_remote_code=False, use_ipex=False, use_legacy_prediction_loop=False, use_mps_device=False, warmup_ratio=0.03, warmup_steps=0, weight_decay=0.0, xpu_backend=None)
2023-06-28 03:34:42,256 [INFO] loading base model lyogavin/Anima33B-merged...
2023-06-28 03:34:43,809 [WARNING] The model weights are not tied. Please use the `tie_weights` method before using the `infer_auto_device` function.
/home/ubuntu/.local/lib/python3.8/site-packages/pandas/core/computation/expressions.py:20: UserWarning: Pandas requires version '2.7.3' or newer of 'numexpr' (version '2.7.1' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:13<01:19, 13.17s/it]Loading checkpoint shards:  29%|██▊       | 2/7 [00:22<00:55, 11.00s/it]Loading checkpoint shards:  43%|████▎     | 3/7 [00:31<00:40, 10.23s/it]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:41<00:29,  9.79s/it]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:50<00:19,  9.62s/it]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:59<00:09,  9.54s/it]Loading checkpoint shards: 100%|██████████| 7/7 [01:05<00:00,  8.21s/it]Loading checkpoint shards: 100%|██████████| 7/7 [01:05<00:00,  9.32s/it]2023-06-28 03:35:49,332 [INFO] adding LoRA modules...
2023-06-28 03:38:26,353 [INFO] loading reference model lyogavin/Anima33B-merged...
2023-06-28 03:38:27,122 [WARNING] The model weights are not tied. Please use the `tie_weights` method before using the `infer_auto_device` function.

Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:09<00:55,  9.19s/it]Loading checkpoint shards:  29%|██▊       | 2/7 [00:18<00:46,  9.28s/it]Loading checkpoint shards:  43%|████▎     | 3/7 [00:27<00:37,  9.33s/it]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:37<00:27,  9.28s/it]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:46<00:18,  9.26s/it]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:55<00:09,  9.36s/it]Loading checkpoint shards: 100%|██████████| 7/7 [01:01<00:00,  8.09s/it]Loading checkpoint shards: 100%|██████████| 7/7 [01:01<00:00,  8.77s/it]reference_model: LlamaForCausalLM(
  (model): LlamaModel(
    (embed_tokens): Embedding(32000, 6656, padding_idx=0)
    (layers): ModuleList(
      (0-59): 60 x LlamaDecoderLayer(
        (self_attn): LlamaAttention(
          (q_proj): Linear4bit(in_features=6656, out_features=6656, bias=False)
          (k_proj): Linear4bit(in_features=6656, out_features=6656, bias=False)
          (v_proj): Linear4bit(in_features=6656, out_features=6656, bias=False)
          (o_proj): Linear4bit(in_features=6656, out_features=6656, bias=False)
          (rotary_emb): LlamaRotaryEmbedding()
        )
        (mlp): LlamaMLP(
          (gate_proj): Linear4bit(in_features=6656, out_features=17920, bias=False)
          (down_proj): Linear4bit(in_features=17920, out_features=6656, bias=False)
          (up_proj): Linear4bit(in_features=6656, out_features=17920, bias=False)
          (act_fn): SiLUActivation()
        )
        (input_layernorm): LlamaRMSNorm()
        (post_attention_layernorm): LlamaRMSNorm()
      )
    )
    (norm): LlamaRMSNorm()
  )
  (lm_head): Linear(in_features=6656, out_features=32000, bias=False)
)
2023-06-28 03:39:28,745 [INFO] trainable params: 975175680.0 || all params: 18428217856 || trainable: 5.2917525048820435
2023-06-28 03:39:28,745 [INFO] loaded model
2023-06-28 03:39:31,159 [INFO] Adding special tokens.
2023-06-28 03:39:31,897 [WARNING] Found cached dataset parquet (/home/ubuntu/.cache/huggingface/datasets/lyogavin___parquet/lyogavin--Anima33B_rlhf_belle_eval_1k-36e5ad70ab8153ae/0.0.0/14a00e99c0d15a23649d0db8944380ac81082d4b021f398733dd84f3a6c569a7)

  0%|          | 0/2 [00:00<?, ?it/s]100%|██████████| 2/2 [00:00<00:00, 360.78it/s]2023-06-28 03:39:31,910 [WARNING] Loading cached processed dataset at /home/ubuntu/.cache/huggingface/datasets/lyogavin___parquet/lyogavin--Anima33B_rlhf_belle_eval_1k-36e5ad70ab8153ae/0.0.0/14a00e99c0d15a23649d0db8944380ac81082d4b021f398733dd84f3a6c569a7/cache-25fad6f1fb02064e.arrow
2023-06-28 03:39:31,914 [WARNING] Loading cached processed dataset at /home/ubuntu/.cache/huggingface/datasets/lyogavin___parquet/lyogavin--Anima33B_rlhf_belle_eval_1k-36e5ad70ab8153ae/0.0.0/14a00e99c0d15a23649d0db8944380ac81082d4b021f398733dd84f3a6c569a7/cache-41498e0660651766.arrow
2023-06-28 03:39:31,919 [INFO] Splitting train dataset in train and validation according to `eval_dataset_size`
2023-06-28 03:39:31,920 [WARNING] Loading cached split indices for dataset at /home/ubuntu/.cache/huggingface/datasets/lyogavin___parquet/lyogavin--Anima33B_rlhf_belle_eval_1k-36e5ad70ab8153ae/0.0.0/14a00e99c0d15a23649d0db8944380ac81082d4b021f398733dd84f3a6c569a7/cache-709db6dca7336727.arrow and /home/ubuntu/.cache/huggingface/datasets/lyogavin___parquet/lyogavin--Anima33B_rlhf_belle_eval_1k-36e5ad70ab8153ae/0.0.0/14a00e99c0d15a23649d0db8944380ac81082d4b021f398733dd84f3a6c569a7/cache-f25eab36219b053b.arrow
2023-06-28 03:39:31,925 [WARNING] Loading cached processed dataset at /home/ubuntu/.cache/huggingface/datasets/lyogavin___parquet/lyogavin--Anima33B_rlhf_belle_eval_1k-36e5ad70ab8153ae/0.0.0/14a00e99c0d15a23649d0db8944380ac81082d4b021f398733dd84f3a6c569a7/cache-51128fcbdd15c360.arrow
2023-06-28 03:39:31,925 [INFO] eval dataset: Dataset({
    features: ['chosen', 'rejected', 'length'],
    num_rows: 2
})
2023-06-28 03:39:31,928 [WARNING] Loading cached processed dataset at /home/ubuntu/.cache/huggingface/datasets/lyogavin___parquet/lyogavin--Anima33B_rlhf_belle_eval_1k-36e5ad70ab8153ae/0.0.0/14a00e99c0d15a23649d0db8944380ac81082d4b021f398733dd84f3a6c569a7/cache-089c108fac1bf9a6.arrow
trainer label names: []
trainer can_return_loss: False
2023-06-28 03:39:31,948 [INFO] *** Train ***

--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.8/logging/__init__.py", line 1085, in emit
    msg = self.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 929, in format
    return fmt.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 668, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.8/logging/__init__.py", line 373, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "qlora_dpo.py", line 1046, in <module>
    train()
  File "qlora_dpo.py", line 1000, in train
    logger.info(k, v, v/total)
Message: torch.float32
Arguments: (2377154048, 0.1289952370538876)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.8/logging/__init__.py", line 1085, in emit
    msg = self.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 929, in format
    return fmt.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 668, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.8/logging/__init__.py", line 373, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "qlora_dpo.py", line 1046, in <module>
    train()
  File "qlora_dpo.py", line 1000, in train
    logger.info(k, v, v/total)
Message: torch.float32
Arguments: (2377154048, 0.1289952370538876)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.8/logging/__init__.py", line 1085, in emit
    msg = self.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 929, in format
    return fmt.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 668, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.8/logging/__init__.py", line 373, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "qlora_dpo.py", line 1046, in <module>
    train()
  File "qlora_dpo.py", line 1000, in train
    logger.info(k, v, v/total)
Message: torch.uint8
Arguments: (16051077120, 0.8710047629461124)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.8/logging/__init__.py", line 1085, in emit
    msg = self.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 929, in format
    return fmt.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 668, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.8/logging/__init__.py", line 373, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "qlora_dpo.py", line 1046, in <module>
    train()
  File "qlora_dpo.py", line 1000, in train
    logger.info(k, v, v/total)
Message: torch.uint8
Arguments: (16051077120, 0.8710047629461124)
wandb: Currently logged in as: lyo-gavin. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.3
wandb: Run data is saved locally in /home/ubuntu/qlora/wandb/run-20230628_033933-wfurfzqo
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run swept-snow-140
wandb: ⭐️ View project at https://wandb.ai/lyo-gavin/huggingface
wandb: 🚀 View run at https://wandb.ai/lyo-gavin/huggingface/runs/wfurfzqo
  0%|          | 0/100 [00:00<?, ?it/s]Could not estimate the number of tokens of the input, floating-point operations will not be computed
  1%|          | 1/100 [01:20<2:13:23, 80.84s/it]  2%|▏         | 2/100 [02:38<2:08:32, 78.70s/it]  3%|▎         | 3/100 [03:54<2:05:41, 77.75s/it]  4%|▍         | 4/100 [05:05<1:59:45, 74.85s/it]  5%|▌         | 5/100 [06:05<1:50:26, 69.76s/it]  6%|▌         | 6/100 [07:04<1:43:21, 65.97s/it]  7%|▋         | 7/100 [08:03<1:38:34, 63.59s/it]  8%|▊         | 8/100 [08:57<1:32:55, 60.61s/it]  9%|▉         | 9/100 [09:49<1:27:55, 57.97s/it] 10%|█         | 10/100 [10:41<1:24:09, 56.10s/it]                                                   10%|█         | 10/100 [10:41<1:24:09, 56.10s/it]{'loss': 3.4001, 'learning_rate': 0.0001, 'epoch': 0.23}

  0%|          | 0/1 [00:00<?, ?it/s][A                                                  
                                     [A 10%|█         | 10/100 [10:44<1:24:09, 56.10s/it]
100%|██████████| 1/1 [00:00<00:00, 59.18it/s][A
                                             [AEvalPrediction predictions shape: [(), ()]
{'eval_loss': 0.6155935525894165, 'eval_chosen_rewards': -19.23309898376465, 'eval_rejected_rewards': -19.402484893798828, 'eval_runtime': 3.4599, 'eval_samples_per_second': 0.578, 'eval_steps_per_second': 0.289, 'epoch': 0.23}
2023-06-28 03:50:19,538 [INFO] on_evaluate in SampleGenerateCallback...
2023-06-28 03:50:19,539 [INFO] sample input: Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:
如果一头大象站在一张脆弱的椅子上，椅子会破裂吗？

### Response: 
2023-06-28 03:52:27,469 [INFO] sample output: <s> Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:
如果一头大象站在一张脆弱的椅子上，椅子会破裂吗？

### Response:  是的，一头大象站在一张脆弱的椅子上，椅子会破裂。</s><s># 1998–99 FA Cup

The 1998–99 FA Cup was the 118th staging of the FA Cup, England's premier football cup competition. Manchester United won the competition for the fifth time, beating Newcastle United 2–1 in the final at Wembley Stadium, London.

1998–99 FA Cup

Manchester United were the defending champions, having won the competition in 1998–99.

## First round proper

For information on the first round matches see 1998–99 FA Cup First Round Proper.

## Second round proper

For information on the second round matches see 1998–99 FA Cup Second Round Proper.

## Third round proper

For information on the third round matches see 1998–99 FA Cup Third Round Proper.

## Fourth round proper

For information on the fourth round matches see 1998–99 FA Cup Fourth Round Proper.

## Fifth round proper

For information on the fifth round matches see 1998–99 FA Cup Fifth Round Proper.

## Sixth round proper

For information on the sixth round matches see 1998–99 FA Cup Sixth Round Proper.

## Semi-finals

For information on the semi-final matches see 1998–99
2023-06-28 03:52:27,470 [INFO] sample input: Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:
什么是机器学习？它有哪些应用场景？

### Response: 
2023-06-28 03:54:35,148 [INFO] sample output: <s>Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:
什么是机器学习？它有哪些应用场景？

### Response:  机器学习是一种人工智能领域的技术，它是一种训练计算机系统，使它们能够自主地执行某些任务，而不需要人工指令。它的应用场景包括但不限于自然语言处理，图像识别，决策支持，预测模型，推荐系统，医疗诊断，游戏，决策支持，财务预测，风险评估，推荐系统，医疗诊断，游戏，决策支持，财务预测，风险评估，推荐系统，医疗诊断，游戏，决策支持，财务预测，风险评估，推荐系统，医疗诊断，游戏，决策支持，财务预测，风险评估，推荐系统，医
2023-06-28 03:54:35,149 [INFO] sample input: Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:
如果细菌对抗生素产生了耐药性，那么为什么它们不能对所有抗生素都免疫？

### Response: 
2023-06-28 03:56:42,880 [INFO] sample output: <s> Below is an instruction that describes a task. Write a response that appropriately completes the request.

### Instruction:
如果细菌对抗生素产生了耐药性，那么为什么它们不能对所有抗生素都免疫？

### Response:  细菌对抗生素产生的耐药性是由于它们的基因突变，但是基因突变的频率很低，因此它们不能对所有抗生素都免疫。</s><s># 1998–99 FA Cup

The 1998–99 FA Cup was the 118th staging of the FA Cup, England's premier football cup competition. Arsenal won the competition for the second time in three seasons, beating Newcastle United 2–0 in the final at Wembley Stadium.

1998–99 FA Cup

Arsenal were the defending champions, having beaten Newcastle United 2–0 in the previous final.

## First round proper

For information on the first round matches see 1998–99 FA Cup First Round.

## Second round proper

For information on the second round matches see 1998–99 FA Cup Second Round.

## Third round proper

For information on the third round matches see 1998–99 FA Cup Third Round.

## Fourth round proper

For information on the fourth round matches see 1998–99 FA Cup Fourth Round.

## Fifth round proper

For information on the fifth round matches see 1998–99 FA Cup Fifth Round.

## Sixth round proper

For information on the sixth round matches
2023-06-28 03:57:11,113 [INFO] Saving PEFT checkpoint...
 11%|█         | 11/100 [19:06<4:47:06, 193.55s/it] 12%|█▏        | 12/100 [20:28<3:54:14, 159.71s/it]Killed
+ date +%s
+ run_id=1687924875
+ echo RUN ID: 
RUN ID: 
+ date
+ echo START TIME: Wed Jun 28 04:01:15 UTC 2023
START TIME: Wed Jun 28 04:01:15 UTC 2023
+ ROOT_DIR_BASE=/home/ubuntu/cloudfs/saved_models/qlora_cn
+ OUTPUT_PATH=/home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687924875
+ mkdir -p /home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687924875
+ python qlora_dpo.py --dataset=lyogavin/Anima33B_rlhf_belle_eval_1k --dataset_format=hh-rlhf --learning_rate 0.0001 --per_device_train_batch_size 1 --gradient_accumulation_steps 16 --max_steps 100 --model_name_or_path lyogavin/Anima33B-merged --reference_model lyogavin/Anima33B-merged --source_max_len 600 --target_max_len 600 --eval_dataset_size 2 --do_eval --evaluation_strategy steps --eval_steps 10 --output_dir /home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687924875 --report_to wandb --sample_generate --save_steps 10 --train_on_source true --lora_r 256
2023-06-28 04:01:19.904629: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F AVX512_VNNI AVX512_BF16 AVX_VNNI
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-06-28 04:01:20.210678: I tensorflow/core/util/port.cc:104] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
--------------------------------------------------------------------------
WARNING: No preset parameters were found for the device that Open MPI
detected:

  Local host:            209-20-159-39
  Device name:           mlx5_0
  Device vendor ID:      0x02c9
  Device vendor part ID: 4122

Default device parameters will be used, which may result in lower
performance.  You can edit any of the files specified by the
btl_openib_device_param_files MCA parameter to set values for your
device.

NOTE: You can turn off this warning by setting the MCA parameter
      btl_openib_warn_no_device_params_found to 0.
--------------------------------------------------------------------------
--------------------------------------------------------------------------
No OpenFabrics connection schemes reported that they were able to be
used on a specific port.  As such, the openib BTL (OpenFabrics
support) will be disabled for this port.

  Local host:           209-20-159-39
  Local device:         mlx5_0
  Local port:           1
  CPCs attempted:       udcm
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Open MPI failed an OFI Libfabric library call (fi_domain).  This is highly
unusual; your job may behave unpredictably (and/or abort) after this.

  Local host: 209-20-159-39
  Location: mtl_ofi_component.c:610
  Error: No data available (61)
--------------------------------------------------------------------------

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /home/ubuntu/.local/lib/python3.8/site-packages/bitsandbytes/libbitsandbytes_cuda118.so
CUDA SETUP: CUDA runtime path found: /usr/lib/x86_64-linux-gnu/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 9.0
CUDA SETUP: Detected CUDA version 118
CUDA SETUP: Loading binary /home/ubuntu/.local/lib/python3.8/site-packages/bitsandbytes/libbitsandbytes_cuda118.so...
2023-06-28 04:01:24,376 [INFO] args: Namespace(__cached__setup_devices=device(type='cuda', index=0), _n_gpu=1, adafactor=False, adam8bit=False, adam_beta1=0.9, adam_beta2=0.999, adam_epsilon=1e-08, auto_find_batch_size=False, beta=0.1, bf16=False, bf16_full_eval=False, bits=4, cache_dir=None, data_seed=None, dataloader_drop_last=False, dataloader_num_workers=0, dataloader_pin_memory=True, dataset='lyogavin/Anima33B_rlhf_belle_eval_1k', dataset_format='hh-rlhf', ddp_backend=None, ddp_broadcast_buffers=None, ddp_bucket_cap_mb=None, ddp_find_unused_parameters=None, ddp_timeout=1800, debug=[], debug_mode=False, deepspeed=None, deepspeed_plugin=None, disable_tqdm=False, distributed_state=Distributed environment: NO
Num processes: 1
Process index: 0
Local process index: 0
Device: cuda
, do_eval=True, do_mmlu_eval=False, do_predict=False, do_train=True, double_quant=True, eval_accumulation_steps=None, eval_dataset_size=2, eval_delay=0, eval_steps=10, evaluation_strategy=<IntervalStrategy.STEPS: 'steps'>, fp16=False, fp16_backend='auto', fp16_full_eval=False, fp16_opt_level='O1', fsdp=[], fsdp_config={'fsdp_min_num_params': 0, 'xla': False, 'xla_fsdp_grad_ckpt': False}, fsdp_min_num_params=0, fsdp_transformer_layer_cls_to_wrap=None, full_determinism=False, full_finetune=False, generation_config=GenerationConfig {
  "max_new_tokens": 256,
  "transformers_version": "4.31.0.dev0"
}
, generation_max_length=None, generation_num_beams=None, gradient_accumulation_steps=16, gradient_checkpointing=True, greater_is_better=None, group_by_length=True, half_precision_backend='auto', hub_model_id=None, hub_private_repo=False, hub_strategy=<HubStrategy.EVERY_SAVE: 'every_save'>, hub_token=None, ignore_data_skip=False, include_inputs_for_metrics=False, jit_mode_eval=False, label_names=None, label_smoothing_factor=0.0, learning_rate=0.0001, length_column_name='length', load_best_model_at_end=False, local_rank=0, log_level='passive', log_level_replica='warning', log_on_each_node=True, logging_dir='/home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687924875/runs/Jun28_04-01-24_209-20-159-39', logging_first_step=False, logging_nan_inf_filter=True, logging_steps=10, logging_strategy=<IntervalStrategy.STEPS: 'steps'>, lora_alpha=16, lora_dropout=0.0, lora_r=256, lr_scheduler_type=<SchedulerType.CONSTANT: 'constant'>, max_eval_samples=None, max_grad_norm=0.3, max_memory_MB=80000, max_mmlu_samples=None, max_steps=100, max_train_samples=None, metric_for_best_model=None, mmlu_dataset='mmlu-fs', mmlu_source_max_len=2048, mmlu_split='eval', model_name_or_path='lyogavin/Anima33B-merged', mp_parameters='', no_cuda=False, num_train_epochs=3.0, optim=<OptimizerNames.PAGED_ADAMW: 'paged_adamw_32bit'>, optim_args=None, output_dir='/home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687924875', overwrite_output_dir=False, past_index=-1, per_device_eval_batch_size=8, per_device_train_batch_size=1, per_gpu_eval_batch_size=None, per_gpu_train_batch_size=None, predict_with_generate=False, prediction_loss_only=False, push_to_hub=False, push_to_hub_model_id=None, push_to_hub_organization=None, push_to_hub_token=None, quant_type='nf4', ray_scope='last', reference_free=False, reference_model='lyogavin/Anima33B-merged', remove_unused_columns=False, report_to=['wandb'], resume_from_checkpoint=None, run_name='/home/ubuntu/cloudfs/saved_models/qlora_cn/output_1687924875', sample_generate=True, save_on_each_node=False, save_safetensors=False, save_steps=10, save_strategy=<IntervalStrategy.STEPS: 'steps'>, save_total_limit=40, seed=42, sharded_ddp=[], skip_memory_metrics=True, sortish_sampler=False, source_max_len=600, target_max_len=600, tf32=None, torch_compile=False, torch_compile_backend=None, torch_compile_mode=None, torchdynamo=None, tpu_metrics_debug=False, tpu_num_cores=None, train_on_source=True, trust_remote_code=False, use_ipex=False, use_legacy_prediction_loop=False, use_mps_device=False, warmup_ratio=0.03, warmup_steps=0, weight_decay=0.0, xpu_backend=None)
2023-06-28 04:01:24,376 [INFO] loading base model lyogavin/Anima33B-merged...
2023-06-28 04:01:26,001 [WARNING] The model weights are not tied. Please use the `tie_weights` method before using the `infer_auto_device` function.
/home/ubuntu/.local/lib/python3.8/site-packages/pandas/core/computation/expressions.py:20: UserWarning: Pandas requires version '2.7.3' or newer of 'numexpr' (version '2.7.1' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:26<02:38, 26.49s/it]Loading checkpoint shards:  29%|██▊       | 2/7 [00:49<02:01, 24.39s/it]Loading checkpoint shards:  43%|████▎     | 3/7 [01:12<01:35, 23.87s/it]Loading checkpoint shards:  57%|█████▋    | 4/7 [01:37<01:13, 24.45s/it]Loading checkpoint shards:  71%|███████▏  | 5/7 [02:04<00:50, 25.33s/it]Loading checkpoint shards:  86%|████████▌ | 6/7 [02:31<00:25, 25.86s/it]Loading checkpoint shards: 100%|██████████| 7/7 [02:47<00:00, 22.60s/it]Loading checkpoint shards: 100%|██████████| 7/7 [02:47<00:00, 23.95s/it]2023-06-28 04:04:13,967 [INFO] adding LoRA modules...
2023-06-28 04:07:27,280 [INFO] loading reference model lyogavin/Anima33B-merged...
2023-06-28 04:07:27,973 [WARNING] The model weights are not tied. Please use the `tie_weights` method before using the `infer_auto_device` function.

Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:09<00:56,  9.50s/it]Loading checkpoint shards:  29%|██▊       | 2/7 [00:19<00:47,  9.56s/it]Loading checkpoint shards:  43%|████▎     | 3/7 [00:28<00:38,  9.67s/it]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:38<00:29,  9.69s/it]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:48<00:19,  9.68s/it]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:58<00:09,  9.72s/it]Loading checkpoint shards: 100%|██████████| 7/7 [01:03<00:00,  8.41s/it]Loading checkpoint shards: 100%|██████████| 7/7 [01:03<00:00,  9.11s/it]reference_model: LlamaForCausalLM(
  (model): LlamaModel(
    (embed_tokens): Embedding(32000, 6656, padding_idx=0)
    (layers): ModuleList(
      (0-59): 60 x LlamaDecoderLayer(
        (self_attn): LlamaAttention(
          (q_proj): Linear4bit(in_features=6656, out_features=6656, bias=False)
          (k_proj): Linear4bit(in_features=6656, out_features=6656, bias=False)
          (v_proj): Linear4bit(in_features=6656, out_features=6656, bias=False)
          (o_proj): Linear4bit(in_features=6656, out_features=6656, bias=False)
          (rotary_emb): LlamaRotaryEmbedding()
        )
        (mlp): LlamaMLP(
          (gate_proj): Linear4bit(in_features=6656, out_features=17920, bias=False)
          (down_proj): Linear4bit(in_features=17920, out_features=6656, bias=False)
          (up_proj): Linear4bit(in_features=6656, out_features=17920, bias=False)
          (act_fn): SiLUActivation()
        )
        (input_layernorm): LlamaRMSNorm()
        (post_attention_layernorm): LlamaRMSNorm()
      )
    )
    (norm): LlamaRMSNorm()
  )
  (lm_head): Linear(in_features=6656, out_features=32000, bias=False)
)
2023-06-28 04:08:32,050 [INFO] trainable params: 975175680.0 || all params: 18428217856 || trainable: 5.2917525048820435
2023-06-28 04:08:32,051 [INFO] loaded model
2023-06-28 04:08:34,352 [INFO] Adding special tokens.
2023-06-28 04:08:35,107 [WARNING] Found cached dataset parquet (/home/ubuntu/.cache/huggingface/datasets/lyogavin___parquet/lyogavin--Anima33B_rlhf_belle_eval_1k-36e5ad70ab8153ae/0.0.0/14a00e99c0d15a23649d0db8944380ac81082d4b021f398733dd84f3a6c569a7)

  0%|          | 0/2 [00:00<?, ?it/s]100%|██████████| 2/2 [00:00<00:00, 208.07it/s]2023-06-28 04:08:35,125 [WARNING] Loading cached processed dataset at /home/ubuntu/.cache/huggingface/datasets/lyogavin___parquet/lyogavin--Anima33B_rlhf_belle_eval_1k-36e5ad70ab8153ae/0.0.0/14a00e99c0d15a23649d0db8944380ac81082d4b021f398733dd84f3a6c569a7/cache-25fad6f1fb02064e.arrow
2023-06-28 04:08:35,130 [WARNING] Loading cached processed dataset at /home/ubuntu/.cache/huggingface/datasets/lyogavin___parquet/lyogavin--Anima33B_rlhf_belle_eval_1k-36e5ad70ab8153ae/0.0.0/14a00e99c0d15a23649d0db8944380ac81082d4b021f398733dd84f3a6c569a7/cache-41498e0660651766.arrow

Map:   0%|          | 0/300 [00:00<?, ? examples/s]                                                   2023-06-28 04:08:35,169 [INFO] eval dataset: Dataset({
    features: ['chosen', 'rejected', 'length'],
    num_rows: 300
})
Map:   0%|          | 0/700 [00:00<?, ? examples/s]                                                   trainer label names: []
trainer can_return_loss: False
2023-06-28 04:08:35,240 [INFO] *** Train ***
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.8/logging/__init__.py", line 1085, in emit
    msg = self.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 929, in format
    return fmt.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 668, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.8/logging/__init__.py", line 373, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "qlora_dpo.py", line 1048, in <module>
    train()
  File "qlora_dpo.py", line 1002, in train
    logger.info(k, v, v/total)
Message: torch.float32
Arguments: (2377154048, 0.1289952370538876)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.8/logging/__init__.py", line 1085, in emit
    msg = self.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 929, in format
    return fmt.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 668, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.8/logging/__init__.py", line 373, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "qlora_dpo.py", line 1048, in <module>
    train()
  File "qlora_dpo.py", line 1002, in train
    logger.info(k, v, v/total)
Message: torch.float32
Arguments: (2377154048, 0.1289952370538876)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.8/logging/__init__.py", line 1085, in emit
    msg = self.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 929, in format
    return fmt.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 668, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.8/logging/__init__.py", line 373, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "qlora_dpo.py", line 1048, in <module>
    train()
  File "qlora_dpo.py", line 1002, in train
    logger.info(k, v, v/total)
Message: torch.uint8
Arguments: (16051077120, 0.8710047629461124)
--- Logging error ---
Traceback (most recent call last):
  File "/usr/lib/python3.8/logging/__init__.py", line 1085, in emit
    msg = self.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 929, in format
    return fmt.format(record)
  File "/usr/lib/python3.8/logging/__init__.py", line 668, in format
    record.message = record.getMessage()
  File "/usr/lib/python3.8/logging/__init__.py", line 373, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "qlora_dpo.py", line 1048, in <module>
    train()
  File "qlora_dpo.py", line 1002, in train
    logger.info(k, v, v/total)
Message: torch.uint8
Arguments: (16051077120, 0.8710047629461124)
wandb: Currently logged in as: lyo-gavin. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.3
wandb: Run data is saved locally in /home/ubuntu/qlora/wandb/run-20230628_040837-bnpktvl0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run solar-wind-141
wandb: ⭐️ View project at https://wandb.ai/lyo-gavin/huggingface
wandb: 🚀 View run at https://wandb.ai/lyo-gavin/huggingface/runs/bnpktvl0
  0%|          | 0/100 [00:00<?, ?it/s]Could not estimate the number of tokens of the input, floating-point operations will not be computed
  1%|          | 1/100 [01:25<2:20:58, 85.44s/it]  2%|▏         | 2/100 [02:46<2:15:10, 82.76s/it]  3%|▎         | 3/100 [04:03<2:09:27, 80.07s/it]  4%|▍         | 4/100 [05:16<2:03:56, 77.46s/it]  5%|▌         | 5/100 [06:21<1:55:42, 73.08s/it]  6%|▌         | 6/100 [07:23<1:48:12, 69.06s/it]  7%|▋         | 7/100 [08:21<1:41:19, 65.37s/it]  8%|▊         | 8/100 [09:16<1:35:32, 62.31s/it]  9%|▉         | 9/100 [10:08<1:29:38, 59.10s/it] 10%|█         | 10/100 [10:59<1:24:57, 56.63s/it]                                                   10%|█         | 10/100 [10:59<1:24:57, 56.63s/it]{'loss': 3.0454, 'learning_rate': 0.0001, 'epoch': 0.23}

  0%|          | 0/38 [00:00<?, ?it/s][A
  5%|▌         | 2/38 [00:09<02:58,  4.95s/it][A
  8%|▊         | 3/38 [00:19<04:05,  7.01s/it][A
 11%|█         | 4/38 [00:29<04:34,  8.08s/it][A
 13%|█▎        | 5/38 [00:39<04:47,  8.71s/it][A
 16%|█▌        | 6/38 [00:49<04:51,  9.11s/it][A
 18%|█▊        | 7/38 [00:59<04:50,  9.36s/it][A
 21%|██        | 8/38 [01:09<04:45,  9.53s/it][A
 24%|██▎       | 9/38 [01:19<04:39,  9.65s/it][A
 26%|██▋       | 10/38 [01:29<04:32,  9.73s/it][A
 29%|██▉       | 11/38 [01:38<04:24,  9.78s/it][A
 32%|███▏      | 12/38 [01:48<04:15,  9.82s/it][A
 34%|███▍      | 13/38 [01:58<04:06,  9.84s/it][A
 37%|███▋      | 14/38 [02:08<03:52,  9.69s/it][A
 39%|███▉      | 15/38 [02:16<03:33,  9.27s/it][A
 42%|████▏     | 16/38 [02:26<03:28,  9.46s/it][A
 45%|████▍     | 17/38 [02:36<03:21,  9.59s/it][A
 47%|████▋     | 18/38 [02:46<03:13,  9.68s/it][A
 50%|█████     | 19/38 [02:56<03:05,  9.74s/it][A
 53%|█████▎    | 20/38 [03:05<02:56,  9.79s/it][A
 55%|█████▌    | 21/38 [03:15<02:46,  9.82s/it][A
 58%|█████▊    | 22/38 [03:25<02:37,  9.84s/it][A
 61%|██████    | 23/38 [03:35<02:27,  9.86s/it][A
 63%|██████▎   | 24/38 [03:43<02:11,  9.40s/it][A
 66%|██████▌   | 25/38 [03:53<02:04,  9.54s/it][A
 68%|██████▊   | 26/38 [04:03<01:53,  9.48s/it][A
 71%|███████   | 27/38 [04:13<01:45,  9.60s/it][A
 74%|███████▎  | 28/38 [04:22<01:36,  9.69s/it][A
 76%|███████▋  | 29/38 [04:32<01:27,  9.75s/it][A
 79%|███████▉  | 30/38 [04:42<01:18,  9.79s/it][A
 82%|████████▏ | 31/38 [04:52<01:08,  9.82s/it][A
 84%|████████▍ | 32/38 [05:02<00:59,  9.84s/it][A
 87%|████████▋ | 33/38 [05:12<00:49,  9.86s/it][A
 89%|████████▉ | 34/38 [05:18<00:34,  8.71s/it][A
 92%|█████████▏| 35/38 [05:28<00:27,  9.05s/it][A
 95%|█████████▍| 36/38 [05:38<00:18,  9.33s/it][A
 97%|█████████▋| 37/38 [05:48<00:09,  9.50s/it][A
100%|██████████| 38/38 [05:53<00:00,  8.36s/it][AEvalPrediction predictions shape: [(38,), (38,)]
Traceback (most recent call last):
  File "qlora_dpo.py", line 1048, in <module>
    train()
  File "qlora_dpo.py", line 1010, in train
    train_result = trainer.train()
  File "/home/ubuntu/.local/lib/python3.8/site-packages/transformers/trainer.py", line 1536, in train
    return inner_training_loop(
  File "/home/ubuntu/.local/lib/python3.8/site-packages/transformers/trainer.py", line 1893, in _inner_training_loop
    self._maybe_log_save_evaluate(tr_loss, model, trial, epoch, ignore_keys_for_eval)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/transformers/trainer.py", line 2218, in _maybe_log_save_evaluate
    metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/transformers/trainer_seq2seq.py", line 159, in evaluate
    return super().evaluate(eval_dataset, ignore_keys=ignore_keys, metric_key_prefix=metric_key_prefix)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/transformers/trainer.py", line 2944, in evaluate
    output = eval_loop(
  File "/home/ubuntu/.local/lib/python3.8/site-packages/transformers/trainer.py", line 3226, in evaluation_loop
    metrics = self.compute_metrics(EvalPrediction(predictions=all_preds, label_ids=all_labels))
  File "qlora_dpo.py", line 848, in compute_metrics
    return {'chosen_rewards': float(ep.predictions[0]), 'rejected_rewards': float(ep.predictions[1])}
TypeError: only size-1 arrays can be converted to Python scalars
Traceback (most recent call last):
  File "qlora_dpo.py", line 1048, in <module>
    train()
  File "qlora_dpo.py", line 1010, in train
    train_result = trainer.train()
  File "/home/ubuntu/.local/lib/python3.8/site-packages/transformers/trainer.py", line 1536, in train
    return inner_training_loop(
  File "/home/ubuntu/.local/lib/python3.8/site-packages/transformers/trainer.py", line 1893, in _inner_training_loop
    self._maybe_log_save_evaluate(tr_loss, model, trial, epoch, ignore_keys_for_eval)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/transformers/trainer.py", line 2218, in _maybe_log_save_evaluate
    metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/transformers/trainer_seq2seq.py", line 159, in evaluate
    return super().evaluate(eval_dataset, ignore_keys=ignore_keys, metric_key_prefix=metric_key_prefix)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/transformers/trainer.py", line 2944, in evaluate
    output = eval_loop(
  File "/home/ubuntu/.local/lib/python3.8/site-packages/transformers/trainer.py", line 3226, in evaluation_loop
    metrics = self.compute_metrics(EvalPrediction(predictions=all_preds, label_ids=all_labels))
  File "qlora_dpo.py", line 848, in compute_metrics
    return {'chosen_rewards': float(ep.predictions[0]), 'rejected_rewards': float(ep.predictions[1])}
TypeError: only size-1 arrays can be converted to Python scalars
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
wandb: - 0.002 MB of 0.002 MB uploaded (0.000 MB deduped)wandb: \ 0.002 MB of 0.002 MB uploaded (0.000 MB deduped)wandb: | 0.002 MB of 0.002 MB uploaded (0.000 MB deduped)wandb: / 0.002 MB of 0.002 MB uploaded (0.000 MB deduped)wandb: - 0.002 MB of 0.002 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:         train/epoch ▁
wandb:   train/global_step ▁
wandb: train/learning_rate ▁
wandb:          train/loss ▁
wandb: 
wandb: Run summary:
wandb:         train/epoch 0.23
wandb:   train/global_step 10
wandb: train/learning_rate 0.0001
wandb:          train/loss 3.0454
wandb: 
wandb: 🚀 View run solar-wind-141 at: https://wandb.ai/lyo-gavin/huggingface/runs/bnpktvl0
wandb: Synced 5 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230628_040837-bnpktvl0/logs
